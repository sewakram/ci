!function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=72)}([function(t,e,i){"use strict";e.__esModule=!0;var n=window.jQuery,o=window.html2canvas,r=window.THREE,s=window.React,a=window.ReactDOM,l=window.PDFJS;e.$=n,e.html2canvas=o,e.THREE=r,e.React=s,e.ReactDOM=a,e.PDFJS=l,e.tr=function(t){return(window.iberezansky||{}).tr&&window.iberezansky.tr(t)||t}},function(t,e,i){"use strict";e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},o=window.jQuery,r=window.html2canvas,s=window.THREE,a=window.PDFJS;window.FB3D_LOCALE&&(window.iberezansky=n({},window.iberezansky,{tr:function(t){return(FB3D_LOCALE.dictionary||{})[t]||t}})),e.$=o,e.html2canvas=r,e.THREE=s,e.PDFJS=a,e.tr=function(t){return(window.iberezansky||{}).tr&&window.iberezansky.tr(t)||t}},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.sum1=function(t,e,i,n){return[t*e[0]+i*n[0]]},t.sum2=function(t,e,i,n){return[t*e[0]+i*n[0],t*e[1]+i*n[1]]},t.sum3=function(t,e,i,n){return[t*e[0]+i*n[0],t*e[1]+i*n[1],t*e[2]+i*n[2]]},t.sum4=function(t,e,i,n){return[t*e[0]+i*n[0],t*e[1]+i*n[1],t*e[2]+i*n[2],t*e[3]+i*n[3]]},t.rk4=function(e,i,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.sum[o.length-1],s=e(i,o),a=e(i+n/2,r(1,o,n/2,s)),l=e(i+n/2,r(1,o,n/2,a)),h=e(i+n,r(1,o,n,l));return r(1,o,n/6,r(1,r(1,s,2,a),1,r(2,l,1,h)))},t.extrapolateLinear=function(t,e,i){return e[0]+(e[1]-e[0])/(t[1]-t[0])*(i-t[0])},t.interpolateLinear=function(e,i,n){return e[0]>e[1]&&(e=e.reverse(),i=i.reverse()),n<e[0]?i[0]:n>e[1]?i[1]:t.extrapolateLinear(e,i,n)},t.calcScale=function(t,e,i,n){return Math.min(i/t,n/e)},t.mulM=function(t,e){for(var i=[],n=0;n<t.length;++n){i.push([]);for(var o=0;o<e[0].length;++o){i[n][o]=0;for(var r=0;r<e.length;++r)i[n][o]+=t[n][r]*e[r][o]}}return i},t.transM=function(t){for(var e=[],i=0;i<t.length;++i)for(var n=0;n<t[0].length;++n)e[n]||(e[n]=[]),e[n][i]=t[i][n];return e},t.mat=function(t){var e=0,i=t,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}e+=r}return e/t.length},t.disp=function(e){var i=t.mat(e),n=0,o=e,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}n+=(a-i)*(a-i)}return n/e.length},t.predict=function(e,i){var n=[],o=e.length;if(t.disp(e)<o&&o>1){for(var r=[],s=[],a=0;a<o;++a)r.push([a,1]),s.push([e[a]]);for(var l=t.transM(r),h=t.mulM(l,r),c=t.mulM(l,s),u=h[0][0]*h[1][1]-h[1][0]*h[0][1],d=[-(h[0][1]*c[1][0]-c[0][0]*h[1][1])/u,(h[0][0]*c[1][0]-h[1][0]*c[0][0])/u],f=0;f<i;++f){var p=Math.round(d[0]*(f+o)+d[1]);-1===n.indexOf(p)&&n.push(p)}}return n},t.getUnique=function(){return Math.ceil(1e9*Math.random())},t.setSplinePoints=function(t,e){t.points.length!==e.x.length&&console.warn("setSplinePoints: bad points");for(var i=0;i<t.points.length;++i)t.points[i].set(e.x[i],e.y[i],e.z?e.z[i]:0)},t.mapl2L=function(t,e,i,n){for(var o=e/(i-1),r=0,s=0,a=t[0];s<t.length-1&&r<e+.1*o;a+=t[++s])Math.abs(r-a)<Math.abs(r-a-t[s+1])&&(n(s,r),r+=o);r<e+.1*o&&console.warn("mapl2L: ls is not enought")},t.det2=function(t,e,i,n){return t*n-e*i},t.solve2Lin=function(e,i,n,o){var r=void 0,s=t.det2(e[0],e[1],n[0],n[1]);return Math.abs(s)>t.eps&&(r={x:t.det2(i,e[1],o,n[1])/s,y:t.det2(e[0],i,n[0],o)/s}),r},t.isInsidePoly=function(e,i){for(var n=!1,o=void 0,r=0;r<e.length;++r)if(t.v2dist(i,e[r])<t.eps){o=1,n=!0;break}for(;!n;){n=!0,o=0;for(var s={x:i.x+Math.random()-.5,y:i.y+Math.random()-.5},a={x:s.x-i.x,y:s.y-i.y},l=[a.y,-a.x],h=i.x*a.y-i.y*a.x,c=0;c<e.length;++c){var u=e[c],d=e[(c+1)%e.length],f={x:d.x-u.x,y:d.y-u.y},p=[f.y,-f.x],v=u.x*f.y-u.y*f.x,g=t.solve2Lin(l,h,p,v);if(g){if(t.v2dist(g,u)<t.eps||t.v2dist(g,d)<t.eps){n=!1;break}if(g.x>Math.min(u.x,d.x)-t.eps&&g.x<Math.max(u.x,d.x)+t.eps&&g.y>Math.min(u.y,d.y)-t.eps&&g.y<Math.max(u.y,d.y)+t.eps){if(t.v2dist(g,i)<t.eps){o=1;break}var m={x:g.x-i.x,y:g.y-i.y};o+=m.x*a.x+m.y*a.y>0}}}}return o%2},t.isInsideConvPoly=function(t,e){for(var i=[0,0],n=0;n<t.length;++n){var o=t[n],r=t[(n+1)%t.length],s={x:o.x-e.x,y:o.y-e.y},a={x:r.x-e.x,y:r.y-e.y};++i[(s.x*a.y-s.y*a.x<0)+0]}return~i.indexOf(t.length)},t.v2len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},t.v2dist=function(e,i){return t.v2len({x:i.x-e.x,y:i.y-e.y})},t.computeSquare=function(e){for(var i=[],n=0,o=0;o<e.length;++o)i.push(t.v2dist(e[o],e[(o+1)%e.length])),n+=.5*i[o];return Math.sqrt(n*(n-i[0])*(n-i[1])*(n-i[2]))},t.computeInterpCoefs=function(e,i){for(var n=t.computeSquare(e),o=[],r=e.length,s=0;s<r;++s)o[s]=t.computeSquare([i,e[(s+1)%r],e[(s+2)%r]])/n;return o},t}();n.sum=[n.sum1,n.sum2,n.sum3,n.sum4],n.eps=1e-4,e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n,o=i(0),r=(n=i(2))&&n.__esModule?n:{default:n},s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.splitSpline=function(t,i){for(var n={len:0,ls:[0]},o=1/i,r=0;r<=i;++r){var s=t.getPoint(r*o);if(r){var a=e.v1.distanceTo(s);n.len+=a,n.ls.push(a)}e.v1.copy(s)}return n},e.getLinearIndeces=function(t,i){for(var n=[0],o=0,r=0;r<=5e3;++r){var s=t.getPoint(2e-4*r);if(r){var a=e.v1.distanceTo(s);o+=a,n.push(a)}e.v1.copy(s)}n.push(1e7);for(var l=[],h=o/(i-1),c=0,u=0,d=n[0];c<n.length-1;d+=n[++c])Math.abs(u-d)<Math.abs(u-d-n[c+1])&&(l.push(2e-4*c),u+=h);return l},e.refinePoly=function(t,e){for(var i=[],n=0;n<t.length;++n){var s=t[n],a=t[(n+1)%t.length],l=r.default.v2dist(s,a),h=Math.ceil(l/e),c=l/h;i.push(s);for(var u=1;u<h;++u)i.push(new o.THREE.Vector2(s.x+u*c*(a.x-s.x)/l,s.y+u*c*(a.y-s.y)/l))}return i},e}(r.default);s.v1=new o.THREE.Vector3,e.default=s},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.normalizeUrl=function(t){function e(t){return t.replace(/\\/g,"/").split("/")}var i=e(window.location.href);return t=e(t),i[2]===t[2]&&(t[0]=i[0]),t.join("/")},t.extends=function(t,e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])},t.defaultCmp=function(t,e){return t-e},t.lowerBound=function(e,i,n){n=n||t.defaultCmp;for(var o=0,r=e.length-1;r-o>1;){var s=Math.floor((o+r)/2);n(i,e[s])<0?r=s:o=s}return n(i,e[r])>=0?r:o},t}();e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n,o=i(0),r=(n=i(7))&&n.__esModule?n:{default:n},s=function(){function t(e,i,n,o){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.context=e,this.wnd=e.wnd,this.doc=e.doc,this.element=e.element||e.doc.body,this.c=e.renderCanvas||t.renderCanvas,this.ctx=e.renderCanvasCtx||t.renderCanvasCtx,this.resW=this.width=i,this.resH=this.height=n,this.color=o}return t.prototype.setResolution=function(t){this.resW=t.width,this.resH=t.height},t.prototype.dispose=function(){},t.prototype.renderBlankPage=function(){this.ctx.beginPath(),this.ctx.fillStyle=r.default.color2Rgba(this.color,1),this.ctx.rect(0,0,this.c.width,this.c.height),this.ctx.fill()},t.prototype.renderImage=function(t){this.pushCtx(),this.ctx.drawImage(t,0,0),this.popCtx()},t.prototype.normToConv=function(t){return{x:t.x*this.c.width,y:(1-t.y)*this.c.height}},t.prototype.renderHit=function(t){var e=this.ctx;e.fillStyle="rgba(255,255,0,0.4)",e.beginPath();var i=this.normToConv(t[0]);e.moveTo(i.x,i.y);for(var n=1;n<t.length;++n)i=this.normToConv(t[n]),e.lineTo(i.x,i.y);e.closePath(),e.fill()},t.prototype.pushCtx=function(){return this.resW!=this.c.width&&(this.c.width=this.resW),this.resH!=this.c.height&&(this.c.height=this.resH),this.ctx.save(),this.ctx.scale(this.c.width/this.width,this.c.height/this.height),this.ctx},t.prototype.popCtx=function(){this.ctx.restore()},t.prototype.renderNotFoundPage=function(){this.renderBlankPage()},t.prototype.finishRender=function(){this.onChange&&this.onChange(this.c)},t.prototype.finishLoad=function(){this.onLoad?this.onLoad():this.startRender()},t.prototype.getSimulatedDoc=function(){},t}();s.renderCanvas=(0,o.$)("<canvas>")[0],s.renderCanvasCtx=s.renderCanvas.getContext("2d"),e.default=s},function(t,e,i){"use strict";e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},o=i(0),r=function(){function t(e,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.wnd=e,this.doc=i,this.enabled=!0}return t.prototype.setEnable=function(t){t||(this.mCapObject&&(this.notify(this.mCapObject,o.$.Event("mouseup"),"mouseup"),this.mCapObject=void 0),this.mHovObject&&(this.notify(this.mHovObject,o.$.Event("mouseout"),"mouseout"),this.mHovObject=void 0)),this.enabled=t},t.prototype.getCallback=function(t){},t.prototype.notify=function(t,e,i){var r=this.getCallback(t);if(r){var s=n({},e,{type:i,view:this.wnd});r(o.$.Event(i,s),t)}},t.prototype.convert=function(t,e){if(this.enabled){this.filter&&(t=this.filter(this.element,t));var i=this.getObject(t,e);(~t.type.indexOf("touch")?this.convertTouch(t,e,i):this.convertMouse(t,e,i))&&i&&this.notify(i,t,t.type)}},t.prototype.convertTouch=function(t,e,i){var n=!0;switch(t.type){case"touchstart":this.tCapObject&&this.notify(this.tCapObject,t,"touchend"),this.tCapObject=i;break;case"touchend":this.tCapObject&&!this.test(this.tCapObject,i)?(this.notify(this.tCapObject,t,"touchend"),n=!1):i&&this.test(this.tCapObject,i)&&this.notify(i,t,"touchtap"),this.tCapObject=void 0;break;case"touchtap":n=!1}return n},t.prototype.convertMouse=function(t,e,i){var n=!0;switch(t.type){case"mousedown":this.mCapObject&&this.notify(this.mCapObject,t,"mouseup"),this.mCapObject=i;break;case"mouseup":this.mCapObject&&!this.test(this.mCapObject,i)&&(this.notify(this.mCapObject,t,"mouseup"),n=!1);break;case"click":n=this.test(this.mCapObject,i),this.mCapObject=void 0;break;case"mouseenter":case"mouseover":case"mousemove":!this.test(this.mHovObject,i)&&this.mHovObject&&(this.notify(this.mHovObject,t,"mouseout"),this.mHovObject=void 0),!this.mHovObject&&i&&(this.notify(i,t,"mouseover"),this.mHovObject=i),n="mousemove"===t.type;break;case"mouseleave":case"mouseout":this.mHovObject&&(this.notify(this.mHovObject,t,"mouseout"),this.mHovObject=void 0),n=!1}return n},t}();e.default=r},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.extrapolateLinear=function(t,e,i){return e[0]+(e[1]-e[0])/(t[1]-t[0])*(i-t[0])},t.interpolate01=function(e,i,n){return t.extrapolateLinear([0,1],[e,i],n)},t.getColorBytes=function(t){return[t>>16&255,t>>8&255,255&t]},t.inverseColor=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t.getColorBytes(e),o=[255-n[0],255-n[1],255-n[2]],r=[Math.round(t.interpolate01(n[0],o[0],i)),Math.round(t.interpolate01(n[1],o[1],i)),Math.round(t.interpolate01(n[2],o[2],i))];return t.bytes2Color(r)},t.color2Rgba=function(e,i){return t.bytes2Rgba(t.getColorBytes(e),i)},t.bytes2Rgba=function(t,e){return"rgba("+t.join(",")+","+e+")"},t.bytes2Color=function(t){return t[2]|t[1]<<8|t[0]<<16},t}();e.default=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=n(i(14)),r=n(i(43)),s=n(i(59)),a=n(i(57)),l=n(i(51)),h=function(){function t(e,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.context=e,this.cache=i||new o.default}return t.prototype.build=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:210,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:297,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:16777215,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,c=void 0;switch(t.type){case"html":c=new l.default(this.context,i,n,o,t.src,this.cache,h);break;case"image":c=new s.default(this.context,i,n,o,t.src);break;case"pdf":c=new a.default(this.context,i,n,o,t.src,e);break;case"blank":default:c=new r.default(this.context,i,n,o)}return c},t}();e.default=h},function(t,e,i){"use strict";e.__esModule=!0;var n,o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(11),s=(n=i(2))&&n.__esModule?n:{default:n},a=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.onReady=e,this.defaults=(0,r.props)()}return t.prototype.dispose=function(){},t.prototype.calcSize=function(t,e){var i=s.default.calcScale(t,e,this.defaults.width,this.defaults.height);return{width:i*t,height:i*e}},t.prototype.calcTexels=function(t,e){var i=this.defaults.sheet,n=s.default.calcScale(t,e,i.widthTexels,i.heightTexels);return{widthTexels:n*t,heightTexels:n*e}},t.prototype.calcProps=function(t,e){this.props=o({},this.defaults,this.calcSize(t,e),{sheet:o({},this.defaults.sheet,this.calcTexels(t,e)),cover:o({},this.defaults.cover),page:o({},this.defaults.page)})},t.prototype.calcSheets=function(t){return this.sheets=Math.ceil(Math.max(0,t-4)/2)},t.prototype.getSheets=function(){return this.sheets},t.prototype.getProps=function(){return this.props},t.prototype.getPageCallback=function(){return this.binds.pageCallback},t.prototype.ready=function(){this.onReady&&this.onReady(this.getProps(),this.getSheets(),this.getPageCallback())},t}();e.default=a},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(1),a=n(i(41)),l=n(i(3)),h=n(i(20)),c=function(){function t(e,i,n,o){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=this,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"closed",d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.visual=e,this.p=r({},i,{first:n,last:o});var f=this.getProps(),p=this.loadPoints();Object.keys(p).map(function(t){c[t]=p[t][f.shape]||p[t][0]}),this.pSpline=new s.THREE.Spline([]);for(var v=0;v<this.interpolationPoints.x[0].length;++v)this.pSpline.points.push(new s.THREE.Vector3);this.iSpline=new s.THREE.Spline([]);for(var g=0;g<a.default.resX;++g)this.iSpline.points.push(new s.THREE.Vector3);if(this.aSplines=[],this.geometry=a.default.geometry.clone(),this.p.sideFaces=[{first:0,last:a.default.faces[0]},{first:a.default.faces[0],last:a.default.faces[1]}],this.sideTexture=new s.THREE.Texture,this.sideTexture.wrapT=s.THREE.RepeatWrapping,this.sideTexture.repeat.set(0,o-n),this.sideTexture.image=f.sideTexture,this.sideTexture.needsUpdate=!0,this.materials=[new s.THREE.MeshPhongMaterial,new s.THREE.MeshPhongMaterial,new s.THREE.MeshPhongMaterial({map:this.sideTexture}),new s.THREE.MeshPhongMaterial({map:this.sideTexture}),new s.THREE.MeshPhongMaterial({map:this.sideTexture}),new s.THREE.MeshPhongMaterial({map:this.sideTexture})],this.p.setTexture(this.materials[0],2*n),this.p.setTexture(this.materials[1],2*o-1),this.mesh=new s.THREE.Mesh(this.geometry,new s.THREE.MeshFaceMaterial(this.materials)),this.mesh.castShadow=!1,this.mesh.receiveShadow=!1,this.three=this.mesh,this.three.userData.self=this,this.markers=[],this.p.marker.use){var m=this.geometry.vertices.length,y=Array.apply(0,Array(m)).map(function(t,e){return e}),b=Array.isArray(y),w=0;for(y=b?y:y[Symbol.iterator]();;){var k;if(b){if(w>=y.length)break;k=y[w++]}else{if((w=y.next()).done)break;k=w.value}var x=k,C=h.default.createMarker(this.geometry.vertices[x],x<m/2?16711680:65280,this.p.marker.size);this.markers.push({marker:C,vertex:x}),this.three.add(C)}}this.corner={use:!0,height:0,maxDistance:0,points:[],OZ:new s.THREE.Vector3(0,0,1),axis:new s.THREE.Vector3},this.set(0,"closed",d,n,o),this.set(l,u,d,n,o)}return t.prototype.dispose=function(){var t=this.materials,e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}var o=n;o.map&&(o.map=null,o.needsUpdate=!0),o.dispose()}delete this.materials,this.geometry.dispose()},t.prototype.getSize=function(){return this.p.last-this.p.first},t.prototype.getProps=function(){return r({},this.p.page,{sheets:this.p.sheets})},t.prototype.getTopCerners=function(){var t=this.angle>Math.PI/2?this.geometry.vertices.length/2:0;return[this.geometry.vertices[t],this.geometry.vertices[a.default.resX-1+t],this.geometry.vertices[(a.default.resZ-1)*a.default.resX+t],this.geometry.vertices[a.default.resZ*a.default.resX-1+t]]},t.prototype.getTopSize=function(){var t=this.getTopCerners();return{width:t[0].distanceTo(t[1]),height:t[0].distanceTo(t[2])}},t.prototype.getTopWorldRotation=function(t){return t.x=-Math.PI/2,t},t.prototype.getTopWorldPosition=function(t){var e=this.geometry.vertices.length,i=this.angle>Math.PI/2?e/2:0,n=[this.geometry.vertices[i],this.geometry.vertices[a.default.resX-1+i],this.geometry.vertices[(a.default.resZ-1)*a.default.resX+i],this.geometry.vertices[a.default.resZ*a.default.resX-1+i]];t.set(0,0,0);var o=n,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var l;if(r){if(s>=o.length)break;l=o[s++]}else{if((s=o.next()).done)break;l=s.value}var h=l;t.x+=.25*h.x,t.y+=.25*h.y,t.z+=.25*h.z}return this.three.localToWorld(t),t},t.prototype.getInterpolationPoints=function(t,e){var i={x:[],y:[]},n=this.getProps().wave,o=t,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var l=a;i.x.push([].concat(this.interpolationPoints.x[l])),i.y.push(~e.indexOf(l)?this.interpolationPoints.y[l].map(function(t){return n*t}):[].concat(this.interpolationPoints.y[l]))}return i},t.prototype.set=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.corner.height,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.p.first,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.p.last,s=Math.PI;this.state=e;var a=void 0,l=void 0;"object"===(void 0===t?"undefined":o(t))?(this.angle=t.openedAngle,a=t.closedAngle,l=t.binderTurn>s/2?s-t.binderTurn:t.binderTurn):this.angle=t,this.corner.height=i,this.p.first===n&&this.p.last===r||(this.sideTexture.repeat.set(0,r-n),this.sideTexture.needsUpdate=!0,this.p.first!==n&&this.p.setTexture(this.materials[0],2*n),this.p.last!==r&&this.p.setTexture(this.materials[1],2*r-1)),this.p.first=n,this.p.last=r;var h=void 0,c=this.getProps();if("closed"===this.state)h=this.getInterpolationPoints(this.closedInterpolationIndeces,this.closedInterpolationIndeces);else if("opened"===this.state)if(void 0!==a&&Math.abs(a-s/2)>.01){h=this.getInterpolationPoints(this.flatInterpolationIndeces,[]);var u=this.getPointsAtAngle(this.getInterpolationPoints(this.closedInterpolationIndeces,this.closedInterpolationIndeces),a>s/2?s-a:a);h.x=[u.x].concat(h.x),h.y=[u.y].concat(h.y)}else h=this.getInterpolationPoints(this.openedInterpolationIndeces,this.closedInterpolationIndeces);var d=void 0,f=void 0,p=.5*c.sheets*c.depth;"closed"===this.state&&(p-=7e-6*this.p.scale),this.angle<=s/2?(d=(c.sheets-n)*c.depth,f=(c.sheets-r)*c.depth):(d=n*c.depth,f=r*c.depth);var v=this.angle>s/2?s-this.angle:this.angle,g="closed"===this.state?v:void 0===l?s/2:l,m=this.getPointsAtAngleAndHs(h,v,g,[d/c.width,f/c.width]),y=m[0],b=m[1];this.angle>s/2&&(this.inverse(y),this.inverse(b),p=-p),this.setPoints(y,b,p)},t.prototype.setPoints=function(t,e,i){for(var n=this,o=this.getProps(),r=0,l=[e,t],h=0;h<a.default.resY;++h)for(var c=0;c<a.default.resZ;++c)for(var u=0;u<a.default.resX;++u)this.geometry.vertices[r++].set(l[h].x[u]*o.width+i,l[h].y[u]*o.width,c*o.height/(a.default.resZ-1)-.5*o.height);if(r!==this.geometry.vertices.length&&console.warn("setPoints: bad mapping!"),this.corner.use&&!this.corner.points.length){var d=new s.THREE.Plane,f=d.normal,p=(1-this.getProps().flexibleCorner)*Math.min(o.width,o.height),v=new s.THREE.Vector3;d.setFromNormalAndCoplanarPoint(new s.THREE.Vector3(-1,0,-1).normalize(),new s.THREE.Vector3(p+i,0,.5*o.height));for(var g=0,m=this.geometry.vertices.length;g<m;++g)if(d.projectPoint(this.geometry.vertices[g],v),v.sub(this.geometry.vertices[g]),v.x*f.x+v.y*f.y+v.z*f.z>0){var y=v.length()/p;this.corner.maxDistance=Math.max(this.corner.maxDistance,y),this.corner.points.push({vertex:g,distance:y})}}if(this.corner.use&&Math.abs(this.corner.height)>.001){this.corner.axis.set(-1,0,1).normalize(),this.corner.axis.applyAxisAngle(this.corner.OZ,this.angle);var b=this.corner.points,w=Array.isArray(b),k=0;for(b=w?b:b[Symbol.iterator]();;){var x;if(w){if(k>=b.length)break;x=b[k++]}else{if((k=b.next()).done)break;x=k.value}var C=x;this.geometry.vertices[C.vertex].applyAxisAngle(this.corner.axis,function(t){return o.cornerDeviation*n.corner.height/(1+Math.exp(-o.bending*(t-.5*n.corner.maxDistance)))}(C.distance))}}var P=this.markers,S=Array.isArray(P),E=0;for(P=S?P:P[Symbol.iterator]();;){var _;if(S){if(E>=P.length)break;_=P[E++]}else{if((E=P.next()).done)break;_=E.value}var T=_;T.marker.position.copy(this.geometry.vertices[T.vertex])}this.geometry.computeVertexNormals(),this.geometry.computeBoundingSphere(),this.geometry.verticesNeedUpdate=!0,this.markup&&this.markup.computeVertices()},t.prototype.inverse=function(t){for(var e=0;e<t.x.length;++e)t.x[e]=-t.x[e];return t},t.prototype.getPointsAtHs=function(t,e,i){var n=this,o=1e3;l.default.setSplinePoints(this.pSpline,t);var s=l.default.splitSpline(this.pSpline,o),h=[],c=r({},this.pSpline.getPoint(.999)),u=r({},this.pSpline.getPoint(1)),d=u.x-c.x,f=u.y-c.y,p=Math.sqrt(d*d+f*f),v=this.pSpline.points[this.pSpline.points.length-1];v.set(v.x+.1*d/p,v.y+.1*f/p,0),(s=l.default.splitSpline(this.pSpline,o)).ls.push(1e7),l.default.mapl2L(s.ls,s.len,a.default.resX,function(t){for(var s=0;s<i.length;++s)if(t){var a=r({},n.pSpline.getPoint((t-1)/o)),l=n.pSpline.getPoint(t/o),c=-(l.y-a.y),u=l.x-a.x,d=Math.sqrt(c*c+u*u);h[s].x.push(l.x+c/d*i[s]),h[s].y.push(l.y+u/d*i[s])}else h[s]={x:[-i[s]*Math.sin(e)],y:[i[s]*Math.cos(e)]}});for(var g=[],m=0;m<i.length;++m)!function(t){g[t]={x:[],y:[]},l.default.setSplinePoints(n.iSpline,h[t]);var e=l.default.splitSpline(n.iSpline,o);e.ls.push(1e7),l.default.mapl2L(e.ls,1,a.default.resX,function(e){var i=n.iSpline.getPoint(e/o);g[t].x.push(i.x),g[t].y.push(i.y)})}(m);return g},t.prototype.getPointsAtAngleAndHs=function(t,e,i,n){var o=this.getPointsAtAngle(t,e);return this.getPointsAtHs(o,i,n)},t.prototype.getPointsAtAngle=function(t,e){var i={x:[],y:[]},n=[];e/=Math.PI/2;for(var o=0;o<t.x.length;++o)n.push(o/(t.x.length-1));for(var r=0;r<t.x[0].length;++r){for(var s=[],a=[],l=0;l<t.x.length;++l)s.push(t.x[l][r]),a.push(t.y[l][r]);i.x.push(this.interpolate(n,s,e)),i.y.push(this.interpolate(n,a,e))}return i},t.prototype.interpolate=function(t,e,i){if(!this.aSplines[t.length]){this.aSplines[t.length]=new s.THREE.Spline([]);for(var n=this.aSplines[t.length].points,o=0;o<t.length;++o)n.push(new s.THREE.Vector3)}for(var r=this.aSplines[t.length],a=0;a<t.length;++a)r.points[a].set(t[a],e[a],0);return r.getPoint(Math.min(1,Math.max(i,0))).y},t.prototype.loadPoints=function(){for(var t=[],e=[],i=[0,.2877,.6347,.8174,1],n=0;n<i.length;n++){var o=i[n];t.push(o*Math.cos(.9*Math.PI/4)),e.push(o*Math.sin(.9*Math.PI/4))}return{interpolationPoints:[{x:[[0,.2877,.6347,.8174,1],[0,.286,.632,.815,.997],[0,.279,.623,.806,.988],[0,.126,.411,.593,.774],[0,0,0,0,0],t],y:[[0,0,0,0,0],[0,.03,.01,.002,0],[0,.06,.017,.004,0],[0,.259,.44,.446,.429],[0,.2877,.6347,.8174,1],e]},{x:[[0,.2877,.6347,.8174,1],[0,.286,.632,.815,.997],[0,.279,.623,.806,.988],[0,.233,.563,.746,.927],[0,.144,.433,.613,.796],[0,.07,.288,.455,.626],[0,0,0,0,0],t],y:[[0,0,0,0,0],[0,.03,.01,.002,0],[0,.06,.017,.004,0],[0,.168,.269,.27,.255],[0,.245,.435,.458,.46],[0,.278,.544,.614,.673],[0,.2877,.6347,.8174,1],e]}],openedInterpolationIndeces:[[2,3,4],[2,3,4,5,6]],closedInterpolationIndeces:[[0,1,2],[0,1,2]],flatInterpolationIndeces:[[5,4],[7,6]]}},t}();e.default=c},function(t,e,i){"use strict";e.__esModule=!0,e.props=function(){return{height:.297,width:.21,gravity:1,cachedPages:50,renderInactivePages:!0,renderInactivePagesOnMobile:!1,renderWhileFlipping:!1,pagesForPredicting:5,preloadPages:5,rtl:!1,sheet:{startVelocity:.9,cornerDeviation:.25,flexibility:10,flexibleCorner:.5,bending:11,wave:.5,shape:0,widthTexels:1050,heightTexels:1485,color:16777215},cover:{binderTexture:"",depth:3e-4,padding:0,mass:.003},page:{depth:1e-4,mass:.001},cssLayerProps:{width:1024}}}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0,e.CSS3DSprite=e.CSS3DObject=void 0;var s=i(0);s.THREE.CSS3DObject=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;n(this,e);var r=o(this,t.call(this));return i&&r.set(i),r}return r(e,t),e.prototype.set=function(t){this.element=t,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})},e}(s.THREE.Object3D),s.THREE.CSS3DSprite=function(t){function e(i){return n(this,e),o(this,t.call(this,i))}return r(e,t),e}(s.THREE.CSS3DObject),s.THREE.CSS3DRenderer=function t(){function e(t){return Math.abs(t)<1e-10?0:t}function i(t,i){var n=t.elements,o="matrix3d("+e(n[0])+","+e(n[1])+","+e(n[2])+","+e(n[3])+","+e(-n[4])+","+e(-n[5])+","+e(-n[6])+","+e(-n[7])+","+e(n[8])+","+e(n[9])+","+e(n[10])+","+e(n[11])+","+e(n[12])+","+e(n[13])+","+e(n[14])+","+e(n[15])+")";return p?"translate(-50%,-50%)translate("+l+"px,"+h+"px)"+i+o:"translate(-50%,-50%)"+o}function o(t,e,n){if(t instanceof s.THREE.CSS3DObject){var r;t instanceof s.THREE.CSS3DSprite?(c.copy(e.matrixWorldInverse),c.transpose(),c.copyPosition(t.matrixWorld),c.scale(t.scale),c.elements[3]=0,c.elements[7]=0,c.elements[11]=0,c.elements[15]=1,r=i(c,n)):r=i(t.matrixWorld,n);var a=t.element,l=u.objects[t.id]&&u.objects[t.id].style;void 0!==l&&l===r||(a.style.WebkitTransform=r,a.style.MozTransform=r,a.style.transform=r,u.objects[t.id]={style:r},p&&(u.objects[t.id].distanceToCameraSquared=m(e,t))),a.parentNode!==f&&f.appendChild(a)}for(var h=0,d=t.children.length;h<d;h++)o(t.children[h],e,n)}n(this,t);var r,a,l,h,c=new s.THREE.Matrix4,u={camera:{fov:0,style:""},objects:{}},d=document.createElement("div");d.style.overflow="hidden",this.domElement=d;var f=document.createElement("div");f.style.WebkitTransformStyle="preserve-3d",f.style.MozTransformStyle="preserve-3d",f.style.transformStyle="preserve-3d",d.appendChild(f);var p=/Trident/i.test(navigator.userAgent);this.setClearColor=function(){},this.getSize=function(){return{width:r,height:a}},this.setSize=function(t,e){l=(r=t)/2,h=(a=e)/2,d.style.width=t+"px",d.style.height=e+"px",f.style.width=t+"px",f.style.height=e+"px"};var v,g,m=(v=new s.THREE.Vector3,g=new s.THREE.Vector3,function(t,e){return v.setFromMatrixPosition(t.matrixWorld),g.setFromMatrixPosition(e.matrixWorld),v.distanceToSquared(g)});this.render=function(t,i){var n=i.projectionMatrix.elements[5]*h;u.camera.fov!==n&&(d.style.WebkitPerspective=n+"px",d.style.MozPerspective=n+"px",d.style.perspective=n+"px",u.camera.fov=n),t.updateMatrixWorld(),null===i.parent&&i.updateMatrixWorld();var r,s="translateZ("+n+"px)matrix3d("+e((r=i.matrixWorldInverse.elements)[0])+","+e(-r[1])+","+e(r[2])+","+e(r[3])+","+e(r[4])+","+e(-r[5])+","+e(r[6])+","+e(r[7])+","+e(r[8])+","+e(-r[9])+","+e(r[10])+","+e(r[11])+","+e(r[12])+","+e(-r[13])+","+e(r[14])+","+e(r[15])+")",a=s+"translate("+l+"px,"+h+"px)";u.camera.style===a||p||(f.style.WebkitTransform=a,f.style.MozTransform=a,f.style.transform=a,u.camera.style=a),o(t,i,s),p&&function(t){var e=Object.keys(u.objects).sort(function(t,e){return u.objects[t].distanceToCameraSquared-u.objects[e].distanceToCameraSquared}),i=e.length;t.traverse(function(t){var n=e.indexOf(t.id+"");-1!==n&&(t.element.style.zIndex=i-n)})}(t)}},e.default=s.THREE.CSS3DRenderer;var a=s.THREE.CSS3DObject,l=s.THREE.CSS3DSprite;e.CSS3DObject=a,e.CSS3DSprite=l},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _libs=__webpack_require__(0),_CSS3DRenderer=__webpack_require__(12),CSSLayer=function(_CSS3DObject){function CSSLayer(t,e,i){_classCallCheck(this,CSSLayer);var n=_possibleConstructorReturn(this,_CSS3DObject.call(this));n.props=i,n.jContainer=(0,_libs.$)('<div class="hidden css-layer"></div>');var o=i.width,r=e/t*o;return n.jContainer.width(o).height(r),n.scale.x/=o/t,n.scale.y/=o/t,n.setData(),n.set(n.jContainer[0]),n}return _inherits(CSSLayer,_CSS3DObject),CSSLayer.init=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;CSSLayer.delay=e,CSSLayer.style=(0,_libs.$)("<style type=text/css>\n      .css-layer {\n    \t\topacity: 1;\n    \t\ttransition: opacity "+e+"ms ease-out;\n        visibility: visible;\n        overflow: hidden;\n    \t}\n    \t.css-layer.hidden {\n    \t\ttransition: opacity "+e+"ms ease-in, visibility "+e+"ms step-end;\n    \t\topacity: 0;\n        visibility: hidden;\n      }\n    </style>").appendTo(t.head)},CSSLayer.dispose=function(){CSSLayer.style.remove()},CSSLayer.prototype.callInternal=function(t){if(this.object&&this.object[t])try{this.object[t]()}catch(t){console.error(t)}},CSSLayer.prototype.dispose=function(){this.clearInternals()},CSSLayer.prototype.clearInternals=function(){this.callInternal("dispose"),!this.css||this.css.remove(),!this.html||this.html.remove()},CSSLayer.prototype.setData=function setData(){var css=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",html=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",js=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.clearInternals(),this.css=(0,_libs.$)('<style type="text/css">'+css+"</style>").appendTo(this.jContainer),this.html=(0,_libs.$)(html).appendTo(this.jContainer);var init=eval(js);init&&(this.object=init(this.jContainer,this.props)||{})},CSSLayer.prototype.pendedCall=function(t){var e=this,i=this.timestamp=Date.now();setTimeout(function(){i===e.timestamp&&t()},CSSLayer.delay)},CSSLayer.prototype.isHidden=function(){return this.jContainer.hasClass("hidden")},CSSLayer.prototype.hide=function(){var t=this,e=void 0;return this.isHidden()?e=Promise.resolve():(this.jContainer.addClass("hidden"),this.callInternal("hide"),e=new Promise(function(e){t.pendedCall(function(){t.callInternal("hidden"),e()})})),e},CSSLayer.prototype.show=function(){var t=this,e=void 0;return this.isHidden()?(this.jContainer.removeClass("hidden"),this.callInternal("show"),e=new Promise(function(e){t.pendedCall(function(){t.callInternal("shown"),e()})})):e=Promise.resolve(),e},CSSLayer}(_CSS3DRenderer.CSS3DObject);exports.default=CSSLayer},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.countSizeof;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.os=new Map,this.sizeof=i,this.maxSize=e,this.size=0}return t.prototype.forEach=function(t){this.os.forEach(function(e,i){return t([i,e])})},t.countSizeof=function(t){return 1},t.prototype.remove=function(t){var e=!1,i=this.os.get(t);return i.locked&&i.locked(t)||(this.size-=this.sizeof(i),i.dispose&&i.dispose(),this.os.delete(t),e=!0),e},t.prototype.freeSpace=function(){var t=[],e=this.os,i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var o;if(i){if(n>=e.length)break;o=e[n++]}else{if((n=e.next()).done)break;o=n.value}var r=o;t.push({timestamp:r[1].timestamp,key:r[0]})}t.sort(function(t,e){return t.timestamp-e.timestamp});for(var s=0;s<t.length&&this.size>3*this.maxSize/4;++s)this.remove(t[s].key)},t.prototype.dispose=function(){var t=[],e=this.os,i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var o;if(i){if(n>=e.length)break;o=e[n++]}else{if((n=e.next()).done)break;o=n.value}var r=o;t.push({v:r[1],k:r[0]})}var s=t,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var h;if(a){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}var c=h;c.v.dispose&&c.v.dispose(),this.os.delete(c.k)}},t.recursionSizeof=function(e){var i=0;if(e){++i;var n=e.length;if(void 0===n)for(var o in e)e.hasOwnProperty(o)&&(i+=t.recursionSizeof(e[o]));else i+=n}return i},t.prototype.getTimestamp=function(){return Date.now()},t.prototype.get=function(t){var e=this.os.get(t);return e&&(e.timestamp=this.getTimestamp()),e},t.prototype.put=function(t,e){return e.timestamp=this.getTimestamp(),this.os.set(t,e),this.size+=this.sizeof(e),this.size>this.maxSize&&this.freeSpace(),e},t}();e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleDefault=function(t,e,i){},e.prototype.dispatchAsync=function(t){var e=this;Promise.resolve().then(function(){return e.dispatchEvent(t)})},e.prototype.dispose=function(){},e}(i(0).THREE.EventDispatcher);e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n,o=function(t){function e(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!1},r=arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n));return s.eDoc=r,s.customTest=o,s.customs=[],s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.test=function(t,e){return!(!t||!e)&&this.customTest(t,e)},e.prototype.getCallback=function(t){return t.target.callback},e.prototype.addCustom=function(t){this.customs.push(t)},e.prototype.getObject=function(t,e){var i=void 0;if(e.doc===this.eDoc){var n=this.customs,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}if(i=s.testIntersection(t,e))break}}return i},e}(((n=i(6))&&n.__esModule?n:{default:n}).default);e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n,o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=(n=i(4))&&n.__esModule?n:{default:n},s=function(){function t(e,i,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.props=o({},t.defaults,n),this.strs=e,this.merge(e),this.hits=[],this.contexts=[],this.pattern=i.toLowerCase(),this.lstr=this.str.toLowerCase();for(var r=0;-1!==(r=this.lstr.indexOf(this.pattern,r));)this.addHits(r),this.addContext(r),r+=this.pattern.length}return t.isDelimetr=function(e){return e===t.DELIMITER},t.prototype.merge=function(){for(var e=[],i=[],n=this.strs,o=0,r=0;r<n.length;++r)n[r].length&&(i.push({base:r,offset:o}),e.push(n[r]),o+=n[r].length,r<n.length-1&&!t.isDelimetr(n[r].charAt(n[r].length-1))&&!t.isDelimetr(n[r+1].charAt(0))&&(e.push(t.DELIMITER),++o));this.map=i,this.str=e.join("")},t.prototype.addHits=function(e){var i=this.map[r.default.lowerBound(this.map,{offset:e},function(t,e){return t.offset-e.offset})],n=this.pattern.length,o=i.base;for(e-=i.offset;n;)if(this.strs[o].length){var s=o<this.strs.length-1&&!t.isDelimetr(this.strs[o].charAt(this.strs[o].length-1))&&!t.isDelimetr(this.strs[o+1].charAt(0)),a=Math.min(this.strs[o].length+(s?1:0)-e,n);e<this.strs[o].length&&this.hits.push({index:o,offset:e,length:Math.min(a,this.strs[o].length-e)}),n-=a,++o,e=0}},t.prototype.addContext=function(e){for(var i=e,n=e+this.pattern.length-1,o=this.props.contextLength,r=o+1;o&&r-o;)if(r=o,o%2){for(var s=i-2;s>=0;--s)if(t.isDelimetr(this.str[s])||0===s){i=0===s?0:s+1,--o;break}}else for(var a=n+2;a<this.str.length;++a)if(t.isDelimetr(this.str[a])||a===this.str.length-1){n=a===this.str.length-1?a===this.str.length-1:a-1,--o;break}this.contexts.push(this.str.substr(i,n-i+1))},t.prototype.getHits=function(){return this.hits},t.prototype.getContexts=function(){return this.contexts},t}();s.DELIMITER=" ",s.defaults={contextLength:7,hits:!0,contexts:!0},e.default=s},function(t,e,i){"use strict";e.__esModule=!0;var n,o=i(0),r=(n=i(4))&&n.__esModule?n:{default:n};o.PDFJS.workerSrc=(window.PDFJS_LOCALE?PDFJS_LOCALE:i.i({pdfJsWorker:"https://centurysoftwares.com/idondza/pages/js/pdf.worker.js",pdfJsCMapUrl:"cmaps/"})).pdfJsWorker,o.PDFJS.cMapUrl=(window.PDFJS_LOCALE?PDFJS_LOCALE:i.i({pdfJsWorker:"https://centurysoftwares.com/idondza/pages/js/pdf.worker.js",pdfJsCMapUrl:"cmaps/"})).pdfJsCMapUrl,o.PDFJS.cMapPacked=!0,o.PDFJS.disableAutoFetch=!0,o.PDFJS.disableStream=!0,o.PDFJS.imageResourcesPath="images/pdfjs/",o.PDFJS.externalLinkTarget=o.PDFJS.LinkTarget.BLANK;var s=function(){function t(e,i){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.src=r.default.normalizeUrl(e),this.handlerQueue=[],this.progresData={loaded:-1,total:1},this.loadingProgress=i,this.task=o.PDFJS.getDocument({url:this.src,rangeChunkSize:524288}),this.task.onProgress=function(t){if(n.loadingProgress){var e=Math.floor(100*t.loaded/t.total),i=Math.floor(100*n.progresData.loaded/n.progresData.total);e!==i&&(e=(e=isNaN(e)?0:e)>100?100:e,Promise.resolve().then(function(){n.loadingProgress(e)}))}n.progresData=t},this.task.then(function(t){t.numPages>1?Promise.all([t.getPage(1),t.getPage(2)]).then(function(e){n.init(t,e)}):n.init(t)}).catch(function(t){return console.error(t)})}return t.prototype.init=function(e,i){this.handler=e,this.doubledPages=!!i&&Math.abs(2*t.getPageSize(i[0]).width-t.getPageSize(i[1]).width)/t.getPageSize(i[0]).width<.01;var n=Promise.resolve(e),o=this.handlerQueue.reverse(),r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if("break"===function(){if(r){if(s>=o.length)return"break";a=o[s++]}else{if((s=o.next()).done)return"break";a=s.value}var t=a;n=n.then(function(e){return t(e),e})}())break}},t.prototype.getPageType=function(t){return this.doubledPages&&0!==t&&t!==this.getPagesNum()-1?1&t?"left":"right":"full"},t.prototype.getPage=function(t){return this.handler.getPage(this.doubledPages?Math.ceil(t/2)+1:t+1)},t.prototype.dispose=function(){this.handlerQueue.splice(0,this.handlerQueue.length),delete this.handler},t.prototype.setLoadingProgressClb=function(t){this.loadingProgress=t},t.prototype.getPagesNum=function(){return this.handler?this.doubledPages?2*(this.handler.numPages-1):this.handler.numPages:void 0},t.getPageSize=function(t){return{width:t.view[2]-t.view[0],height:t.view[3]-t.view[1]}},t.prototype.getHandler=function(t){this.handler?t(this.handler):this.handlerQueue.push(t)},t}();e.default=s},function(t,e,i){"use strict";e.__esModule=!0;var n=i(0),o=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.objectsAndFacesTest;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.visual=e,this.coords=new n.THREE.Vector2,this.raycaster=this.visual.raycaster,this.camera=this.visual.camera,this.threes=[],this.test=i}return t.objectsTest=function(t,e){return!(!t||!e)&&t.object===e.object},t.objectsAndFacesTest=function(t,e){return!(!t||!e)&&t.object===e.object&&t.face.materialIndex===e.face.materialIndex},t.prototype.addThree=function(t){this.threes.push(t)},t.prototype.removeThree=function(t){var e=this.threes.indexOf(t);~e&&this.threes.splice(e,1)},t.prototype.getObject=function(t){return this.setCoordsFromEvent(t),this.raycaster.setFromCamera(this.coords,this.camera),this.raycaster.intersectObjects(this.threes)[0]},t}();e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n,o=(n=i(2))&&n.__esModule?n:{default:n},r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.vertices2UVs=function(t,e,i,n,o){for(var r=[],s=i;s<n;++s)for(var a=[e[s].a,e[s].b,e[s].c],l=0;l<a.length;++l)r[a[l]]||(r[a[l]]=o(t[a[l]]));return r},t.computeFaceVertexUvs=function(e,i){for(var n=[t.vertices2UVs(e.vertices,e.faces,0,i[0],function(t){return new THREE.Vector2(t.x,1-t.z)}),t.vertices2UVs(e.vertices,e.faces,i[0],i[1],function(t){return new THREE.Vector2(1-t.x,1-t.z)}),t.vertices2UVs(e.vertices,e.faces,i[1],i[2],function(t){return new THREE.Vector2(t.x,t.y)}),t.vertices2UVs(e.vertices,e.faces,i[2],i[3],function(t){return new THREE.Vector2(1-t.x,t.y)}),t.vertices2UVs(e.vertices,e.faces,i[3],i[4],function(t){return new THREE.Vector2(t.z,t.y)}),t.vertices2UVs(e.vertices,e.faces,i[4],e.faces.length,function(t){return new THREE.Vector2(1-t.z,t.y)})],o=0,r=0;r<e.faces.length;++r){o+=i[o]===r;var s=e.faces[r];s.materialIndex=o,e.faceVertexUvs[0][r]=[n[o][s.a],n[o][s.b],n[o][s.c]]}},t.createMarker=function(t,e,i){var n=new THREE.Mesh(new THREE.SphereGeometry(i),new THREE.MeshPhongMaterial({color:e}));return n.position.set(t.x,t.y,t.z),n},t.findUvTris=function(t,e,i,n){var r=[],s=e,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var h;if(a){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}for(var c=h,u=!1,d=i;d<n&&!u;++d){var f=t.faceVertexUvs[0][d];o.default.isInsideConvPoly(f,c)&&(r.push({coefs:o.default.computeInterpCoefs(f,c),i:d}),u=!0)}u||(console.error("Bad point"),r.push(void 0))}return r},t.findInternalVertices=function(t,e,i,n){for(var r={},s=i;s<n;++s)for(var a=t.faceVertexUvs[0][s],l=t.faces[s],h=[l.a,l.b,l.c],c=0;c<a.length;++c)void 0===r[h[c]]&&o.default.isInsidePoly(e,a[c])&&(r[h[c]]={p:a[c],i:h[c],n:l.vertexNormals[c]});return Object.values(r)},t}();e.default=r},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.test=function(t,e){return t.target===e.target},t}();e.default=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(1),s=n(i(45)),a=n(i(66)),l=n(i(35)),h=n(i(26)),c=n(i(29)),u=n(i(27)),d=n(i(34)),f=n(i(30)),p=n(i(53)),v=n(i(58)),g=n(i(44)),m=n(i(63)),y=n(i(40)),b=n(i(28)),w=n(i(24)),k=n(i(39));r.$.fn.FlipBook=function(t){var e={dispose:function(){this.ready?(!e.pdfLinksHandler||e.pdfLinksHandler.dispose(),delete e.pdfLinksHandler,e.sounds.dispose(),delete e.sounds,e.tocCtrl.dispose(),delete e.tocCtrl,e.thumbnails.dispose(),delete e.thumbnails,!e.bookmarks||e.bookmarks.dispose(),delete e.bookmarks,e.ctrl.dispose(),delete e.ctrl,e.bookPrinter.dispose(),delete e.bookPrinter,e.book.dispose(),delete e.book,e.propsBuilder.dispose(),delete e.propsBuilder,delete e.bookBuilder,e.visual.dispose(),delete e.visual,e.view.dispose(),delete e.view,delete e.dispose):this.pendingDispose=!0}};return t=o({},t),e.view=new c.default(this.length?this[0]:(0,r.$)("<div>").appendTo("body"),function(){s.default.webgl?(e.loadingCtrl=new p.default(e.view,!0,function(t){return 0===t?(0,r.tr)("Please wait... the Application is Loading"):(0,r.tr)("PDF is Loading:")+" "+t+"%"}),e.visual=new a.default(e.view.getContainer().ownerDocument.defaultView,e.view.getContainer().ownerDocument,e.view.getView()),e.bookBuilder=function(i,n,s){i.cssLayerProps=o({},i.cssLayerProps,{scene:e}),t.propertiesCallback&&(i=t.propertiesCallback(i)),e.book=new h.default(e.visual,n,s,i),e.bookPrinter=new b.default(e.visual,e.book,(t.template||{}).printStyle),e.loadingCtrl.dispose(),delete e.loadingCtrl,e.ctrl=new u.default(e.book,e.view,t.controlsProps),e.book.setInjector(function(t){t.jQuery=t.$=r.$,t.book=e.book,t.bookCtrl=e.ctrl,i.injector&&i.injector(t)}),e.view.addHandler(e.ctrl),e.ctrl.setPrinter(e.bookPrinter);var a=s(0);e.search=new v.default(e.view.getSearchView(),e.book.getPages()),e.search.onQuery=e.book.setQuery.bind(e.book),e.book.addEventListener("searchResults",function(t){e.search.setResults(t.results,t.lastPage)}),e.thumbnails=new m.default(e.visual,e.view.getThumbnailsView(),s,2*(n+2),{kWtoH:i.width/i.height}),e.tocCtrl=new y.default(e.view,e.ctrl),e.tocCtrl.setThumbnails(e.thumbnails),e.tocCtrl.setSearch(e.search),e.ctrl.setTocCtrl(e.tocCtrl),e.view.addHandler(e.tocCtrl),"pdf"===a.type&&(e.pdfLinksHandler=new l.default(a.src,e.ctrl,e.visual.element),e.book.addEventListener("pdfAnnotation",e.pdfLinksHandler.handleEvent.bind(e.pdfLinksHandler)),a.src.getHandler(function(t){t.getOutline().then(function(t){e.bookmarks=new g.default(e.view.getBookmarksView(),t),e.tocCtrl.setBookmarks(e.bookmarks,a.src)})}),t.pdfLinks&&t.pdfLinks.handler&&e.pdfLinksHandler.setHandler(t.pdfLinks.handler)),e.sounds=new k.default(t.template),e.ctrl.setSounds(e.sounds),e.sounds.subscribeFlips(e.ctrl),e.ready=!0,new w.default(e.visual,e.ctrl,t.autoNavigation).dispose(),t.ready&&t.ready(e),e.pendingDispose&&e.dispose()},t.pdf?(e.propsBuilder=new d.default(t.pdf,e.bookBuilder),e.propsBuilder.pdf.setLoadingProgressClb(e.loadingCtrl.setProgress.bind(e.loadingCtrl))):t.pageCallback?e.propsBuilder=new f.default(e.visual,t.pageCallback,t.pages,e.bookBuilder):e.propsBuilder=new f.default(e.visual,h.default.pageCallback,6,e.bookBuilder)):s.default.addGetWebGLMessage({parent:e.view.getView()})},t.template),e},(0,r.$)(function(){for(var t=(0,r.$)(".flip-book-container"),e=0;e<t.length;++e){var i=(0,r.$)(t[e]),n=i.attr("src");n&&i.FlipBook({pdf:n})}}),window.jQuery=window.$=r.$},function(t,e,i){"use strict";Array.prototype.fill||(Array.prototype.fill=function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),i=e.length>>>0,n=arguments[1]>>0,o=n<0?Math.max(i+n,0):Math.min(n,i),r=arguments[2],s=void 0===r?i:r>>0,a=s<0?Math.max(i+s,0):Math.min(s,i);o<a;)e[o]=t,o++;return e}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,i=Object(this),n=i.length>>>0,o=arguments[1],r=0;r<n;r++)if(e=i[r],t.call(o,e,r,i))return e}}),Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,i=Object(this),n=i.length>>>0,o=arguments[1],r=0;r<n;r++)if(e=i[r],t.call(o,e,r,i))return r;return-1}),Object.values||(Object.values=function(t){return Object.keys(t).map(function(e){return t[e]})||[]}),RegExp.escape||(RegExp.escape=function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}),String.prototype.replaceAll||(String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(RegExp.escape(t),"g"),e)})},function(t,e,i){"use strict";e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},o=function(){function t(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),o=n({},o,{urlParam:o.urlParam||"fb3d-page",navigates:void 0===o.navigates?1:o.navigates,pageN:o.pageN||0}),this.props=o,this.context=e,this.bookCtrl=i,this.urlParam=o.urlParam,this.pageN=o.pageN,this.wnd=e.wnd,this.wnd.fb3d=n({},this.wnd.fb3d),this.wnd.fb3d.navigator=n({},this.wnd.fb3d.navigator),this.navigator=this.wnd.fb3d.navigator[this.urlParam]=n({},this.wnd.fb3d.navigator[this.urlParam]),this.navigator.instances=(this.navigator.instances||0)+1,this.navigator.instances<=this.props.navigates&&this.bookCtrl.goToPage(this.getPageNumber())}return t.prototype.dispose=function(){},t.prototype.getParameterByName=function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+t+"(=([^]*)|&|#|$)").exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},t.prototype.getPageNumber=function(){var t=parseInt(this.pageN);return(isNaN(t)||0===t)&&(t=this.getParameterByName(this.urlParam),t=parseInt(t),isNaN(t)&&(t=1)),t-1},t}();e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n,o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(1),s=(n=i(3))&&n.__esModule?n:{default:n},a=function(){function t(e,i){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.visual=e,this.p=o({},i,{backSize:2*i.cover.depth+i.sheets*i.page.depth}),this.OZ=new r.THREE.Vector3(0,0,1),this.backG=new r.THREE.BoxGeometry(i.cover.depth,this.p.backSize,i.cover.height),this.materials=[new r.THREE.MeshPhongMaterial({color:i.cover.color}),new r.THREE.MeshPhongMaterial({color:i.cover.color}),new r.THREE.MeshPhongMaterial({color:i.cover.color}),new r.THREE.MeshPhongMaterial({color:i.cover.color}),new r.THREE.MeshPhongMaterial({color:i.cover.color}),new r.THREE.MeshPhongMaterial({color:i.cover.color})];var s=new r.THREE.Mesh(this.backG,new r.THREE.MeshFaceMaterial(this.materials));""!==i.cover.binderTexture&&this.visual.textureLoader.load(i.cover.binderTexture,function(t){n.materials[1].color.setHex(16777215),n.materials[1].map=t,t.minFilter=r.THREE.LinearFilter,t.needsUpdate=!0,n.materials[1].needsUpdate=!0}),this.three=new r.THREE.Object3D,this.back=new r.THREE.Object3D,this.backRT=new r.THREE.Object3D,this.backRR=new r.THREE.Object3D,this.backLT=new r.THREE.Object3D,this.backLR=new r.THREE.Object3D,this.leftPivot=new r.THREE.Object3D,this.rightPivot=new r.THREE.Object3D,this.back.add(s),this.back.add(this.leftPivot),this.back.add(this.rightPivot),this.backRT.add(this.back),this.backRR.add(this.backRT),this.backLT.add(this.backRR),this.backLR.add(this.backLT),this.three.add(this.backLR)}return t.prototype.dispose=function(){var t=this.materials,e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}var o=n;o.map&&(o.map=null,o.needsUpdate=!0),o.dispose()}delete this.materials,this.backG.dispose()},t.prototype.set=function(t){var e=void 0,i=void 0;t>Math.PI/2?(e=Math.PI/2,i=t-Math.PI/2):(e=t,i=0);var n=this.p,o={x:-.5*n.cover.depth,y:.5*n.backSize-n.cover.depth};this.backRT.position.set(o.x,o.y,0),this.backRR.position.set(-o.x,-o.y,0),this.backRR.quaternion.setFromAxisAngle(this.OZ,e);var r={x:n.backSize-2*n.cover.depth-.5*n.cover.depth,y:.5*n.backSize-n.cover.depth};this.backLT.position.set(r.x,r.y,0),this.backLR.position.set(-r.x,-r.y,0),this.backLR.quaternion.setFromAxisAngle(this.OZ,i)},t.prototype.setLeft=function(t){var e=Math.PI;this.leftPivot.position.set(s.default.interpolateLinear([-e,-e/2],[0,this.p.cover.depth],t),.5*this.p.backSize-.5*this.p.cover.depth,0),this.leftPivot.quaternion.setFromAxisAngle(this.OZ,t)},t.prototype.setRight=function(t){var e=Math.PI;this.rightPivot.position.set(s.default.interpolateLinear([-e/2,0],[this.p.cover.depth,0],t),-.5*this.p.backSize+.5*this.p.cover.depth,0),this.rightPivot.quaternion.setFromAxisAngle(this.OZ,t)},t.prototype.joinLeftCover=function(t){t.three.position.set(0,-.5*this.p.cover.depth,0),this.leftPivot.add(t.three)},t.prototype.disconnectLeftCover=function(t){this.leftPivot.remove(t.three)},t.prototype.joinRightCover=function(t){t.three.position.set(0,-.5*this.p.cover.depth,0),this.rightPivot.add(t.three)},t.prototype.disconnectRightCover=function(t){this.rightPivot.remove(t.three)},t}();e.default=a},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(1),s=i(11),a=n(i(7)),l=n(i(25)),h=n(i(31)),c=n(i(10)),u=n(i(38)),d=n(i(33)),f=n(i(13)),p=n(i(32)),v=n(i(36)),g=n(i(16)),m=n(i(68)),y=function(t){function e(i,n,s,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var g=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return g.visual=i,g.mouseController=!0,g.p=o({},e.prepareProps(a),{sheets:n,pageCallback:s,zoom:1,singlePage:!1,autoResolution:{enable:!1,k:1.5}}),g.pageManager=new d.default(i,g,g.p),f.default.init(i.doc),g.layerManager=new p.default(g),g.searchEngine=new v.default(s,2*(n+2)),g.searchEngine.onPageHitsChanged=function(t,e){g.pageManager.refreshPageQuery(t,e),g.dispatchEvent({type:"searchResults",results:g.searchEngine.results,lastPage:t,query:e})},g.three=new r.THREE.Object3D,g.binder=new l.default(i,g.p),g.three.add(g.binder.three),g.leftCover=new h.default(i,o({},g.p,{setTexture:g.setLeftCoverTexture.bind(g)}),Math.PI/2,"opened"),g.binder.joinLeftCover(g.leftCover),g.subscribeSheetBlock(g.leftCover,0),g.rightCover=new h.default(i,o({},g.p,{setTexture:g.setRightCoverTexture.bind(g)}),0,"closed"),g.binder.joinRightCover(g.rightCover),g.subscribeSheetBlock(g.rightCover,2*(g.p.sheets+1)),g.threeSheetBlocks=new r.THREE.Object3D,g.three.add(g.threeSheetBlocks),g.threeSheetBlocks.position.set(.5*g.p.cover.depth-.5*n*g.p.page.depth,-.5*n*g.p.page.depth,0),g.sheetBlocks=[],n>0&&g.addSheetBlock(0,new c.default(i,o({},g.p,{setTexture:g.setPageTexture.bind(g)}),0,n,0,"closed")),g.angle=g.p.rtl?Math.PI:0,g.closedAngle=0,g.set(g.angle,0),g.lastMousePos={t:0},g.three.position.set(-.5*g.p.cover.depth+.5*n*g.p.page.depth,0,0),g.sheetPhysics=new u.default(g.p.page.width/g.p.scale,g.p.gravity,g.p.page.cornerDeviation),g.binds={update:g.update.bind(g),lastMousePos:function(t){g.lastMousePos=o({},g.lastMousePos,{pageX:t.pageX,pageY:t.pageY})}},g.visual.addRenderCallback(g.binds.update),(0,r.$)(g.visual.element).on("mousemove",g.binds.lastMousePos),g.binds.onPickCallback=g.onPickCallback.bind(g),g.visual.drag.onPickCallback=g.binds.onPickCallback,g.binds.onDragCallback=g.onDragCallback.bind(g),g.visual.drag.onDragCallback=g.binds.onDragCallback,g.binds.onReleaseCallback=g.onReleaseCallback.bind(g),g.visual.drag.onReleaseCallback=g.binds.onReleaseCallback,g.dragAngle=.05,g.tmp={boxs:[new r.THREE.Box3,new r.THREE.Box3]},g.visual.addObject(g.three),g.visual.addEventListener("resize",g.pageManager.refreshZoom.bind(g.pageManager)),setTimeout(function(){g.notifyBeforeAnimation(),g.notifyAfterAnimation()},100),g}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){this.visual.removeObject(this.three),this.sheetPhysics.dispose(),delete this.visual.drag.onPickCallback,delete this.visual.drag.onDragCallback,delete this.visual.drag.onReleaseCallback,(0,r.$)(this.visual.element).off("mousemove",this.binds.lastMousePos),this.visual.removeRenderCallback(this.binds.update),this.removeSheetBlocks(0,this.sheetBlocks.length),this.binder.disconnectLeftCover(this.leftCover),this.removeSheetBlock(this.leftCover),this.binder.disconnectRightCover(this.rightCover),this.removeSheetBlock(this.rightCover),this.binder.dispose(),this.layerManager.dispose(),f.default.dispose(),this.pageManager.dispose()},e.prototype.setAutoResolution=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.5;this.p.autoResolution=o({},this.p.autoResolution,{enable:t,k:e})},e.prototype.setZoom=function(t,e){(Math.abs(this.p.zoom-t)>.001||e!==this.p.singlePage)&&(this.p.zoom=t,this.p.singlePage=e,this.pageManager.refreshZoom())},e.prototype.getPageCallback=function(){return this.p.pageCallback},e.prototype.setQuery=function(t){this.searchEngine.setQuery(t)},e.prototype.isProcessing=function(){return 0!==this.sheetPhysics.getSize()},e.prototype.getPages=function(){return 4+2*this.p.sheets},e.prototype.setFlipProgressClb=function(t){this.p.flipProgressClb=t},e.prototype.setInjector=function(t){this.p.injector=t},e.prototype.isActivePage=function(t){var e=!0;if(t>1&&t<this.getPages()-2){var i=this.sheetBlocks,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;if(t-2>2*s.p.first&&t-2<2*s.p.last-1){e=!1;break}}}return e},e.prototype.getBlockByPage=function(t){var e=void 0;if(t<2)e=this.leftCover;else if(t<2*(this.p.sheets+1)){var i=this.sheetBlocks,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;if(t-2>=2*s.p.first&&t-2<2*s.p.last){e=s;break}}}else e=this.rightCover;return e},e.prototype.getBlockPages=function(t){var e=void 0;switch(t){case this.leftCover:e=[0,1];break;case this.rightCover:e=[2*(this.p.sheets+1),2*(this.p.sheets+1)+1];break;default:e=t?[2*(t.p.first+1),2*(t.p.last+1)-1]:void 0}return e},e.prototype.getPage=function(){var t=Math.PI,e=void 0;if(this.angle===t/2||this.angle===3*t/2){var i=this.sheetBlocks,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;if(s.angle<=t/2){e=this.getBlockPages(s)[0]-1;break}}e||(e=this.getPages()-3)}else this.angle<t/2?e=0:this.angle>3*t/2?e=1:this.angle<t?e=this.getPages()-3:this.angle>=t&&(e=this.getPages()-1);return e},e.prototype.getTopPages=function(){var t=this.getPage();return 0===t||t===this.getPages()-1?[t]:[t,t+1]},e.prototype.getPageState=function(t){return this.pageManager.getPageState(t)},e.prototype.enableLoadingAnimation=function(t){this.pageManager.enableLoadingAnimation(t)},e.prototype.getLeftFlipping=function(){var t=void 0,e=this.sheetBlocks[0],i=Math.PI;return this.angle===i?t=this.rightCover:e&&"closed"===e.state&&e.angle>i/2?t=e:this.angle!==i/2&&this.angle!==3*i/2||(t=this.leftCover),t},e.prototype.getRightFlipping=function(){var t=void 0,e=this.sheetBlocks[this.sheetBlocks.length-1],i=Math.PI;return 0===this.angle?t=this.leftCover:e&&"closed"===e.state&&e.angle<=i/2?t=e:this.angle!==i/2&&this.angle!==3*i/2||(t=this.rightCover),t},e.prototype.getClosedBlockAngle=function(t){var e=void 0,i=Math.PI;if(this.leftCover.physicId){var n=void 0;try{n=Math.abs(this.sheetPhysics.getParametr(this.leftCover.physicId,"angle")-t)}catch(t){n=0}e=t>i/2||n>i/6?i/2:this.closedAngle}else if(this.rightCover.physicId){var o=void 0;try{o=Math.abs(this.sheetPhysics.getParametr(this.rightCover.physicId,"angle")-t)}catch(t){o=0}e=t<i/2||o>i/6?i/2+1e-7:this.closedAngle}else e=i/2+1e-7*(0!==t);return{openedAngle:t,closedAngle:e,binderTurn:this.closedAngle}},e.prototype.flipLeft=function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.p.flipProgressClb,o=void 0,r=void 0;if(this.sheetPhysics.getSize()<25){var s=this.sheetBlocks[0],a=Math.PI;this.angle===a?r=this.connectPhysics(o=this.rightCover,this.p.cover.mass,a,-this.p.cover.startVelocity,this.p.cover.flexibility,0,function(e,i){return t.set(3*a/2-e/2,i)},function(e,i){t.set(3*a/2-e/2,0),t.setSheetBlocks(e?a:a/2+1e-7,"closed")},n):s&&"closed"===s.state&&s.angle>a/2?(o=i<s.getSize()?this.splitSheetBlock(0,s.getSize()-i)[1]:s,r=this.connectPhysics(o,this.p.page.mass*o.getSize(),a,-this.p.page.startVelocity,this.p.page.flexibility,0,function(e,i){return o.set(t.getClosedBlockAngle(e),"opened",i)},e.finishAnimationClb.bind({book:this,block:o}),n)):this.angle!==a/2&&this.angle!==3*a/2||(r=this.connectPhysics(o=this.leftCover,this.p.cover.mass,a,-this.p.cover.startVelocity,this.p.cover.flexibility,0,function(e,i){t.set(2*a-e/2,i),e>a/2&&t.setSheetBlocks(e?a/2:0,"closed")},function(e,i){return t.set(0===e?0:2*a-e/2,0)},n))}return r},e.prototype.flipRight=function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.p.flipProgressClb,o=void 0,r=void 0;if(this.sheetPhysics.getSize()<25){var s=this.sheetBlocks[this.sheetBlocks.length-1],a=Math.PI;0===this.angle?r=this.connectPhysics(o=this.leftCover,this.p.cover.mass,0,this.p.cover.startVelocity,this.p.cover.flexibility,0,function(e,i){return t.set(e/2,i)},function(e,i){t.set(e/2,0),t.setSheetBlocks(e?a/2:0,"closed")},n):s&&"closed"===s.state&&s.angle<=a/2?(o=i<s.getSize()?this.splitSheetBlock(this.sheetBlocks.length-1,i)[0]:s,r=this.connectPhysics(o,this.p.page.mass*o.getSize(),0,this.p.page.startVelocity,this.p.page.flexibility,0,function(e,i){return o.set(t.getClosedBlockAngle(e),"opened",i)},e.finishAnimationClb.bind({book:this,block:o}),n)):this.angle!==a/2&&this.angle!==3*a/2||(r=this.connectPhysics(o=this.rightCover,this.p.cover.mass,0,this.p.cover.startVelocity,this.p.cover.flexibility,0,function(e,i){t.set(a/2+e/2,i),e<a/2&&t.setSheetBlocks(a/2+1e-7,"closed")},function(e,i){return t.set(a/2+e/2,0)},n))}return r},e.prototype.clearHoverInfo=function(){this.pageManager.turnOnEvents(),delete this.hoverInfo.block.force,delete this.hoverInfo.block.cornerForce,delete this.hoverInfo},e.prototype.xSegment=function(){var t=this.tmp.boxs,e={};return this.leftCover.physicId?(t[0].setFromObject(this.rightCover.three),e.min=-(e.max=t[0].max.x)):this.rightCover.physicId?(t[0].setFromObject(this.leftCover.three),e.max=-(e.min=t[0].min.x)):(t[0].setFromObject(this.leftCover.three),t[1].setFromObject(this.rightCover.three),t[0].union(t[1]),e.min=t[0].min.x,e.max=t[0].max.x),e},e.prototype.computeTarget=function(t){var e,i=t.x,n=(t.y,this.xSegment());return e=(n.max-i)/(n.max-n.min)*Math.PI,Math.max(this.dragAngle,Math.min(Math.PI-this.dragAngle,e))},e.prototype.onPickCallback=function(t){var e=!1,i=t.object.userData.self,n=o({},t.uv),r=t.face.materialIndex;return r<2&&(n.x=0===r?n.x:1-n.x,i.cornerTarget.testIntersection(null,n)&&i.physicId&&(this.hoverInfo&&this.clearHoverInfo(),i.force=u.default.dragForceClb,i.cornerForce=u.default.getDragCornerForceClb(this.computeTarget(t.point)),this.dragInfo={object:t,block:i},e=!0,this.pageManager.turnOffEvents())),e},e.prototype.onDragCallback=function(t){var e=this.dragInfo.block;return e.getProps(),e.force=u.default.dragForceClb,e.cornerForce=u.default.getDragCornerForceClb(this.computeTarget(t)),!0},e.prototype.onReleaseCallback=function(){delete this.dragInfo.block.force,delete this.dragInfo.block.cornerForce,delete this.dragInfo,this.pageManager.turnOnEvents()},e.prototype.getFlipping=function(t){return t?this.getLeftFlipping():this.getRightFlipping()},e.prototype.flip=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t?this.flipLeft(e):this.flipRight(e)},e.prototype.enableMouse=function(t){this.mouseController=t},e.prototype.cornerCallback=function(t,e){var i=this;if(this.mouseController){var n=e.data,o=n.i,r=n.n;if("mouseover"===t.type){if(this.hoverInfo&&void 0!==this.hoverInfo.pendings)++this.hoverInfo.pendings;else if(this.hoverInfo&&(console.warn("Wrong state: element is already hover"),this.hoverInfo.n!==r&&this.clearHoverInfo()),!this.hoverInfo&&!this.dragInfo){var s=Promise.resolve(void 0),a=this.getBlockByPage(r),l=this.getFlipping(o);if(r>1&&r<2*(this.p.sheets+1)&&a.physicId&&(a.angle<.02||a.angle>Math.PI-.02))s=Promise.resolve(a);else if(a===l){var h=[this.leftCover].concat(this.sheetBlocks,[this.rightCover]),c=h.indexOf(a),d=~c?h[c+2*o-1]:void 0;(!d||!d.physicId||d.angle>.02&&d.angle<Math.PI-.02)&&(s=this.flip(o,1).then(function(t){return t?i.sheetPhysics.setParametr(t.physicId,"velocity",0):delete i.hoverInfo,t}),this.hoverInfo={pendings:1})}s.then(function(t){if(i.hoverInfo&&i.hoverInfo.pendings<1&&(t=void 0,delete i.hoverInfo),t){i.pageManager.turnOffEvents();var e=t.getProps();t.force=i.sheetPhysics.getTargetForceClb(e.mass*t.getSize(),o?Math.PI-.02:.02),t.cornerForce=function(){return(o?-1:1)*u.default.hoverCornerForceClb()},i.sheetPhysics.setParametr(t.physicId,"angle",o?Math.PI-.01:.01),i.hoverInfo={n:r,block:t},i.update(1/30)}})}}else if(this.hoverInfo&&"mouseout"===t.type)void 0!==this.hoverInfo.pendings?--this.hoverInfo.pendings:r===this.hoverInfo.n&&this.clearHoverInfo();else if("mousedown"===t.type)this.cornerClickData={x:t.pageX,y:t.pageY};else if("click"===t.type){if(Math.sqrt(Math.pow(this.cornerClickData.x-t.pageX,2)+Math.pow(this.cornerClickData.y-t.pageY,2))<5){var f=this.getBlockByPage(r);if(f.physicId){var p=f.physicId,v=f.getProps();this.sheetPhysics.setParametr(p,"velocity",(o?-1:1)*v.startVelocity)}}delete this.cornerClickData}}},e.prototype.addSheetBlock=function(t,e){this.sheetBlocks.splice(t,0,e),this.subscribeSheetBlock(e,2),this.threeSheetBlocks.add(e.three)},e.prototype.subscribeSheetBlock=function(t,e){var i=this,n=new g.default(this.visual.wnd,this.visual.doc,m.default.test),o=new m.default(.925,.075,.15);o.block=t,o.callback=this.cornerCallback.bind(this),n.addCustom(o),t.cornerTarget=o,t.three.userData.mouseCallback=function(o,r){var s=r.face.materialIndex;if(s<2){var a=0===s?e+2*t.p.first:e+2*t.p.last-1;n.convert(o,{x:0===s?r.uv.x:1-r.uv.x,y:r.uv.y,i:s,n:a}),i.pageManager.transferEventToTexture(a,o,r)}},t.three.userData.touchCallback=function(n,o){var r=o.face.materialIndex;if(r<2){var s=0===r?e+2*t.p.first:e+2*t.p.last-1;i.pageManager.transferEventToTexture(s,n,o)}},this.visual.drag.addThree(t.three),this.visual.mouseEvents.addThree(t.three),this.visual.touchEvents.addThree(t.three)},e.prototype.removeSheetBlock=function(t){this.visual.mouseEvents.removeThree(t.three),this.visual.touchEvents.removeThree(t.three),this.visual.drag.removeThree(t.three),this.threeSheetBlocks.remove(t.three),t.dispose()},e.prototype.removeSheetBlocks=function(t,e){var i=this.sheetBlocks.splice(t,e),n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;this.removeSheetBlock(s)}},e.prototype.setTexture=function(t,e){this.pageManager.setTexture(t,e)},e.prototype.setPageTexture=function(t,e){this.setTexture(t,e+2)},e.prototype.setLeftCoverTexture=function(t,e){this.setTexture(t,e)},e.prototype.setRightCoverTexture=function(t,e){this.setTexture(t,e+2*(this.p.sheets+1))},e.finishAnimationClb=function(t){this.block.set(this.book.getClosedBlockAngle(t).closedAngle,"closed",0);var e=this.book.sheetBlocks.indexOf(this.block);~e&&(0===t?this.book.mergeSheetBlocks(e,this.book.sheetBlocks.length-e):this.book.mergeSheetBlocks(0,e+1))},e.prototype.calcBlockForce=function(t,e,i,n,o){return t.force?t.force(e,i,n,o):0},e.prototype.calcBlockCornerForce=function(t,e,i,n,o){return t.cornerForce?t.cornerForce(e,i,n,o):0},e.prototype.notifyBeforeAnimation=function(){var t=void 0;return this.animationNotification?t=Promise.reject():(this.animationNotification=!0,this.dispatchEvent({type:"beforeAnimation"}),t=this.layerManager.hide()),t},e.prototype.notifyAfterAnimation=function(){this.animationNotification&&(delete this.animationNotification,this.layerManager.show(),this.dispatchEvent({type:"afterAnimation"}))},e.prototype.connectPhysics=function(t,e,i,n,o,r,s,a,l){var h=this,c=function(){return h.hoverInfo?"hover":h.dragInfo?"drag":"free"};return(this.sheetPhysics.getSize()?Promise.resolve():this.notifyBeforeAnimation()).then(function(){return t.physicId=h.sheetPhysics.addObject(e,i,n,o,r,function(e,n){s(e,n),l(t,Math.abs(i-e)/Math.PI,"process",c())},function(e,n){a(e,n),delete t.physicId,l(t,Math.abs(i-e)/Math.PI,"finish",c()),Promise.resolve().then(function(){h.sheetPhysics.getSize()||h.notifyAfterAnimation()})},function(e,i,n,o){return h.calcBlockForce(t,e,i,n,o)},function(e,i,n,o){return h.calcBlockCornerForce(t,e,i,n,o)}),l(t,0,"init",c()),t}).catch(function(){})},e.prototype.update=function(t){var e=this;this.lastMousePos.t+=t,this.isProcessing()&&void 0!==this.lastMousePos.pageX&&this.lastMousePos.t-(this.lastMousePos.lastT||0)>.25&&!this.hoverInfo&&!this.dragInfo&&(this.lastMousePos.lastT=this.lastMousePos.t,Promise.resolve().then(function(){(0,r.$)(e.visual.element).trigger(r.$.Event("mousemove",e.lastMousePos))})),this.sheetPhysics.simulate(t)},e.prototype.splitSheetBlock=function(t,e){var i=this.sheetBlocks[t];if(i&&e<i.getSize()){var n=new c.default(this.visual,o({},this.p,{setTexture:this.setPageTexture.bind(this)}),i.p.first,i.p.first+e,i.angle,i.state);return i.set(i.angle,i.state,i.corner.height,i.p.first+e,i.p.last),this.addSheetBlock(t,n),[n,i]}},e.prototype.mergeSheetBlocks=function(t,e){if(t<this.sheetBlocks.length){e=Math.min(this.sheetBlocks.length-t,e);var i=this.sheetBlocks[t],n=this.sheetBlocks[t+e-1];i.set(i.angle,i.state,i.corner.height,i.p.first,n.p.last),this.removeSheetBlocks(t+1,e-1)}},e.prototype.setSheetBlocks=function(t,e){"closed"===e&&(this.closedAngle=t),this.sheetBlocks.forEach(function(i){i.physicId||i.set(t,e)})},e.prototype.set=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.angle=t;var i=Math.PI;if(t<i/4)this.binder.set(0),this.binder.setLeft(-i/2+2*t),this.leftCover.set(i/2,"opened",e),this.setSheetBlocks(0,"closed"),this.binder.setRight(0),this.rightCover.set(0,"closed",0);else if(t<2*i/4){var n=2*(t-i/4);this.binder.set(n),this.binder.setLeft(-n),this.leftCover.set(i/2+n,"opened",e),this.setSheetBlocks(n,"closed"),this.binder.setRight(-n),this.rightCover.set(n,"closed",0)}else if(t<3*i/4){var o=2*(t-i/2);this.binder.set(i/2),this.binder.setLeft(-i/2),this.leftCover.set(i,"opened",0),this.binder.setRight(-i/2),this.rightCover.set(o,"opened",e)}else if(t<4*i/4){var r=2*(t-3*i/4)+i/2;this.binder.set(r),this.binder.setLeft(-r),this.leftCover.set(r,"closed",0),this.setSheetBlocks(r,"closed"),this.binder.setRight(-i/2),this.rightCover.set(i/2,"opened",e)}else if(t<5*i/4)this.binder.set(i),this.binder.setLeft(-i),this.leftCover.set(i,"closed",0),this.setSheetBlocks(i,"closed"),this.binder.setRight(-i/2-2*(t-i)),this.rightCover.set(i/2,"opened",e);else if(t<6*i/4){var s=2*(t-5*i/4);this.binder.set(i-s),this.binder.setLeft(-i+s),this.leftCover.set(i-s,"closed",0),this.setSheetBlocks(i-s,"closed"),this.binder.setRight(-i+s),this.rightCover.set(i/2-s,"opened",e)}else if(t<7*i/4){var a=2*(t-6*i/4);this.binder.set(i/2),this.binder.setLeft(-i/2),this.leftCover.set(i-a,"opened",e),this.binder.setRight(-i/2),this.rightCover.set(0,"opened",0)}else if(t<8*i/4){var l=2*(t-7*i/4);this.binder.set(i/2-l),this.binder.setLeft(-i/2),this.leftCover.set(i/2,"opened",e),this.setSheetBlocks(i/2-l,"closed"),this.binder.setRight(-i/2+l),this.rightCover.set(i/2-l,"closed",0)}},e.createSideTexture=function(t){var e=(0,r.$)('<canvas width="8" height="8"></canvas>'),i=e[0].getContext("2d");return i.beginPath(),i.fillStyle=a.default.color2Rgba(t,1),i.rect(0,0,8,7),i.fill(),i.beginPath(),i.fillStyle=a.default.color2Rgba(a.default.inverseColor(t,.5),1),i.rect(0,7,8,1),i.fill(),e[0]},e.prepareProps=function(t){return e.calcProps(e.mergeProps((0,s.props)(),t))},e.mergeProps=function(t,e){return o({},t,e=e||{},{sheet:o({},t.sheet,e.sheet),cover:o({},t.cover,e.cover),page:o({},t.page,e.page),cssLayerProps:o({},t.cssLayerProps,e.cssLayerProps)})},e.calcProps=function(t){var i=o({},t,{sheet:o({},t.sheet),cover:o({},t.sheet,t.cover),page:o({},t.sheet,t.page),cssLayerProps:o({},t.cssLayerProps,{$:r.$})}),n=50*i.height,s=50*i.width,a={sideTexture:i.sheet.sideTexture||e.createSideTexture(i.sheet.color)},l=o({},a,i.cover,{depth:50*i.cover.depth,width:s,height:n,padding:50*i.cover.padding}),h=o({},a,i.page,{depth:50*i.page.depth,width:l.width-l.padding,height:l.height-2*l.padding});return l.color===a.color||i.cover.sideTexture||(l.sideTexture=e.createSideTexture(l.color)),h.color===a.color||i.page.sideTexture||(h.sideTexture=e.createSideTexture(h.color)),o({},i,{scale:50,height:n,width:s,flipProgressClb:function(){},cover:l,page:h,marker:{use:!1,color:16711680,size:.05}})},e}(r.THREE.EventDispatcher);e.default=y},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=i(1),a=n(i(15)),l=i(42),h=n(i(49)),c=n(i(71)),u=n(i(55)),d=n(i(50)),f=function(t){function e(i,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return console.log("r",r),r.navigationControls=!0,r.book=i,r.visual=i.visual,r.p=e.prepareProps(o),r.p.rtl=i.p.rtl,r.devicePixelRatio=r.visual.wnd.devicePixelRatio||1,r.orbit=i.visual.getOrbit(),i.setFlipProgressClb(r.updateViewIfState.bind(r)),r.view=n,r.bindActions(),r.state={smartPan:!r.actions.cmdSmartPan.active,singlePage:r.actions.cmdSinglePage.active||r.actions.cmdSinglePage.activeForMobile&&r.devicePixelRatio>1,stats:r.actions.cmdStats.active,lighting:r.p.lighting.default,activeSide:1},r.boxs=[new s.THREE.Box3,new s.THREE.Box3],r.bookWatcher=new u.default(r.visual,function(){return r.state.singlePage?r.state.activeSide?r.boxs[0].setFromObject(i.rightCover.three):r.boxs[0].setFromObject(i.leftCover.three):(r.boxs[0].setFromObject(i.leftCover.three),r.boxs[1].setFromObject(i.rightCover.three),r.boxs[0].union(r.boxs[1])),r.boxs[0]}),r.bookWatcher.scale=r.p.scale.default,r.book.setZoom(r.bookWatcher.scale,r.state.singlePage),r.Stats=new c.default,r.Stats.domElement.style.position="absolute",r.Stats.domElement.style.top="0px",r.visual.setExtraLighting(r.state.lighting),r.binds={onScreenModeChanged:r.onScreenModeChanged.bind(r),stats:r.Stats.update.bind(r.Stats),onUpdateView:r.updateView.bind(r)},d.default.addEventListener(r.view.getParentContainer().ownerDocument,r.binds.onScreenModeChanged),r.cmdSmartPan(),r.view.templateObject.appLoaded&&Promise.resolve().then(r.view.templateObject.appLoaded),r.book.enableLoadingAnimation(r.p.loadingAnimation.book),r.p.loadingAnimation.skin&&r.initLoadingAnimation(),r.book.enableLoadingAnimation(r.p.loadingAnimation.book),r.book.setAutoResolution(r.p.autoResolution.enabled,r.p.autoResolution.coefficient),r.visual.addEventListener("resize",r.updateView.bind(r)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){d.default.removeEventListener(this.view.getParentContainer().ownerDocument,this.binds.onScreenModeChanged),delete this.book,delete this.view,delete this.visual},e.prototype.initLoadingAnimation=function(){var t=this,e=function(){var e=!1,i=t.book.getTopPages(),n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r,a=t.book.getPageState(s);if(e=void 0===a||"loading"===a)break}t.view.setState("widLoading",{visible:e})};this.book.addEventListener("beforeAnimation",e),this.book.addEventListener("afterAnimation",e),this.book.addEventListener("loadPage",e),this.book.addEventListener("loadedPage",e)},e.prototype.enableNavigation=function(t){this.navigationControls=t},e.prototype.setTocCtrl=function(t){this.tocCtrl=t,this.tocCtrl.onChange=this.updateView.bind(this),this.updateView()},e.prototype.setPrinter=function(t){this.printer=t,this.updateView()},e.prototype.setSounds=function(t){this.sounds=t,t.setEnabled(this.actions.cmdSounds.active),this.updateView()},e.prototype.onScreenModeChanged=function(t){this.updateView()},e.prototype.canZoomIn=function(){return!this.state.smartPan||Math.abs(this.bookWatcher.scale-this.p.scale.max)>this.p.eps},e.prototype.canZoomOut=function(){return!this.state.smartPan||Math.abs(this.bookWatcher.scale-this.p.scale.min)>this.p.eps},e.prototype.canDefaultZoom=function(){return this.state.smartPan},e.prototype.setBookZoom=function(t){var e=this;setTimeout(function(){e.bookWatcher.scale===t&&e.book.setZoom(t,e.state.singlePage)},1e3)},e.prototype.cmdZoomIn=function(){this.state.smartPan?(this.bookWatcher.scale=Math.min(this.p.scale.max,this.bookWatcher.scale+this.p.scale.delta),this.setBookZoom(this.bookWatcher.scale)):this.orbit.zoomIn(6.6*this.p.scale.delta/.32),this.updateView()},e.prototype.cmdZoomOut=function(){this.state.smartPan?(this.bookWatcher.scale=Math.max(this.p.scale.min,this.bookWatcher.scale-this.p.scale.delta),this.setBookZoom(this.bookWatcher.scale)):this.orbit.zoomOut(6.6*this.p.scale.delta/.32),this.updateView()},e.prototype.cmdDefaultZoom=function(){this.state.smartPan&&(this.bookWatcher.scale=this.p.scale.default,this.setBookZoom(this.bookWatcher.scale),this.updateView())},e.prototype.cmdToc=function(){this.tocCtrl&&this.tocCtrl.togle()},e.prototype.cmdFastBackward=function(){this.startFlip(this.book.flipLeft(5))},e.prototype.cmdBackward=function(){var t=this;this.state.singlePage?(this.state.activeSide=(this.getPage()+1)%2,this.state.activeSide?(this.state.activeSide=0,this.updateView()):this.startFlip(this.book.flipLeft(1)).then(function(e){e&&(t.state.activeSide=1)})):this.startFlip(this.book.flipLeft(1))},e.prototype.cmdBigBackward=function(){this.cmdBackward()},e.prototype.cmdForward=function(){var t=this;this.state.singlePage?(this.state.activeSide=(this.getPage()+1)%2,this.state.activeSide?this.startFlip(this.book.flipRight(1)).then(function(e){e&&(t.state.activeSide=0)}):(this.state.activeSide=1,this.updateView())):this.startFlip(this.book.flipRight(1))},e.prototype.cmdBigForward=function(){this.cmdForward()},e.prototype.cmdFastForward=function(){this.startFlip(this.book.flipRight(5))},e.prototype.cmdSave=function(){window.open(this.p.downloadURL,"_blank")},e.prototype.cmdPrint=function(){this.printer.print()},e.prototype.cmdFullScreen=function(){d.default.activated()?d.default.cancel():d.default.request(this.view.getParentContainer())},e.prototype.cmdSmartPan=function(){this.state.smartPan=!this.state.smartPan,this.state.smartPan?(this.orbit.minAzimuthAngle=0,this.orbit.maxAzimuthAngle=0,this.orbit.minPolarAngle=0,this.orbit.maxPolarAngle=Math.PI/4,this.bookWatcher.enabled=!0):(this.orbit.minAzimuthAngle=-1/0,this.orbit.maxAzimuthAngle=1/0,this.orbit.minPolarAngle=0,this.orbit.maxPolarAngle=Math.PI,this.bookWatcher.enabled=!1),this.updateView()},e.prototype.cmdSinglePage=function(){this.state.singlePage=!this.state.singlePage,this.setBookZoom(this.bookWatcher.scale),this.updateView()},e.prototype.cmdSounds=function(){this.sounds&&this.sounds.togle(),this.updateView()},e.prototype.cmdStats=function(){this.state.stats=!this.state.stats,this.state.stats?((0,s.$)(this.view.getContainer()).append(this.Stats.domElement),this.visual.addRenderCallback(this.binds.stats)):((0,s.$)(this.view.getContainer()).find(this.Stats.domElement).remove(),this.visual.removeRenderCallback(this.binds.stats)),this.updateView()},e.prototype.cmdLightingUp=function(){this.state.lighting=Math.min(this.state.lighting+this.p.lighting.delta,this.p.lighting.max),this.visual.setExtraLighting(this.state.lighting),this.updateView()},e.prototype.cmdLightingDown=function(){this.state.lighting=Math.max(this.state.lighting-this.p.lighting.delta,this.p.lighting.min),this.visual.setExtraLighting(this.state.lighting),this.updateView()},e.prototype.goToPage=function(t){var e=this;this.p.rtl&&(t=this.book.getPages()-1-t);var i=Math.max(Math.min(t,this.book.getPages()-1),0);this.state.activeSide=(i+1)%2;var n=Math.max(Math.min(t-1+t%2,this.book.getPages()-1),0),o=this.book.getPage(),r=[],s=0;if(n!=o){0===o?(r.push(1),o+=1,++s):o===this.book.getPages()-1&&(r.push(-1),o-=2,++s);var a=0;0===n?(a=-1,n+=1,++s):n===this.book.getPages()-1&&(a=1,n-=2,++s),n-o&&r.push(Math.ceil((n-o)/2)),a&&r.push(a)}var l=function(t,i,n){setTimeout(function(){t<0?e.startFlip(e.book.flipLeft(-t,n)):e.startFlip(e.book.flipRight(t,n))},i)};if(2===s)l(r[0],0,function(t,e,i){"finish"==i&&1==e&&l(r[r.length-1],0)}),l(r[1],500);else{var h=0,c=r,u=Array.isArray(c),d=0;for(c=u?c:c[Symbol.iterator]();;){var f;if(u){if(d>=c.length)break;f=c[d++]}else{if((d=c.next()).done)break;f=d.value}l(f,h),h+=400}}},e.prototype.startFlip=function(t){var e=this;return t?t.then(function(t){return t&&e.dispatchAsync({type:"startFlip"}),t}):Promise.resolve(void 0)},e.prototype.endFlip=function(t){return this.dispatchAsync({type:"endFlip"}),t},e.prototype.getPage=function(){return this.book.getPage()?Math.min(this.book.getPage()+this.state.activeSide,this.book.getPages()-1):0},e.prototype.getPageForGUI=function(){var t=(this.state.singlePage?this.getPage():this.book.getPage())+1;return this.p.rtl&&(t=this.book.getPages()-t+1),t},e.prototype.inpPage=function(t,e){this.goToPage(e-1)},e.prototype.updateViewIfState=function(t,e,i,n){"init"!==i&&"finish"!==i||setTimeout(this.updateView.bind(this),100),"finish"===i&&this.endFlip(t)},e.prototype.isCmdVisible=function(t){return(0,s.$)(this.visual.element).width()<this.p.narrowView.width?void 0===this.actions[t].enabledInNarrow?this.actions[t].enabled:this.actions[t].enabledInNarrow:this.actions[t].enabled},e.prototype.updateViewState=function(){this.viewState={cmdZoomIn:{enable:this.canZoomIn(),visible:this.isCmdVisible("cmdZoomIn"),active:!1},cmdZoomOut:{enable:this.canZoomOut(),visible:this.isCmdVisible("cmdZoomOut"),active:!1},cmdDefaultZoom:{enable:this.canDefaultZoom(),visible:this.isCmdVisible("cmdDefaultZoom"),active:this.canDefaultZoom()&&Math.abs(this.bookWatcher.scale-this.p.scale.default)<this.p.eps},cmdToc:{enable:!!this.tocCtrl,visible:this.isCmdVisible("cmdToc")&&this.tocCtrl,active:this.tocCtrl&&this.tocCtrl.visible},inpPages:{visible:!0,value:this.book.getPages()},inpPage:{visible:!0,enable:!this.book.isProcessing()&&this.navigationControls,value:this.getPageForGUI()},cmdSave:{enable:!0,visible:this.isCmdVisible("cmdSave")&&!!this.p.downloadURL,active:!1},cmdPrint:{enable:!0,visible:this.isCmdVisible("cmdPrint")&&!!this.printer,active:!1},cmdFullScreen:{enable:d.default.available(),visible:this.isCmdVisible("cmdFullScreen"),active:d.default.available()&&d.default.activated()},widSettings:{enable:!0,visible:this.isCmdVisible("widSettings"),active:!1},cmdSmartPan:{enable:!0,visible:this.isCmdVisible("cmdSmartPan"),active:this.state.smartPan},cmdSinglePage:{enable:!0,visible:this.isCmdVisible("cmdSinglePage"),active:this.state.singlePage},cmdSounds:{enable:!0,visible:this.isCmdVisible("cmdSounds")&&!!this.sounds,active:!!this.sounds&&this.sounds.enabled},cmdStats:{enable:!0,visible:this.isCmdVisible("cmdStats"),active:this.state.stats},cmdLightingUp:{enable:Math.abs(this.state.lighting-this.p.lighting.max)>this.p.eps,visible:this.isCmdVisible("cmdLightingUp"),active:!1},cmdLightingDown:{enable:Math.abs(this.state.lighting-this.p.lighting.min)>this.p.eps,visible:this.isCmdVisible("cmdLightingDown"),active:!1}};var t=this.book.getLeftFlipping(),e=this.book.getRightFlipping(),i={cmdFastBackward:!!t&&this.navigationControls,cmdBackward:!!t&&this.navigationControls,cmdBigBackward:!!t&&this.navigationControls,cmdForward:!!e&&this.navigationControls,cmdBigForward:!!e&&this.navigationControls,cmdFastForward:!!e&&this.navigationControls},n=Object.keys(i),o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}var a=s;this.viewState[a]={enable:i[a],visible:this.isCmdVisible(a),active:!1}}},e.prototype.updateView=function(){if(this.view){this.updateViewState();var t=Object.keys(this.viewState),e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}var o=n;this.view.setState(o,this.viewState[o])}}},e.prototype.getActions=function(){var t=this,e=function(e){return t.actions.touchCmdSwipe.enabled&&t.actions.touchCmdSwipe.code===t.actions[e].code&&t.state.smartPan&&t.bookWatcher.scale<=1},i={};for(var n in this)!function(e){0===e.indexOf("cmd")&&(i[e]={activate:function(){t.viewState&&t.viewState[e].enable&&t[e].apply(t,arguments)}})}(n);return r({},i,{cmdPanLeft:{activate:function(e){return t.orbit.actions.pan(e,{state:"move",dx:-t.p.pan.speed,dy:0})}},cmdPanRight:{activate:function(e){return t.orbit.actions.pan(e,{state:"move",dx:t.p.pan.speed,dy:0})}},cmdPanUp:{activate:function(e){return t.orbit.actions.pan(e,{state:"move",dx:0,dy:-t.p.pan.speed})}},cmdPanDown:{activate:function(e){return t.orbit.actions.pan(e,{state:"move",dx:0,dy:t.p.pan.speed})}},mouseCmdRotate:{activate:this.orbit.actions.rotate},mouseCmdDragZoom:{activate:function(e,i){i.dy>0?t.cmdZoomOut():i.dy<0&&t.cmdZoomIn()}},mouseCmdPan:{activate:this.orbit.actions.pan},mouseCmdWheelZoom:{activate:function(e){e.preventDefault(),e.deltaY<0?t.cmdZoomOut():e.deltaY>0&&t.cmdZoomIn()}},touchCmdRotate:{activate:function(i,n){e("touchCmdRotate")||(i.preventDefault(),t.orbit.actions.rotate(i,n))}},touchCmdZoom:{activate:function(i,n){e("touchCmdZoom")||(i.preventDefault(),n.dy>0?t.cmdZoomOut():n.dy<0&&t.cmdZoomIn())}},touchCmdPan:{activate:function(i,n){e("touchCmdPan")||(i.preventDefault(),t.orbit.actions.pan(i,n))}},touchCmdSwipe:{activate:function(i,n){if(e("touchCmdSwipe"))if(i.preventDefault(),"start"===n.state){var o=(i.touches||i.originalEvent.touches)[t.actions.touchCmdSwipe.code-1];t.swipeData={handled:!1,x0:o.pageX,y0:o.pageY,x:o.pageX,y:o.pageY}}else"move"===n.state?t.swipeData.handled||(t.swipeData=r({},t.swipeData,{x:t.swipeData.x+n.dx,y:t.swipeData.y+n.dy}),Math.abs(t.swipeData.x0-t.swipeData.x)>100&&(t.swipeData.x0>t.swipeData.x?t.cmdForward():t.cmdBackward(),t.swipeData.handled=!0)):delete t.swipeData}},widSettings:{activate:function(){}}})},e.prototype.bindActions=function(){this.eToA=new h.default((0,s.$)(this.visual.element)),this.eToA.addAction(function(t){return t.preventDefault()},"contextmenu",h.default.mouseButtons.Right,0),this.actions=this.getActions();var t=Object.keys(this.actions),e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}var o=n,a=r({},this.actions[o],this.p.actions[o]);if(this.actions[o]=a,a.enabled){var l=a.flags||0;a.type?this.eToA.addAction(a.activate,a.type,a.code,l):void 0!==a.code&&this.eToA.addAction(a.activate,"keydown",a.code,l)}}},e.prepareProps=function(t){return e.calcProps(e.mergeProps((0,l.props)(),t))},e.setActions=function(t,e){var i=Object.keys(e||{}),n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s;t.actions[a]=r({},t.actions[a],e[a])}},e.mergeProps=function(t,i){var n=function t(e,i){var n=r({},e,i=i||{}),s=Object.keys(e),a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var h;if(a){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}var c=h;"object"===o(e[c])&&(n[c]=t(e[c],i[c]))}return n}(t,i=i||{});return e.setActions(n,t.actions),e.setActions(n,i.actions),n},e.calcProps=function(t){return t.scale.delta=(t.scale.max-t.scale.min)/t.scale.levels,t.lighting.delta=(t.lighting.max-t.lighting.min)/t.lighting.levels,t},e}(a.default);e.default=f},function(t,e,i){"use strict";e.__esModule=!0;var n=i(1),o=function(){function t(e,i,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.book=i,this.styleSheet=n,this.wnd=e.wnd,this.doc=e.doc,this.pageCallback=i.getPageCallback();var o=this.pageCallback(0);this.type=o.type,"pdf"===this.type&&(this.pdfSrc=o.src.src)}return t.prototype.cancel=function(){this.canceled=!0},t.prototype.dispose=function(){this.frame&&(this.frame.remove(),delete this.frame)},t.prototype.print=function(){var t=this;if(delete this.canceled,"pdf"===this.type){var e=void 0,i=!1;this.useIFrame()?(i=!!this.frame,this.frame||(this.frame=(0,n.$)('<iframe src="'+this.pdfSrc+'" style="display: none;"></iframe>').appendTo(this.doc.body)),e=this.frame[0].contentWindow):e=this.wnd.open(this.pdfSrc),i?e.print():(0,n.$)(e).on("load",function(){try{e.print()}catch(t){console.error(t)}})}else this.renderContent().then(function(e){var i=t.wnd.open().document,n='\n            <!DOCTYPE html>\n            <html>\n              <head>\n                <meta charset="utf-8">\n                <title>3D FlipBook - Printing</title>\n                '+e.head+'\n                <script type="text/javascript">\n                  function printDocument() {\n                    window.print();\n                    window.close();\n                  }\n                  function init() {\n                    setTimeout(printDocument, 100);\n                  }\n                <\/script>\n              </head>\n              <body onload="init()">\n                '+e.body+"\n              </body>\n            </html>\n          ";i.open(),i.write(n),i.close()}).catch(function(t){return console.warn("3D FlipBook - Printing was canceled")})},t.prototype.progress=function(t){if(this.canceled)throw"Cancel Printing";this.onProgress&&this.onProgress(Math.floor(100*t))},t.prototype.renderContent=function(){for(var t=this,e=this.book.getPages(),i=new Set,n=[],o=Promise.resolve(),r=0;r<e;++r)!function(r){var s=t.pageCallback(r);"image"===s.type?o=o.then(function(){return t.progress(r/e),t.renderImage(i,n,s.src)}):"html"===s.type&&(o=o.then(function(){return t.progress(r/e),t.renderHtml(i,n,s.src)}))}(r);return o.then(function(){return t.progress(1),{head:t.renderHead(i),body:n.join("\n")}})},t.wrap=function(t){return'<div class="fb3d-printer-page">'+t+"</div>"},t.prototype.renderImage=function(e,i,n){i.push(t.wrap('<img src="'+n+'" />'))},t.prototype.renderHtml=function(e,i,o){return new Promise(function(r,s){n.$.get(o,function(n){var o=n.match(/<link.*?>/gi)||[],s=Array.isArray(o),a=0;for(o=s?o:o[Symbol.iterator]();;){var l;if(s){if(a>=o.length)break;l=o[a++]}else{if((a=o.next()).done)break;l=a.value}var h=l;if(h.match(/stylesheet/i)){var c=h.match(/href\s*=\s*['"](.*)['"]/i);c&&e.add(c[1])}}var u=n.match(/<body.*?>([\S\s]*)<\/body>/i);u&&i.push(t.wrap(u[1])),r()}).fail(function(t){console.error(t.responseText),s()})})},t.prototype.renderHead=function(e){var i=[];return e.forEach(function(t){return i.push('<link rel="stylesheet" href="'+t+'">')}),i.push(this.styleSheet?'<link rel="stylesheet" href="'+this.styleSheet+'">':t.defaultStyleSheet()),i.join("\n")},t.prototype.useIFrame=function(){var t=this.wnd.chrome,e=this.wnd.navigator,i=e.vendor,n=e.userAgent.indexOf("Edge")>-1;return!!e.userAgent.match("CriOS")||!(!t||"Google Inc."!==i||n)},t.defaultStyleSheet=function(){return'\n      <style type="text/css">\n        body {\n          margin: 0;\n          padding: 0;\n        }\n        .fb3d-printer-page {\n          page-break-after: always;\n        }\n      </style>\n    '},t}();e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n,o=function(t){function e(i,n,o,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o,r))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.initView=function(){this.view=this.container.find(".view"),this.bookmarksView=this.container.find(".widBookmarks"),this.thumbnailsView=this.container.find(".widThumbnails"),this.searchView=this.container.find(".widSearch")},e.prototype.getHandlers=function(i){var n=this;return"inpPage"===i?[{inpPage:function(o,r){return n.callLater(t.prototype.getHandlers.call(n,i),i,o,r,e.PAGE_HANDLER_DELAY)}}]:t.prototype.getHandlers.call(this,i)},e.prototype.onItemStateChanged=function(t,e){"cmdFullScreen"===t&&(e.active?this.parentContainer.addClass("fullscreen"):this.parentContainer.removeClass("fullscreen"))},e.prototype.getView=function(){return this.view},e.prototype.getBookmarksView=function(){return this.bookmarksView},e.prototype.getThumbnailsView=function(){return this.thumbnailsView},e.prototype.getSearchView=function(){return this.searchView},e.prototype.getForms=function(){return[]},e.prototype.getLinks=function(){return["cmdZoomIn","cmdZoomOut","cmdDefaultZoom","cmdToc","cmdFastBackward","cmdBackward","cmdBigBackward","cmdForward","cmdBigForward","cmdFastForward","cmdSave","cmdPrint","cmdFullScreen","cmdSmartPan","cmdSinglePage","cmdSounds","cmdStats","cmdLightingUp","cmdLightingDown","cmdCloseToc","cmdBookmarks","cmdSearch","cmdThumbnails"]},e.prototype.getWidgets=function(){return["widLoadingProgress","widFloatWnd","widTocMenu","widBookmarks","widThumbnails","widSearch","widSettings","widLoading"]},e.prototype.getInputs=function(){return["inpPage","inpPages"]},e.prototype.getTexts=function(){return["txtLoadingProgress"]},e.prototype.getTemplate=function(){return{html:"https://centurysoftwares.com/idondza/pages/templates/default-book-view.html",styles:["https://centurysoftwares.com/idondza/pages/css/black-book-view.css"],links:[{rel:"stylesheet",href:"https://centurysoftwares.com/idondza/pages/css/font-awesome.min.css"}],script:"https://centurysoftwares.com/idondza/pages/js/default-book-view.js"}},e}((i(1),(n=i(65))&&n.__esModule?n:{default:n}).default);o.PAGE_HANDLER_DELAY=1e3,e.default=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=n(i(9)),r=n(i(8)),s=function(t){function e(i,n,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,s));if(a.calcSheets(o),a.pageCallback=n,a.binds={pageCallback:n.bind(a)},a.imageFactory=new r.default(i),o>0){var l=a.imageFactory.build(n(0),0,a.defaults.sheet.widthTexels,a.defaults.sheet.heightTexels,a.defaults.sheet.color);l.onLoad=function(){a.calcProps(l.width,l.height),l.dispose(),a.ready()}}else a.props=a.defaults,a.ready();return a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(o.default);e.default=s},function(t,e,i){"use strict";e.__esModule=!0;var n,o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=function(t){function e(i,n,o,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,0,1,o,r))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getProps=function(){return o({},this.p.cover,{sheets:1})},e.prototype.loadPoints=function(){return{interpolationPoints:[{x:[[0,.2877,.6347,.8174,1],[0,.2831,.6256,.8082,.9909],[0,.2603,.5936,.7763,.9589],[0,.137,.3881,.5342,.6758],[0,0,0,0,0]],y:[[0,0,0,0,0],[0,.02,.005,-.001,-.0025],[0,.04,.01,-.002,-.005],[0,.2466,.4795,.5708,.6758],[0,.2877,.6347,.8174,1]]},{x:[[0,.2877,.6347,.8174,1],[0,.2831,.6256,.8082,.9909],[0,.2603,.5936,.7763,.9589],[0,.233,.563,.746,.927],[0,.144,.433,.613,.796],[0,.07,.288,.455,.626],[0,0,0,0,0]],y:[[0,0,0,0,0],[0,.02,.005,-.001,-.0025],[0,.04,.01,-.002,-.005],[0,.168,.269,.27,.255],[0,.245,.435,.458,.46],[0,.278,.544,.614,.673],[0,.2877,.6347,.8174,1]]}],openedInterpolationIndeces:[[2,3,4],[2,3,4,5,6]],closedInterpolationIndeces:[[0,1,2],[0,1,2]]}},e}(((n=i(10))&&n.__esModule?n:{default:n}).default);e.default=r},function(t,e,i){"use strict";e.__esModule=!0;var n,o=(n=i(37))&&n.__esModule?n:{default:n},r=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.book=e,this.props=e.p.cssLayerProps,this.visual=e.visual,this.pageManager=e.pageManager,this.wrappers={}}return t.prototype.getActives=function(){var t=this.book.getPage(),e=this.book.getPages();return 0===t||t===e-1?[t]:[t,t+1]},t.prototype.dispose=function(){var t=Object.values(this.wrappers),e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}n.layers.forEach(function(t){return t.dispose()})}delete this.wrappers},t.prototype.show=function(){var t=this;this.hidden=!1;var e=this.getActives(),i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var r;if("break"===function(){if(i){if(n>=e.length)return"break";r=e[n++]}else{if((n=e.next()).done)return"break";r=n.value}var s=r,a=t.wrappers[s];if(a){if("ready"===a.state&&a.layers.length){var l=t.book.getBlockByPage(s);a.layers.forEach(function(t){t.isHidden()&&(t.update(l),t.show())})}}else{var h=t.wrappers[s]={state:"loading",layers:[]};Promise.resolve().then(function(){t.pageManager.getLayers(s,function(e){if(e.length&&t.wrappers){var i=t.book.getBlockByPage(s),n=e,r=Array.isArray(n),a=0;for(n=r?n:n[Symbol.iterator]();;){var l;if(r){if(a>=n.length)break;l=n[a++]}else{if((a=n.next()).done)break;l=a.value}var c=l,u=new o.default(t.visual,i,t.props);h.layers.push(u),u.set(c.css,c.html,c.js)}setTimeout(function(){!t.hidden&&~t.getActives().indexOf(s)&&h.layers.forEach(function(t){return t.show()})},10)}h.state="ready"})})}}())break}},t.prototype.hide=function(){this.hidden=!0;var t=[],e=Object.values(this.wrappers),i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var o;if(i){if(n>=e.length)break;o=e[n++]}else{if((n=e.next()).done)break;o=n.value}o.layers.forEach(function(e){return t.push(e.hide())})}return Promise.all(t)},t}();e.default=r},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(1),s=n(i(14)),a=n(i(52)),l=n(i(8)),h=n(i(2)),c=n(i(60)),u=function(){function t(e,i,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.visual=e,this.book=i,this.pageQuery="",this.p=n,this.pageCache=new s.default(n.cachedPages),this.resourcesCache=new s.default,this.canvas=(0,r.$)("<canvas>")[0],this.imageFactory=new l.default(o({},e,{dispatchEvent:i.dispatchEvent.bind(i),renderCanvas:this.canvas,renderCanvasCtx:this.canvas.getContext("2d")}),this.resourcesCache),this.loadings=[],this.renderQueue=[],this.pageRequests=[],this.predictedRequests=[],this.tmpMaterial=new r.THREE.MeshBasicMaterial,e.addObject(new r.THREE.Mesh(new r.THREE.PlaneGeometry(0,0),this.tmpMaterial)),this.loadingAnimation=!0,this.loading={},this.loading[n.cover.color]=this.createLoadingTexture(n.cover),n.page.color!==n.cover.color&&(this.loading[n.page.color]=this.createLoadingTexture(n.page)),this.turnOnEvents(),e.addRenderCallback(this.update.bind(this)),setTimeout(this.updateRenderQueue.bind(this),250)}return t.prototype.createLoadingTexture=function(t){var e=Math.sqrt(1262992.5/(t.widthTexels*t.heightTexels)),i=new a.default(e*t.widthTexels,e*t.heightTexels,t.color),n=new c.default(i.createSprite(6),6,1,6,.2);return i.dispose(),n},t.prototype.dispose=function(){this.turnOffEvents();var t=Object.keys(this.loading),e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}var o=n;this.loading[o].dispose()}delete this.loading,this.resourcesCache.dispose(),this.pageCache.dispose(),this.canvas.height=this.canvas.width=0,delete this.canvas},t.prototype.isCover=function(t){return t<2||t>=2*(this.p.sheets+1)},t.prototype.isMobile=function(){return(this.visual.wnd.devicePixelRatio||1)>1},t.prototype.getPageState=function(t){var e=this.pageCache.get(t);return e?e.state:void 0},t.prototype.enableLoadingAnimation=function(t){this.loadingAnimation=t;var e=this.loadings,i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var o;if(i){if(n>=e.length)break;o=e[n++]}else{if((n=e.next()).done)break;o=n.value}var r=o;this.setupMaterial(r)}},t.prototype.update=function(t){if(this.loadingAnimation){var e={},i=this.loadings,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;s.isActive()&&(e[s.color]=!0)}var a=Object.keys(e),l=Array.isArray(a),h=0;for(a=l?a:a[Symbol.iterator]();;){var c;if(l){if(h>=a.length)break;c=a[h++]}else{if((h=a.next()).done)break;c=h.value}var u=c;this.loading[u].update(t)}}},t.prototype.removeFromLoadings=function(t){var e=this.loadings.indexOf(t);~e&&this.loadings.splice(e,1)},t.prototype.removeFromRenderQueue=function(t){var e=this.renderQueue.indexOf(t);~e&&this.renderQueue.splice(e,1)},t.prototype.refreshPageQuery=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.pageQuery=e;var i=this.pageCache.get(t);i&&i.wrapper&&i.wrapper.setQuery&&(this.pageCache.remove(t)||(i.wrapper.setQuery(e),this.pushInRenderQueue(i)))},t.prototype.refreshZoom=function(){var t=this;if(this.p.autoResolution.enable){var e=[];this.pageCache.forEach(function(t){e.push(t)}),e.forEach(function(e){var i=e[1];i&&i.wrapper&&(t.pageCache.remove(e[0])||t.pushInRenderQueue(i))})}},t.prototype.getLayers=function(t,e){var i=this;this.p.cssLayersLoader?this.p.cssLayersLoader(t,function(){for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];var s=i.pageCache.get(t);s&&("active"!==s.state?s.pendings.push({clb:e,args:o}):e.apply(void 0,o))}):e([])},t.prototype.resolvePendings=function(t){var e=t,i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var o;if(i){if(n>=e.length)break;o=e[n++]}else{if((n=e.next()).done)break;o=n.value}var r=o;try{r.clb.apply(r,r.args)}catch(t){console.error(t)}}t.splice(0,t.length)},t.prototype.rtlPageN=function(t){return this.p.rtl?2*(this.p.sheets+2)-1-t:t},t.prototype.load=function(t,e){var i=this,n=this.p.pageCallback(this.rtlPageN(e)),o=this.isCover(e)?this.p.cover:this.p.page,s={n:e,texture:new r.THREE.Texture,wrapper:null,state:"loading",locked:function(t){return"loading"===s.state||"rendering"===s.state||i.book.isActivePage(t)},color:o.color,isActive:function(){return i.book.isActivePage(e)},isTop:function(){return~i.book.getTopPages().indexOf(e)},dispose:function(){i.removeFromLoadings(s),i.removeFromRenderQueue(s),s.wrapper&&s.wrapper.dispose&&s.wrapper.dispose(),s.texture.dispose(),delete s.texture,delete s.wrapper},pendings:[]};return s.texture.minFilter=r.THREE.LinearFilter,this.loadings.push(s),this.setMaterial(s,t),Promise.resolve().then(function(){if(s.texture){s.widthTexels=n.widthTexels||o.widthTexels,s.heightTexels=n.heightTexels||o.heightTexels;var t=i.calcResolution(s);s.wrapper=i.imageFactory.build(n,void 0===n.number?i.rtlPageN(e):n.number,t.width,t.height,o.color,i.p.injector),s.wrapper.setQuery&&s.wrapper.setQuery(i.pageQuery),s.simulate=n.interactive?(s.wrapper.simulate||function(){}).bind(s.wrapper):void 0,s.wrapper.onLoad=function(){i.pushInRenderQueue(s),i.book.dispatchEvent({type:"loadedPage",page:e})},s.wrapper.onChange=function(t){s.texture&&(i.removeFromLoadings(s),s.material&&(s.material.map=s.texture,s.material.color=new r.THREE.Color(16777215),s.material.needsUpdate=!0),s.texture.image=t,s.texture.needsUpdate=!0,s.texture.onUpdate=function(){"queuedForRender"!==s.state&&(s.state="active",i.resolvePendings(s.pendings)),delete i.rendering},i.tmpMaterial.map=s.texture,i.tmpMaterial.needsUpdate=!0)}}}),this.book.dispatchEvent({type:"loadPage",page:e}),this.pageCache.put(e,s)},t.prototype.isSinglePage=function(t){return this.p.singlePage||!t.n||t.n===this.book.getPages()-1},t.prototype.calcResolution=function(t){var e=void 0;if(this.p.autoResolution.enable){var i=Math.min((this.isSinglePage(t)?1:.5)*this.visual.width()/t.widthTexels,this.visual.height()/t.heightTexels);e={width:this.p.autoResolution.k*this.p.zoom*i*t.widthTexels,height:this.p.autoResolution.k*this.p.zoom*i*t.heightTexels}}else e={width:t.widthTexels,height:t.heightTexels};return e},t.prototype.pushInRenderQueue=function(t){"queuedForRender"!==t.state&&(t.state="queuedForRender",this.renderQueue.push(t))},t.prototype.updateRenderQueue=function(){if(this.canvas){var t=this.p;if(!this.rendering&&(t.renderWhileFlipping||!this.book.isProcessing())){var e=void 0,i=void 0,n=this.renderQueue,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}var a=s;if(!e&&a.isActive()&&(e=a),a.isTop()){i=a;break}}this.rendering=i||e,(this.isMobile()&&t.renderInactivePagesOnMobile||!this.isMobile()&&t.renderInactivePages)&&(this.rendering=this.rendering||this.renderQueue[0]),this.rendering&&(this.rendering.wrapper.startRender?(this.removeFromRenderQueue(this.rendering),this.rendering.state="rendering",this.rendering.wrapper.setResolution(this.calcResolution(this.rendering)),this.rendering.wrapper.startRender()):delete this.rendering)}setTimeout(this.updateRenderQueue.bind(this),250)}},t.prototype.turnOnEvents=function(){this.transferEvents=!0},t.prototype.turnOffEvents=function(){var t=r.$.Event("mouseup"),e=r.$.Event("mouseout");this.pageCache.forEach(function(i){var n=i[1];n.simulate&&(n.simulate(t,void 0,0,0),n.simulate(e,void 0,0,0))}),this.transferEvents=!1},t.prototype.transferEventToTexture=function(t,e,i){if(this.transferEvents){var n=this.getOrLoadTextureObject(void 0,t);if(n.wrapper){var o=i.uv,r=n.wrapper.getSimulatedDoc();this.pageCache.forEach(function(t){var i=t[1];i.simulate&&i.simulate(e,r,o.x,o.y)})}}},t.prototype.loadPredictedPages=function(){this.predictedRequests=h.default.predict(this.pageRequests,this.p.preloadPages);var t=this.predictedRequests,e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}var o=n;o<this.book.getPages()&&!this.pageCache.get(o)&&this.load(void 0,o)}},t.prototype.addPageRequest=function(t){this.pageRequests.push(t),this.pageRequests.length>this.p.pagesForPredicting&&this.pageRequests.shift(),Promise.resolve().then(this.loadPredictedPages.bind(this))},t.prototype.setMaterial=function(t,e){this.pageCache.forEach(function(i){var n=i[1];t!==n&&n.material===e&&delete n.material}),e&&e!==t.material&&(t.material=e,this.setupMaterial(t))},t.prototype.setupMaterial=function(t){t.material.map=t.texture.image?t.texture:this.loadingAnimation?this.loading[t.color].texture:null,t.material.map||(t.material.color=new r.THREE.Color(t.color)),t.material.needsUpdate=!0},t.prototype.getOrLoadTextureObject=function(t,e){var i=this.pageCache.get(e);return i?this.setMaterial(i,t):(i=this.load(t,e),this.addPageRequest(e)),i},t.prototype.setTexture=function(t,e){~this.predictedRequests.indexOf(e)&&this.addPageRequest(e),this.getOrLoadTextureObject(t,e)},t}();e.default=u},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=n(i(9)),r=n(i(18)),s=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n));return o.pdf=new r.default(i),o.pageDescription={type:"pdf",src:o.pdf,interactive:!0},o.binds={pageCallback:o.pageCallback.bind(o)},o.pdf.getHandler(o.init.bind(o)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){this.pdf.dispose(),t.prototype.dispose.call(this)},e.prototype.init=function(t){var e=this,i=this.pdf.getPagesNum();this.calcSheets(i),i>0?t.getPage(1).then(function(t){var i=t.getViewport(1),n={width:i.width,height:i.height};e.calcProps(n.width,n.height),e.ready()}).catch(function(t){console.error(t)}):(this.props=this.defaults,this.ready())},e.prototype.pageCallback=function(t){return this.pageDescription},e}(o.default);e.default=s},function(t,e,i){"use strict";e.__esModule=!0;var n=i(1),o=function(){function t(e,i,o){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.pdf=e,this.ctrl=i,this.element=(0,n.$)(o),this.cursors=[]}return t.prototype.dispose=function(){},t.prototype.setHandler=function(t){this.handler=t},t.prototype.defaultHandler=function(t,e){"internal"===t?this.ctrl.goToPage(e):"external"===t&&window.open(e,"_blank")},t.prototype.callHandlers=function(t,e){this.handler&&this.handler(t,e)||this.defaultHandler(t,e)},t.prototype.handleEvent=function(t){var e=this,i=t.event,n=t.annotation;switch(i.type){case"mouseover":this.cursors.push(this.element.css("cursor")),this.element.css("cursor","pointer");break;case"mouseout":this.element.css("cursor",this.cursors.pop()||"");break;case"touchtap":case"click":n.url?this.callHandlers("external",n.url):n.dest&&("string"==typeof n.dest?this.pdf.handler.getDestination(n.dest):Promise.resolve(n.dest)).then(function(t){return"number"==typeof t[0]?t[0]:e.pdf.handler.getPageIndex(t[0])}).then(function(t){return e.callHandlers("internal",t)}).catch(function(){return console.error("Bad link")})}},t}();e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n,o=(n=i(17))&&n.__esModule?n:{default:n},r=function(){function t(e,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.pageCallback=e,this.pages=i,this.results=[]}return t.prototype.setQuery=function(t){this.query=t,this.update=!0,this.process()},t.prototype.process=function(){var t=this;if(this.update){var e=this.results;if(this.results=[],this.onPageHitsChanged){var i=e,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){if(n){if(o>=i.length)break;i[o++]}else{if((o=i.next()).done)break;o.value}this.onPageHitsChanged(void 0,"")}}this.update=!1,this.page=0,this.stamp=Date.now(),this.query.length>1&&this.process()}else if(this.page<this.pages){var r=this.stamp;this.find(this.pageCallback(this.page)).then(function(e){r===t.stamp&&(e.length&&t.results.push({page:t.page,contexts:e}),t.onPageHitsChanged&&t.onPageHitsChanged(t.page,t.query),++t.page,t.process())})}},t.prototype.find=function(t){var e=this;return"pdf"===t.type?new Promise(function(i){t.src.getHandler(function(){var n=void 0===t.number?e.page:t.number;"right"===t.src.getPageType(n)?i([]):t.src.getPage(n).then(function(t){t.getTextContent().then(function(t){i(new o.default(t.items.map(function(t){return t.str}),e.query,{hits:!1}).getContexts())})}).catch(function(){return i([])})})}):Promise.resolve([])},t}();e.default=r},function(t,e,i){"use strict";e.__esModule=!0;var n,o=(n=i(13))&&n.__esModule?n:{default:n},r=function(){function t(e,i,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.visual=e;var r=i.getTopSize();this.layer=new o.default(r.width,r.height,n),this.update(i),this.visual.addCssObject(this.layer)}return t.prototype.dispose=function(){this.layer.dispose(),this.visual.removeCssObject(this.layer)},t.prototype.isHidden=function(){return this.layer.isHidden()},t.prototype.hide=function(){return this.layer.hide()},t.prototype.show=function(){return this.layer.show()},t.prototype.set=function(t,e,i){this.layer.setData(t,e,i)},t.prototype.update=function(t){this.block=t,this.block.getTopWorldRotation(this.layer.rotation),this.block.getTopWorldPosition(this.layer.position)},t}();e.default=r},function(t,e,i){"use strict";e.__esModule=!0;var n,o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=(n=i(3))&&n.__esModule?n:{default:n},s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.15,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:240;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.p={r:e,cornerDeviation:n,l:Math.PI*e,startDt:1/o,gravity:i,margin:.002*e,infM:1e4,attempts:16,maxIterations:100},this.os=[]}return t.targetForceClb=function(t,e,i,n){var o=e*this.r;return 100*this.m*this.g*(2/(1+Math.exp(10*(o-this.tl)))-1)-40*this.m*i},t.hoverCornerForceClb=function(t,e,i,n){return 5},t.prototype.getTargetForceClb=function(e,i){return t.targetForceClb.bind({g:this.p.gravity,m:e,tl:i*this.p.r,r:this.p.r})},t.dragForceClb=function(t,e,i,n){return t.flbt*t.m*(10*t.g*n-50*i/(1+Math.exp(3.5*Math.abs(n))))},t.dragCornerForceClb=function(t,e,i,n){return 15*(2/(1+Math.exp(10*(e-this.ta)*t.r))-1)},t.getDragCornerForceClb=function(e){return t.dragCornerForceClb.bind({ta:e})},t.prototype.dispose=function(){this.os=[]},t.prototype.getSize=function(){return this.os.length},t.prototype.addObject=function(t,e,i,n,o,s,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:function(){return 0},h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:function(){return 0},c={id:r.default.getUnique(),m:t,v:i,l:e*this.p.r,f:l,cf:h,ch:o,flbt:n,simulateClb:s,removeClb:a},u=this.os.findIndex(function(t){return c.l<=t.l});return u=~u?u:this.os.length,this.os.splice(u,0,c),c.id},t.prototype.getParametrMap=function(t){return{mass:"m",velocity:"v",flexibility:"flbt",cornerHeight:"ch",simulateClb:"simulateClb",removeClb:"removeClb",forceClb:"f",cornerForceClb:"cf"}[t]},t.prototype.setParametr=function(t,e,i){var n=this.os.find(function(e){return e.id===t});"angle"===e?n.l=i*this.p.r:n[this.getParametrMap(e)]=i},t.prototype.getParametr=function(t,e){var i=this.os.find(function(e){return e.id===t});return"angle"===e?i.l/this.p.r:i[this.getParametrMap(e)]},t.prototype.simulate=function(t){for(var e=0,i=this.p.startDt,n=0,o=0;e<t&&o<this.p.maxIterations;){i>t-e&&(i=t-e);var r=this.integrate(this.os,i),s=this.findCollisions(r);if(s.num>1&&n<this.p.attempts)i/=2,++n;else{if(1===s.num){var a=this.solveCollision(r[s.last-1],r[s.last]);r[s.last-1]=a[0],r[s.last]=a[1]}else if(s.num>1){var l=[],h=-2,c=s.all,u=Array.isArray(c),d=0;for(c=u?c:c[Symbol.iterator]();;){var f;if(u){if(d>=c.length)break;f=c[d++]}else{if((d=c.next()).done)break;f=d.value}var p=f;p-h>1&&l.push([]),l[l.length-1].push(p),h=p}var v=l,g=Array.isArray(v),m=0;for(v=g?v:v[Symbol.iterator]();;){var y;if(g){if(m>=v.length)break;y=v[m++]}else{if((m=v.next()).done)break;y=m.value}var b=y,w=void 0,k=void 0;r[b[0]].l>Math.PI/2*this.p.r?(w=-1,k=b[b.length-1]):(w=1,k=b[0]);for(var x=k;x<r.length&&x>-1;x+=w){var C=r[x+w];if(!(C&&w*(C.l-r[x].l)<=this.p.margin))break;C.l=r[x].l+2*w*this.p.margin,(C.l>this.p.l||C.l<0)&&(C.l=C.l>this.p.l?this.p.l:0,C.ch=0,C.v=0,console.error("Bad collision"))}}}this.os=r,this.findAndSolveCornerCollisions(),e+=i,i=this.p.startDt,n=0}++o}this.removeStatics()},t.prototype.removeStatics=function(){var t=[],e=[[],[]],i=this.os,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;s.simulateClb&&s.simulateClb(s.l/this.p.r,s.ch),s.l!==this.p.l&&0!==s.l||0!==s.v?t.push(s):void 0!==s.removeClb&&e[(s.l!==this.p.l)+0].push(s)}this.os=t;var a=e[0].reverse(),l=Array.isArray(a),h=0;for(a=l?a:a[Symbol.iterator]();;){var c;if(l){if(h>=a.length)break;c=a[h++]}else{if((h=a.next()).done)break;c=h.value}var u=c;u.removeClb(Math.PI,u.ch)}var d=e[1],f=Array.isArray(d),p=0;for(d=f?d:d[Symbol.iterator]();;){var v;if(f){if(p>=d.length)break;v=d[p++]}else{if((p=d.next()).done)break;v=p.value}var g=v;g.removeClb(0,g.ch)}},t.prototype.findAndSolveCornerCollisions=function(){if(this.os.length)for(var t=[o({},this.os[0],{l:0,m:this.p.infM,ch:0})].concat(this.os,[o({},this.os[0],{l:1.05*this.p.l,m:this.p.infM,ch:0})]),e=1;e<t.length;++e){var i=t[e-1],n=t[e];if(1.05*(i.l+this.p.cornerDeviation*i.ch*this.p.r)>n.l+this.p.cornerDeviation*n.ch*this.p.r&&i.ch>n.ch){var r=i.ch-n.ch,s=i.m/i.flbt+n.m/n.flbt,a=i.m/i.flbt/s,l=n.m/n.flbt/s;i.ch=i.ch-l*r,n.ch=n.ch+a*r}}},t.prototype.solveCollision=function(t,e){var i=e.m+t.m,n=(-t.v*e.m+t.m*t.v+2*e.m*e.v)/i,r=(e.m*e.v-e.v*t.m+2*t.m*t.v)/i;return[o({},t,{v:n}),o({},e,{v:r})]},t.prototype.findCollisions=function(t){for(var e={num:0,last:0,all:[]},i=1;i<t.length&&e.num<2;++i)(t[i-1].l>t[i].l||this.isCollision(t[i-1],t[i]))&&(t[i-1].l>t[i].l&&++e.num,++e.num,e.last=i,-1===e.all.indexOf(i-1)&&e.all.push(i-1),-1===e.all.indexOf(i)&&e.all.push(i));return e},t.prototype.isCollision=function(t,e){return Math.abs(t.l-e.l)<this.p.margin&&t.v>e.v},t.prototype.integrate=function(t,e){var i=[],n=t,s=Array.isArray(n),a=0;for(n=s?n:n[Symbol.iterator]();;){var l;if(s){if(a>=n.length)break;l=n[a++]}else{if((a=n.next()).done)break;l=a.value}var h=l,c=r.default.rk4(this.dy.bind({g:this.p.gravity,r:this.p.r,m:h.m,f:h.f,cf:h.cf,ch:h.ch,flbt:h.flbt}),0,e,[h.v,h.l,h.ch]),u=o({},h,{v:c[0],l:c[1],ch:c[2]});(u.l<=0||u.l>=this.p.l)&&(u.l=u.l<=0?0:this.p.l,u.v=0,u.ch=0),i.push(u)}return i},t.prototype.dy=function(t,e){var i=e[0],n=e[1],o=e[2],r=this.f(this,n/this.r,i,o),s=this.cf(this,n/this.r,i,o);return[(-this.g*Math.cos(n/this.r)*this.m+r)/this.m,i+.01*(Math.random()-.5),this.flbt*((2/(1+Math.exp(-.2*s))-1)*(1-2/(1+Math.exp(-5*(Math.abs(o)-2))))-o)]},t}();e.default=s},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.sounds=e.sounds||{},this.audio={},this.sounds.startFlip&&(this.audio.startFlip=new Audio(this.sounds.startFlip)),this.sounds.endFlip&&(this.audio.endFlip=new Audio(this.sounds.endFlip))}return t.prototype.setEnabled=function(t){this.enabled=t},t.prototype.togle=function(){this.enabled=!this.enabled},t.prototype.dispose=function(){delete this.audio.startFlip,delete this.audio.endFlip},t.prototype.startFlip=function(){this.enabled&&this.audio.startFlip&&this.audio.startFlip.play()},t.prototype.endFlip=function(){this.enabled&&this.audio.startFlip&&(this.audio.startFlip.pause(),this.audio.startFlip.currentTime=0),this.enabled&&this.audio.endFlip&&this.audio.endFlip.play()},t.prototype.subscribeFlips=function(t){t.addEventListener("startFlip",this.startFlip.bind(this)),t.addEventListener("endFlip",this.endFlip.bind(this))},t}();e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n,o=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return o.bookCtrl=n,o.tab="none",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setThumbnails=function(t){this.thumbnails=t,t.onNavigate=this.navigateThumbnails.bind(this),"none"===this.tab&&(this.tab="thumbnails"),this.fireChange()},e.prototype.setSearch=function(t){this.search=t,t.onNavigate=this.navigateSearch.bind(this),this.fireChange()},e.prototype.setBookmarks=function(t,e){this.bookmarks=t,this.pdf=e,t.onNavigate=this.navigateBookmarks.bind(this),t.getSize()&&(this.tab="bookmarks",this.isBookmarks=!0),this.fireChange()},e.prototype.cmdBookmarks=function(){this.tab="bookmarks",this.fireChange()},e.prototype.cmdThumbnails=function(){this.tab="thumbnails",this.fireChange()},e.prototype.cmdSearch=function(){this.tab="search",this.fireChange()},e.prototype.cmdCloseToc=function(){this.hide()},e.prototype.navigateThumbnails=function(t){this.bookCtrl.goToPage(t)},e.prototype.navigateSearch=function(t){this.bookCtrl.goToPage(t)},e.prototype.navigateBookmarks=function(t){var e=this;t.url?window.open(t.url,"_blank"):t.dest&&("string"==typeof t.dest?this.pdf.handler.getDestination(t.dest):Promise.resolve(t.dest)).then(function(t){return e.pdf.handler.getPageIndex(t[0])}).then(function(t){return e.bookCtrl.goToPage(t)}).catch(function(){return console.error("Bad bookmark")})},e.prototype.updateView=function(){var e=this;this.view&&(this.view.setState("widTocMenu",{enable:!0,visible:!0,active:!1}),this.view.setState("widThumbnails",{enable:!0,visible:"thumbnails"===this.tab,active:!1}),this.view.setState("widSearch",{enable:!0,visible:"search"===this.tab,active:!1}),this.view.setState("widBookmarks",{enable:!0,visible:"bookmarks"===this.tab,active:!1}),this.view.setState("cmdBookmarks",{enable:!0,visible:!0,active:"bookmarks"===this.tab}),this.view.setState("cmdCloseToc",{enable:!0,visible:!0,active:!1}),this.view.setState("cmdThumbnails",{enable:!0,visible:!0,active:"thumbnails"===this.tab}),this.view.setState("cmdSearch",{enable:!0,visible:!0,active:"search"===this.tab}),Promise.resolve().then(function(){return e.thumbnails.setEnable(e.visible&&"thumbnails"===e.tab)}),t.prototype.updateView.call(this))},e}(((n=i(67))&&n.__esModule?n:{default:n}).default);e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n,o=i(1),r=(n=i(20))&&n.__esModule?n:{default:n},s=[],a=new o.THREE.PlaneGeometry(1,1,10,1);a.translate(.5,.5,1);var l=new o.THREE.PlaneGeometry(1,1,10,1);l.rotateY(Math.PI),l.translate(.5,.5,0);var h=new o.THREE.PlaneGeometry(1,1,14,1);h.rotateY(-Math.PI/2),h.translate(0,.5,.5);var c=new o.THREE.PlaneGeometry(1,1,14,1);c.rotateY(Math.PI/2),c.translate(1,.5,.5);var u=new o.THREE.PlaneGeometry(1,1,10,14);u.rotateX(-Math.PI/2),u.translate(.5,1,.5);var d=u.clone();d.translate(0,-1,0);var f=d.faces,p=Array.isArray(f),v=0;for(f=p?f:f[Symbol.iterator]();;){var g;if(p){if(v>=f.length)break;g=f[v++]}else{if((v=f.next()).done)break;g=v.value}var m=g,y=[m.b,m.a];m.a=y[0],m.b=y[1]}var b=new o.THREE.Geometry;b.vertices=[].concat(d.vertices,u.vertices);var w=function(t,e){var i=t,n=Array.isArray(i),r=0;for(i=n?i:i[Symbol.iterator]();;){var a;if(n){if(r>=i.length)break;a=i[r++]}else{if((r=i.next()).done)break;a=r.value}var l=a;b.faces.push(new o.THREE.Face3(e(l.a),e(l.b),e(l.c)))}s.push(b.faces.length)},k=function(t,e){for(var i=[],n=0;n<t.length;++n)for(var o=0;o<e.length;++o)if(r=t[n],s=e[o],Math.abs(r.x-s.x)+Math.abs(r.y-s.y)+Math.abs(r.z-s.z)<1e-4){i[n]=o;break}var r,s;return i},x=k(a.vertices,b.vertices),C=k(l.vertices,b.vertices),P=k(h.vertices,b.vertices),S=k(c.vertices,b.vertices);w(u.faces,function(t){return t+d.vertices.length}),w(d.faces,function(t){return t}),w(a.faces,function(t){return x[t]}),w(l.faces,function(t){return C[t]}),w(h.faces,function(t){return P[t]}),w(c.faces,function(t){return S[t]}),s.pop(),r.default.computeFaceVertexUvs(b,s),b.computeVertexNormals(),b.computeBoundingSphere(),b.verticesNeedUpdate=!0,e.default={resX:11,resY:2,resZ:15,faces:s,geometry:b}},function(t,e,i){"use strict";e.__esModule=!0,e.props=function(){return{eps:1e-4,skin:{default:"short-white-book-view"},scale:{default:.9,min:.9,max:2.5,levels:7},lighting:{default:.7,min:0,max:1,levels:7},pan:{speed:50},loadingAnimation:{skin:!1,book:!0},autoResolution:{enabled:!0,coefficient:1.5},narrowView:{width:500},actions:{cmdZoomIn:{enabled:!0,enabledInNarrow:!0},cmdZoomOut:{enabled:!0,enabledInNarrow:!0},cmdDefaultZoom:{enabled:!0,enabledInNarrow:!1,type:"dblclick",code:0},cmdToc:{enabled:!0,enabledInNarrow:!0},cmdFastBackward:{enabled:!1,enabledInNarrow:!1},cmdBackward:{enabled:!0,enabledInNarrow:!1},cmdBigBackward:{enabled:!0,enabledInNarrow:!0},cmdForward:{enabled:!0,enabledInNarrow:!1},cmdBigForward:{enabled:!0,enabledInNarrow:!0},cmdFastForward:{enabled:!1,enabledInNarrow:!1},cmdSave:{enabled:!0,enabledInNarrow:!0},cmdPrint:{enabled:!0,enabledInNarrow:!1},cmdFullScreen:{enabled:!0,enabledInNarrow:!0},widSettings:{enabled:!0,enabledInNarrow:!0},cmdSmartPan:{enabled:!0,enabledInNarrow:!0,active:!0},cmdSinglePage:{enabled:!0,enabledInNarrow:!0,active:!1,activeForMobile:!1},cmdSounds:{enabled:!0,enabledInNarrow:!0,active:!0},cmdStats:{enabled:!0,enabledInNarrow:!0,active:!1},cmdLightingUp:{enabled:!0,enabledInNarrow:!0},cmdLightingDown:{enabled:!0,enabledInNarrow:!0},cmdPanLeft:{enabled:!1},cmdPanRight:{enabled:!1},cmdPanUp:{enabled:!1},cmdPanDown:{enabled:!1},mouseCmdRotate:{enabled:!0,type:"mousedrag",code:n.Right},mouseCmdDragZoom:{enabled:!0,type:"mousedrag",code:n.Middle},mouseCmdPan:{enabled:!0,type:"mousedrag",code:n.Left},mouseCmdWheelZoom:{enabled:!0,type:"mousewheel",code:0},touchCmdRotate:{enabled:!0,type:"touchdrag",code:3},touchCmdZoom:{enabled:!0,type:"touchdrag",code:2},touchCmdPan:{enabled:!0,type:"touchdrag",code:1},touchCmdSwipe:{enabled:!0,type:"touchdrag",code:1}}}};var n={Left:0,Middle:1,Right:2}},function(t,e,i){"use strict";e.__esModule=!0;var n,o=function(t){function e(i,n,o,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o,r));return Promise.resolve().then(function(){s.startRender=function(){s.renderBlankPage(),s.finishRender()},s.finishLoad()}),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}((i(0),(n=i(5))&&n.__esModule?n:{default:n}).default);e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n=i(0),o=function(){function t(e,i){var o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.title},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t.items};(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.container=e,this.map=[],this.getTitle=r,this.getItems=s,this.nodes=this.mapNodes(i,this.map),this.binds={togle:function(t){t.preventDefault();for(var i=(0,n.$)(t.target);i[0]&&i[0]!==e[0]&&!i.hasClass("item");)i=(0,n.$)(i[0].parentNode);if(i.hasClass("item")){for(var r=(0,n.$)(t.target);r[0]&&r[0]!==i[0]&&!r.hasClass("cmd");)r=(0,n.$)(r[0].parentNode);if(r.hasClass("cmd")){var s=o.map[i.attr("data-id")];r.hasClass("togle")?(s.minimized=!s.minimized,s.minimized?(i.find("ul").remove(),i.find(".togle").addClass("minimized")):(i.find(".togle").removeClass("minimized"),i.append((o.renderNode(s).match(/<ul.*<\/ul>/)||[""])[0]))):o.onNavigate&&o.onNavigate(s.item)}}}},e.on("click",this.binds.togle),this.update()}return t.prototype.getSize=function(){return this.map.length},t.prototype.dispose=function(){this.container.off("click",this.binds.togle),this.container.html("")},t.prototype.update=function(){this.container.html(this.renderNodes(this.nodes))},t.prototype.forEach=function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nodes)||[],i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var o;if(i){if(n>=e.length)break;o=e[n++]}else{if((n=e.next()).done)break;o=n.value}var r=o;t(r),this.forEach(t,r.children)}},t.prototype.expand=function(){this.forEach(function(t){return t.minimized=!1}),this.update()},t.prototype.minimize=function(){this.forEach(function(t){return t.minimized=!0}),this.update()},t.prototype.renderNode=function(t){return['<div class="area">',t.children?'<a href="#" class="cmd togle'+(t.minimized?" minimized":"")+'"><i class="fa fa-angle-right"></i></a> ':'<i class="white-space"></i> ','<a class="cmd" title="',t.title,'" href="#">',t.title,"</a></div>",t.minimized?"":this.renderNodes(t.children)].join("")},t.prototype.renderNodes=function(t){var e=['<div class="bookmarks">'];if(t&&t.length){e.push('<ul class="level-',t[0].level,'">');var i=t,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;e.push(['<li class="item" data-id="',s.id,'">',this.renderNode(s),"</li>"].join(""))}e.push("</ul>")}return e.push("</div>"),e.join("")},t.prototype.mapNodes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=null;if(t&&t.length){n=[];var o=t,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var l=a,h=e.length;e.push(void 0);var c={id:h,title:this.getTitle(l),level:i,item:l,minimized:!0,children:this.mapNodes(this.getItems(l),e,i+1)};n.push(c),e[h]=c}}return n},t}();e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n=i(0),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.getWebGLErrorMessage=function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",t.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),e},t.addGetWebGLMessage=function(e){var i,o=void 0;o=(e=e||{}).parent||(0,n.$)(document.body),e.id,i=t.getWebGLErrorMessage(),o.append(i)},t}();o.canvas=!!window.CanvasRenderingContext2D,o.webgl=function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}}(),o.workers=!!window.Worker,o.fileapi=window.File&&window.FileReader&&window.FileList&&window.Blob,e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n=i(0),o=function(){function t(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.body;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.jFrame=e,this.wnd=e[0].contentWindow,this.doc=e[0].contentDocument,this.element=i||doc.body,this.bElement=o,this.resendProperties=this.getDefaultResendProperties(),this.undefinedProperties=this.getDefaultUndefinedProperties(),this.cursors=[],this.onDocChangeClbs=[];for(var r=[{find:":hover",replace:"."+t.HOVER},{find:":active",replace:"."+t.ACTIVE}],s=['<style type="text/css">'],a=0;a<this.doc.styleSheets.length;++a)for(var l=this.doc.styleSheets[a],h=0;h<l.cssRules.length;++h){var c=l.cssRules[h],u=void 0,d=r,f=Array.isArray(d),p=0;for(d=f?d:d[Symbol.iterator]();;){var v;if(f){if(p>=d.length)break;v=d[p++]}else{if((p=d.next()).done)break;v=p.value}var g=v;~c.selectorText.indexOf(g.find)&&(u=(u||c.cssText).replace(new RegExp(g.find,"g"),g.replace))}u&&s.push(u)}s.push("</style>"),(0,n.$)(this.doc.head).append((0,n.$)(s.join("")))}return t.prototype.convertCoords=function(t,e){var i=(0,n.$)(this.element),o=i.offset();return{x:o.left+i.width()*t,y:o.top+i.height()*(1-e)}},t.prototype.triggerEvent=function(t,e,i,o,r){var s={},a=this.resendProperties,l=Array.isArray(a),h=0;for(a=l?a:a[Symbol.iterator]();;){var c;if(l){if(h>=a.length)break;c=a[h++]}else{if((h=a.next()).done)break;c=h.value}var u=c;s[u]=e[u]}var d=this.undefinedProperties,f=Array.isArray(d),p=0;for(d=f?d:d[Symbol.iterator]();;){var v;if(f){if(p>=d.length)break;v=d[p++]}else{if((p=d.next()).done)break;v=p.value}s[v]=void 0}for(var g in r)r.hasOwnProperty(g)&&(s[g]=r[g]);s.view=this.wnd,s.pageX=i.x,s.pageY=i.y;var m=n.$.Event(o,s);m.timeStamp=e.timeStamp,(0,n.$)(t).trigger(m)},t.prototype.addClass=function(t,e){(0,n.$)(t).addClass(e);var i=this.wnd.getComputedStyle(t);this.cursors.push((0,n.$)(this.bElement).css("cursor")),(0,n.$)(this.bElement).css("cursor",i.getPropertyValue("cursor"))},t.prototype.removeClass=function(t,e){(0,n.$)(t).removeClass(e),(0,n.$)(this.bElement).css("cursor",this.cursors.pop())},t.prototype.enterElement=function(e){this.addClass(e,t.HOVER)},t.prototype.leaveElement=function(e){this.removeClass(e,t.HOVER)},t.prototype.activateElement=function(e){this.addClass(e,t.ACTIVE)},t.prototype.deactivateElement=function(e){this.removeClass(e,t.ACTIVE)},t.prototype.addDocChangeClb=function(t){this.onDocChangeClbs.push(t)},t.prototype.notify=function(){var t=this.onDocChangeClbs,e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}n(this.wnd,this.doc)}},t.prototype.elementFromPoint=function(t){for(var e=this.doc.body,i=!0;i;){i=!1;for(var o=0;o<e.childNodes.length;++o){var r=e.childNodes[o];if(r instanceof this.wnd.Element){var s=(0,n.$)(r),a=s.offset(),l=s.height(),h=s.width();if(t.x>a.left&&t.x<a.left+h&&t.y>a.top&&t.y<a.top+l){e=r,i=!0;break}}}}return e},t.prototype.getElement=function(t){var e=this.jFrame.offset();this.jFrame.offset({left:.5*window.innerWidth-t.x,top:.5*window.innerHeight-t.y});var i=this.doc.elementFromPoint(t.x,t.y);return i||(i=this.doc.elementFromPoint(t.x,t.y)),this.jFrame.offset(e),i||this.elementFromPoint(t)},t.prototype.simulate=function(t,e,i,n){var o=this.convertCoords(i,n),r=e===this.doc?this.getElement(o):void 0,s=void 0!==r,a=!1;switch(t.type){case"mousedown":this.capElement&&(this.deactivateElement(this.capElement),a=!0),this.capElement=r,this.capElement&&(this.activateElement(this.capElement),a=!0);break;case"mouseup":this.capElement&&(this.deactivateElement(this.capElement),a=!0),this.timeStamp=t.timeStamp;break;case"click":s=r&&this.capElement===r,this.capElement=void 0;break;case"mouseenter":case"mouseover":case"mousemove":var l=null;this.hovElement!==r&&this.hovElement&&(this.triggerEvent(this.hovElement,t,o,"mouseout",{relatedTarget:r||null}),this.leaveElement(this.hovElement),l=this.hovElement,this.hovElement=void 0,a=!0),!this.hovElement&&r&&(this.triggerEvent(r,t,o,"mouseover",{relatedTarget:l}),this.enterElement(r),this.hovElement=r,a=!0),s=r&&"mousemove"===t.type;break;case"mouseleave":case"mouseout":this.hovElement&&(this.triggerEvent(this.hovElement,t,o,"mouseout",{relatedTarget:t.relatedTarget}),this.leaveElement(this.hovElement),this.hovElement=void 0,a=!0),s=!1}s&&this.triggerEvent(r,t,o,t.type),a&&this.notify()},t.prototype.getDefaultUndefinedProperties=function(){return["clientX","clientY","offsetX","offsetY","screenX","screenY"]},t.prototype.getDefaultResendProperties=function(){return["altKey","bubbles","button","buttons","cancelable","changedTouches","char","charCode","ctrlKey","data","detail","eventPhase","isDefaultPrevented","key","keyCode","metaKey","pointerId","pointerType","shiftKey","targetTouches","touches","which"]},t}();o.HOVER="SIMULATED-HOVER",o.ACTIVE="SIMULATED-ACTIVE",e.default=o},function(t,e,i){"use strict";e.__esModule=!0,e.default=function t(e,i,n){function o(t,e){return e=e||{},Promise.resolve(t).then(function(t){return function(t,e,i){return Promise.resolve(t).then(function(t){return h.isCanvas(t)?h.makeImage(t.toDataURL()):t.cloneNode(!1)}).then(function(i){return function(t,e,i){var n=t.childNodes;return 0===n.length?Promise.resolve(e):function(t,e,i){var n=Promise.resolve();return e.forEach(function(e){n=n.then(function(){return function t(e,i,n){return n||!i||i(e)?Promise.resolve(e).then(function(t){return h.isCanvas(t)?h.makeImage(t.toDataURL()):t.cloneNode(!1)}).then(function(n){return function(e,i,n){var o=e.childNodes;return 0===o.length?Promise.resolve(i):function(e,i,n){var o=Promise.resolve();return i.forEach(function(i){o=o.then(function(){return t(i,n)}).then(function(t){t&&e.appendChild(t)})}),o}(i,h.asArray(o),n).then(function(){return i})}(e,n,i)}).then(function(t){return function(t,e){return h.isElement(e)?Promise.resolve().then(function(){var i,n;i=l.window.getComputedStyle(t),n=e.style,i.cssText?n.cssText=i.cssText:function(t,e){h.asArray(t).forEach(function(i){e.setProperty(i,t.getPropertyValue(i),t.getPropertyPriority(i))})}(i,n)}).then(function(){[":before",":after"].forEach(function(i){!function(i){var n=l.window.getComputedStyle(t,i),o=n.getPropertyValue("content");if(""!==o&&"none"!==o){var r=h.uid();e.className=e.className+" "+r;var s=l.document.createElement("style");s.appendChild(function(t,e,i){var n="."+r+":"+e,o=i.cssText?function(t){var e=t.getPropertyValue("content");return t.cssText+" content: "+e+";"}(i):function(t){return h.asArray(t).map(function(e){return e+": "+t.getPropertyValue(e)+(t.getPropertyPriority(e)?" !important":"")}).join("; ")+";"}(i);return l.document.createTextNode(n+"{"+o+"}")}(0,i,n)),e.appendChild(s)}}(i)})}).then(function(){h.isTextArea(t)&&(e.innerHTML=t.value),h.isInput(t)&&e.setAttribute("value",t.value)}).then(function(){h.isSVG(e)&&(e.setAttribute("xmlns","http://www.w3.org/2000/svg"),h.isSVGRect(e)&&["width","height"].forEach(function(t){var i=e.getAttribute(t);i&&e.style.setProperty(t,i)}))}).then(function(){return e}):e}(e,t)}):Promise.resolve()}(e,i)}).then(function(e){e&&t.appendChild(e)})}),n}(e,h.asArray(n),i).then(function(){return e})}(t,i,e)}).then(function(e){return function(t,e){return h.isElement(e)?Promise.resolve().then(function(){var i,n;i=l.window.getComputedStyle(t),n=e.style,i.cssText?n.cssText=i.cssText:function(t,e){h.asArray(t).forEach(function(i){e.setProperty(i,t.getPropertyValue(i),t.getPropertyPriority(i))})}(i,n)}).then(function(){[":before",":after"].forEach(function(i){!function(i){var n=l.window.getComputedStyle(t,i),o=n.getPropertyValue("content");if(""!==o&&"none"!==o){var r=h.uid();e.className=e.className+" "+r;var s=l.document.createElement("style");s.appendChild(function(t,e,i){var n="."+r+":"+e,o=i.cssText?function(t){var e=t.getPropertyValue("content");return t.cssText+" content: "+e+";"}(i):function(t){return h.asArray(t).map(function(e){return e+": "+t.getPropertyValue(e)+(t.getPropertyPriority(e)?" !important":"")}).join("; ")+";"}(i);return l.document.createTextNode(n+"{"+o+"}")}(0,i,n)),e.appendChild(s)}}(i)})}).then(function(){h.isTextArea(t)&&(e.innerHTML=t.value),h.isInput(t)&&e.setAttribute("value",t.value)}).then(function(){h.isSVG(e)&&(e.setAttribute("xmlns","http://www.w3.org/2000/svg"),h.isSVGRect(e)&&["width","height"].forEach(function(t){var i=e.getAttribute(t);i&&e.style.setProperty(t,i)}))}).then(function(){return e}):e}(t,e)})}(t,e.filter)}).then(s).then(a).then(function(t){return e.bgcolor&&(t.style.backgroundColor=e.bgcolor),e.width&&(t.style.width=e.width+"px"),e.height&&(t.style.height=e.height+"px"),e.style&&l.window.Object.keys(e.style).forEach(function(i){t.style[i]=e.style[i]}),t}).then(function(i){return function(t,e,i){return Promise.resolve(t).then(function(t){return t.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new l.window.XMLSerializer).serializeToString(t)}).then(h.escapeXhtml).then(function(t){return["data:image/svg+xml;charset=utf-8,",'<svg xmlns="http://www.w3.org/2000/svg" width="',e,'" height="',i,'">','<foreignObject x="0" y="0" width="100%" height="100%">',t,"</foreignObject>","</svg>"].join("")})}(i,e.width||h.width(t),e.height||h.height(t))})}function r(t,e){return o(t,e).then(h.makeImage).then(h.delay(100)).then(function(i){var n=function(t){var i=l.document.createElement("canvas");if(i.width=e.width||h.width(t),i.height=e.height||h.height(t),e.bgcolor){var n=i.getContext("2d");n.fillStyle=e.bgcolor,n.fillRect(0,0,i.width,i.height)}return i}(t);return n.getContext("2d").drawImage(i,0,0),n})}function s(t){return u.resolveAll().then(function(e){var i=l.document.createElement("style");return t.appendChild(i),i.appendChild(l.document.createTextNode(e)),t})}function a(t){return d.inlineAll(t).then(function(){return t})}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var l=this;this.window=e,this.document=i,this.cache=n;var h=function(){function t(t){var e=/\.([^\.\/]*?)$/g.exec(t);return e?e[1]:""}function e(t,e){var i=l.window.getComputedStyle(t).getPropertyValue(e);return parseFloat(i.replace("px",""))}return{escape:function(t){return t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:t,mimeType:function(e){var i;return(i="application/font-woff",{woff:i,woff2:i,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"})[t(e).toLowerCase()]||""},dataAsUrl:function(t,e){return["data:",e,";base64,",t].join("")},isDataUrl:function(t){return-1!==t.search(/^(data:)/)},canvasToBlob:function(t){return t.toBlob?new Promise(function(e){t.toBlob(e)}):function(t){return new Promise(function(e){for(var i=l.window.atob(t.toDataURL().split(",")[1]),n=i.length,o=new l.window.Uint8Array(n),r=0;r<n;r++)o[r]=i.charCodeAt(r);e(new l.window.Blob([o],{type:"image/png"}))})}(t)},resolveUrl:function(t,e){var i=l.document.implementation.createHTMLDocument(),n=i.createElement("base");i.head.appendChild(n);var o=i.createElement("a");return i.body.appendChild(o),n.href=e,o.href=t,o.href},getAndEncode:function(t){var e=l.cache.get(t);return e?e.content?e.content:new Promise(function(t){e.content?t(e.content):e.pendings.push(t)}):(e=l.cache.put(t,{pendings:[]}),new Promise(function(i){function n(t){console.error(t),i("")}var o=new l.window.XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState){if(200!==o.status)return void n("cannot fetch resource: "+t+", status: "+o.status);var r=new l.window.FileReader;r.onloadend=function(){e.content=r.result.split(/,/)[1];var t=e.pendings,n=Array.isArray(t),o=0;for(t=n?t:t[Symbol.iterator]();;){var s;if(n){if(o>=t.length)break;s=t[o++]}else{if((o=t.next()).done)break;s=o.value}s(e.content)}e.pendings=[],i(e.content)},r.readAsDataURL(o.response)}},o.ontimeout=function(){n("timeout of 30000ms occured while fetching resource: "+t)},o.responseType="blob",o.timeout=3e4,o.open("GET",t,!0),o.send()}))},uid:(i=0,function(){return"u"+("0000"+(l.window.Math.random()*l.window.Math.pow(36,4)<<0).toString(36)).slice(-4)+i++}),delay:function(t){return function(e){return new Promise(function(i){setTimeout(function(){i(e)},t)})}},asArray:function(t){for(var e=[],i=t.length,n=0;n<i;n++)e.push(t[n]);return e},escapeXhtml:function(t){return t.replace(/(#|\n)/g,function(t){return"#"===t?"%23":"%0A"})},makeImage:function(t){return new Promise(function(e,i){var n=new l.window.Image;n.onload=function(){e(n)},n.onerror=i,n.src=t})},width:function(t){var i=e(t,"border-left-width"),n=e(t,"border-right-width");return t.scrollWidth+i+n},height:function(t){var i=e(t,"border-top-width"),n=e(t,"border-bottom-width");return t.scrollHeight+i+n},isElement:function(t){return t instanceof l.window.Element},isCanvas:function(t){return t instanceof l.window.HTMLCanvasElement},isTextArea:function(t){return t instanceof l.window.HTMLTextAreaElement},isInput:function(t){return t instanceof l.window.HTMLInputElement},isSVG:function(t){return t instanceof l.window.SVGElement},isSVGRect:function(t){return t instanceof l.window.SVGRectElement},isImage:function(t){return t instanceof l.window.HTMLImageElement}};var i}(),c=function(){function t(t){return-1!==t.search(n)}function e(t){for(var e=[],i=void 0;null!==(i=n.exec(t));)e.push(i[1]);return e.filter(function(t){return!h.isDataUrl(t)})}function i(t,e,i,n){return Promise.resolve(e).then(function(t){return i?h.resolveUrl(t,i):t}).then(n||h.getAndEncode).then(function(t){return h.dataAsUrl(t,h.mimeType(e))}).then(function(i){return t.replace(function(t){return new l.window.RegExp(["(url\\(['\"]?)(",h.escape(t),")(['\"]?\\))"].join(""),"g")}(e),["$1",i,"$3"].join(""))})}var n=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(n,o,r){return t(n)?Promise.resolve(n).then(e).then(function(t){var e=Promise.resolve(n);return t.forEach(function(t){e=e.then(function(e){return i(e,t,o,r)})}),e}):Promise.resolve(n)},shouldProcess:t,impl:{readUrls:e,inline:i}}}(),u=function(){function t(){function t(t){return{resolve:function(){var e=(t.parentStyleSheet||{}).href;return c.inlineAll(t.cssText,e)},src:function(){return t.style.getPropertyValue("src")}}}return Promise.resolve(h.asArray(l.document.styleSheets)).then(function(t){var e=[];return t.forEach(function(t){try{h.asArray(t.cssRules||[]).forEach(e.push.bind(e))}catch(e){console.log("Error while reading CSS rules from "+t.href,e.toString())}}),e}).then(function(t){return t.filter(function(t){return t.type===CSSRule.FONT_FACE_RULE}).filter(function(t){return c.shouldProcess(t.style.getPropertyValue("src"))})}).then(function(e){return e.map(t)})}return{resolveAll:function(){return t(l.document).then(function(t){return Promise.all(t.map(function(t){return t.resolve()}))}).then(function(t){return t.join("\n")})},impl:{readAll:t}}}(),d=function(){function t(t){return{inline:function(e){return h.isDataUrl(t.src)?Promise.resolve():Promise.resolve(t.src).then(e||h.getAndEncode).then(function(e){return h.dataAsUrl(e,h.mimeType(t.src))}).then(function(e){return new Promise(function(i,n){t.onload=i,t.onerror=n,t.src=e})})}}}return{inlineAll:function e(i){return h.isElement(i)?function(t){var e=t.style.getPropertyValue("background");return e?c.inlineAll(e).then(function(e){t.style.setProperty("background",e,t.style.getPropertyPriority("background"))}).then(function(){return t}):Promise.resolve(t)}(i).then(function(){return h.isImage(i)?t(i).inline():Promise.all(h.asArray(i.childNodes).map(function(t){return e(t)}))}):Promise.resolve(i)},impl:{newImage:t}}}();this.toSvg=o,this.toPng=function(t,e){return r(t,e||{}).then(function(t){return t.toDataURL()})},this.toJpeg=function(t,e){return r(t,e=e||{}).then(function(t){return t.toDataURL("image/jpeg",e.quality||1)})},this.toBlob=function(t,e){return r(t,e||{}).then(h.canvasToBlob)},this.toPixelData=function(t,e){return r(t,e||{}).then(function(e){return e.getContext("2d").getImageData(0,0,h.width(t),h.height(t)).data})},this.impl={fontFaces:u,images:d,util:h,inliner:c}}},function(t,e,i){"use strict";e.__esModule=!0;var n=i(0),o=function(){function t(e,i,o){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.wnd=e,this.doc=i,this.visual=o,this.coords=new n.THREE.Vector2,this.intersection=new n.THREE.Vector3,this.raycaster=this.visual.raycaster,this.camera=this.visual.camera,this.plane=new n.THREE.Plane,this.threes=[],this.selected=null,this.enabled=!0,this.controlsState=this.visual.getControlsState(),this.element=this.visual.element,this.binds={onMouseMove:this.onMouseMove.bind(this),onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.onMouseUp.bind(this)},(0,n.$)(this.element).on("mousemove",this.binds.onMouseMove),(0,n.$)(this.element).on("mousedown",this.binds.onMouseDown),(0,n.$)(this.doc).on("mouseup",this.binds.onMouseUp)}return t.prototype.addThree=function(t){this.threes.push(t)},t.prototype.removeThree=function(t){var e=this.threes.indexOf(t);~e&&this.threes.splice(e,1)},t.prototype.onPickCallback=function(){return!0},t.prototype.onDragCallback=function(){return!0},t.prototype.onReleaseCallback=function(){},t.prototype.dispose=function(){(0,n.$)(this.element).off("mousemove",this.binds.onMouseMove),(0,n.$)(this.element).off("mousedown",this.binds.onMouseDown),(0,n.$)(this.doc).off("mouseup",this.binds.onMouseUp)},t.prototype.setCoordsFromEvent=function(t){var e=(0,n.$)(this.element),i=e.offset();return this.coords.x=(t.pageX-i.left)/e.width()*2-1,this.coords.y=-(t.pageY-i.top)/e.height()*2+1,this.coords},t.prototype.onMouseDown=function(t){if(this.enabled){this.selected&&this.onMouseUp(t),this.setCoordsFromEvent(t),this.raycaster.setFromCamera(this.coords,this.camera);var e=this.raycaster.intersectObjects(this.threes);if(e.length>0){var i=e[0].object;if(!this.onPickCallback(e[0]))return;var n=e[0].point.clone();this.distance=n.sub(this.raycaster.ray.origin).length(),this.controlsState=this.visual.getControlsState(),this.visual.setControlsState(!1),this.plane.setFromNormalAndCoplanarPoint(this.visual.camera.getWorldDirection(this.plane.normal),e[0].point),this.selected=i}}},t.prototype.onMouseMove=function(t){this.enabled&&(t.preventDefault(),this.selected&&(this.setCoordsFromEvent(t),this.raycaster.setFromCamera(this.coords,this.camera),this.raycaster.ray.intersectPlane(this.plane,this.intersection)&&(this.onDragCallback(this.intersection)||this.onMouseUp(t))))},t.prototype.onMouseUp=function(t){this.selected&&(this.onReleaseCallback(),this.selected=null,this.visual.setControlsState(this.controlsState)),this.enabled&&t.preventDefault()},t}();e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},o=i(0);i(70)(o.$);var r=function(){function t(e,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.actions=i||{},this.element=e,this.doc=e[0].ownerDocument,this.wnd=this.doc.defaultView,this.enabled=!0,this.binds={contextMenu:this.contextMenu.bind(this),mouseDown:this.mouseDown.bind(this),mouseMove:this.mouseMove.bind(this),mouseUp:this.mouseUp.bind(this),mouseWheel:this.mouseWheel.bind(this),mouseMoveDoc:this.mouseMoveDoc.bind(this),mouseUpDoc:this.mouseUpDoc.bind(this),click:this.click.bind(this),dblclick:this.dblclick.bind(this),touchStart:this.touchStart.bind(this),touchMove:this.touchMove.bind(this),touchEnd:this.touchEnd.bind(this),keyDown:this.keyDown.bind(this),keyPress:this.keyPress.bind(this),keyUp:this.keyUp.bind(this)},this.element.on("contextmenu",this.binds.contextMenu),this.element.on("mousedown",this.binds.mouseDown),this.element.on("mousemove",this.binds.mouseMove),this.element.on("mouseup",this.binds.mouseUp),this.element.on("mousewheel",this.binds.mouseWheel),(0,o.$)(this.doc).on("mousemove",this.binds.mouseMoveDoc),(0,o.$)(this.doc).on("mouseup",this.binds.mouseUpDoc),this.element.on("click",this.binds.click),this.element.on("dblclick",this.binds.dblclick),this.element.on("touchstart",this.binds.touchStart),this.element.on("touchmove",this.binds.touchMove),this.element.on("touchend",this.binds.touchEnd),(0,o.$)(this.wnd).on("keydown",this.binds.keyDown),(0,o.$)(this.wnd).on("keypress",this.binds.keyPress),(0,o.$)(this.wnd).on("keyup",this.binds.keyUp)}return t.getEventFlags=function(t){return t.ctrlKey<<0|t.shiftKey<<1|t.altKey<<2},t.getPosition=function(t){var e=void 0,i=void 0;return 2===t.length?(e=t[1].pageX-t[0].pageX,i=t[1].pageY-t[0].pageY,i=-Math.sqrt(e*e+i*i),e=0):(e=t[0].pageX,i=t[0].pageY),{x:e,y:i}},t.prototype.addAction=function(t,e,i,n){e=e.toLowerCase(),this.actions[e]||(this.actions[e]={}),this.actions[e][i]||(this.actions[e][i]={}),this.actions[e][i][n]||(this.actions[e][i][n]=[]),this.actions[e][i][n].push(t)},t.prototype.getActions=function(t,e,i){return((this.actions[t]||{})[e]||{})[i]||[]},t.prototype.fireActions=function(t,e,i){var n=t,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}s(e,i)}},t.prototype.contextMenu=function(e){if(this.enabled){var i=t.getEventFlags(e);this.fireActions(this.getActions("contextmenu",e.button,i),e)}},t.prototype.mouseDown=function(e){if(this.picked&&this.mouseUpDoc(),this.enabled){var i=t.getEventFlags(e);this.fireActions(this.getActions("mousedown",e.button,i),e),this.picked={x:e.pageX,y:e.pageY,actions:this.getActions("mousedrag",e.button,i)},this.fireActions(this.picked.actions,e,{state:"start"})}},t.prototype.mouseMove=function(e){if(this.enabled){var i=t.getEventFlags(e);this.fireActions(this.getActions("mousemove",e.button,i),e)}},t.prototype.mouseMoveDoc=function(t){this.enabled&&this.picked&&(this.fireActions(this.picked.actions,t,{state:"move",dx:t.pageX-this.picked.x,dy:t.pageY-this.picked.y}),this.picked={x:t.pageX,y:t.pageY,actions:this.picked.actions})},t.prototype.mouseUp=function(e){if(this.enabled){var i=t.getEventFlags(e);this.fireActions(this.getActions("mouseup",e.button,i),e)}},t.prototype.mouseUpDoc=function(t){this.picked&&(this.fireActions(this.picked.actions,t,{state:"end"}),delete this.picked)},t.prototype.mouseWheel=function(e){if(this.enabled){var i=t.getEventFlags(e);this.fireActions(this.getActions("mousewheel",0,i),e)}},t.prototype.clicks=function(e,i){if(this.enabled){var n=t.getEventFlags(e);this.fireActions(this.getActions(i,e.button,n),e)}},t.prototype.click=function(t){this.clicks(t,"click")},t.prototype.dblclick=function(t){this.clicks(t,"dblclick")},t.prototype.touchPick=function(e,i,o){this.touchPicked=n({},t.getPosition(o),{actions:this.getActions("touchdrag",o.length,i),code:o.length,flags:i}),this.fireActions(this.touchPicked.actions,e,{state:"start"})},t.prototype.touchStart=function(e){if(this.touchPicked&&this.touchEnd(e),this.enabled){var i=t.getEventFlags(e),n=e.touches||e.originalEvent.touches;this.fireActions(this.getActions("touchstart",n.length,i),e),this.touchPick(e,i,n)}},t.prototype.touchMove=function(e){if(this.enabled){var i=t.getEventFlags(e),o=e.touches||e.originalEvent.touches;if(this.fireActions(this.getActions("touchmove",o.length,i),e),this.touchPicked)if(this.touchPicked.code===o.length&&this.touchPicked.flags===i){var r=t.getPosition(o);this.fireActions(this.touchPicked.actions,e,{state:"move",dx:r.x-this.touchPicked.x,dy:r.y-this.touchPicked.y}),this.touchPicked=n({},this.touchPicked,r)}else this.touchEnd(e),this.touchPick(e,i,o)}},t.prototype.touchEnd=function(t){this.touchPicked&&(this.fireActions(this.touchPicked.actions,t,{state:"end"}),delete this.touchPicked)},t.prototype.key=function(e,i){if(this.enabled){var n=t.getEventFlags(e);this.fireActions(this.getActions(i,e.keyCode,n),e)}},t.prototype.keyDown=function(t){this.key(t,"keydown")},t.prototype.keyPress=function(t){this.key(t,"keypress")},t.prototype.keyUp=function(t){this.key(t,"keyup")},t.prototype.dispose=function(){this.element.off("contextmenu",this.binds.contextMenu),this.element.off("mousedown",this.binds.mouseDown),this.element.off("mousemove",this.binds.mouseMove),this.element.off("mouseup",this.binds.mouseUp),this.element.off("mousewheel",this.binds.mouseWheel),(0,o.$)(this.doc).off("mousemove",this.binds.mouseMoveDoc),(0,o.$)(this.doc).off("mouseup",this.binds.mouseUpDoc),this.element.off("click",this.binds.click),this.element.off("dblclick",this.binds.dblclick),this.element.off("touchstart",this.binds.touchStart),this.element.off("touchmove",this.binds.touchMove),this.element.off("touchend",this.binds.touchEnd),(0,o.$)(this.wnd).off("keydown",this.binds.keyDown),(0,o.$)(this.wnd).off("keypress",this.binds.keyPress),(0,o.$)(this.wnd).off("keyup",this.binds.keyUp)},t}();r.modKeys={Ctrl:1,Shift:2,Alt:4},r.mouseButtons={Left:0,Middle:1,Right:2},e.default=r},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.available=function(){return t._hasWebkitFullScreen||t._hasMozFullScreen||t._hasMsFullscreen},t.activated=function(){return t._hasWebkitFullScreen?document.webkitIsFullScreen:t._hasMozFullScreen?document.mozFullScreen:t._hasMsFullscreen?!!document.msFullscreenElement:void console.assert(!1)},t.addEventListener=function(t,e){t.addEventListener&&(t.addEventListener("webkitfullscreenchange",e,!1),t.addEventListener("mozfullscreenchange",e,!1),t.addEventListener("fullscreenchange",e,!1),t.addEventListener("MSFullscreenChange",e,!1))},t.removeEventListener=function(t,e){t.removeEventListener&&(t.removeEventListener("webkitfullscreenchange",e,!1),t.removeEventListener("mozfullscreenchange",e,!1),t.removeEventListener("fullscreenchange",e,!1),t.removeEventListener("MSFullscreenChange",e,!1))},t.request=function(e){e=e||document.body,t._hasWebkitFullScreen?e.webkitRequestFullScreen():t._hasMozFullScreen?e.mozRequestFullScreen():t._hasMsFullscreen?e.msRequestFullscreen():console.assert(!1)},t.cancel=function(){t._hasWebkitFullScreen?document.webkitCancelFullScreen():t._hasMozFullScreen?document.mozCancelFullScreen():t._hasMsFullscreen?document.msExitFullscreen():console.assert(!1)},t}();n._hasWebkitFullScreen=!!document.webkitCancelFullScreen,n._hasMozFullScreen=!!document.mozCancelFullScreen,n._hasMsFullscreen=!!document.documentElement.msRequestFullscreen,e.default=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=i(0),r=n(i(5)),s=n(i(2)),a=n(i(47)),l=n(i(46)),h=function(t){function e(i,n,r,h,c,u,d){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var f=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,r,h));f.iId="i"+s.default.getUnique();var p=(0,o.$)('<iframe id="'+f.iId+'" src="'+c+'" style="position: fixed; left: -1000px;"></iframe>');return(0,o.$)(f.doc.body).append(p),f.frame=p[0],f.binds={},d&&d(f.frame.contentWindow),f.doc.implementation.hasFeature("www.http://w3.org/TR/SVG11/feature#Extensibility","1.1")&&(f.image=new Image,f.binds.imageLoad=function(){f.renderImage(f.image),f.finishRender()},(0,o.$)(f.image).on("load",f.binds.imageLoad),f.svgRender=new a.default(f.frame.contentWindow,f.frame.contentDocument,u)),f.binds.frameLoad=function(){~f.frame.contentDocument.title.indexOf("404")?(f.startRender=function(){f.renderNotFoundPage(),f.finishRender()},f.finishLoad()):setTimeout(function(){f.frame&&(f.width=(0,o.$)(f.frame.contentDocument.body).width(),f.height=(0,o.$)(f.frame.contentDocument.body).height(),p.css("width",f.width+"px").css("height",f.height+"px"),p.offset({left:-f.width-100,top:0}),f.svgRender&&(f.simulator=new l.default(p,f.frame.contentDocument.body,f.element),f.simulator.addDocChangeClb(f.finishLoad.bind(f))),f.startRender=function(){f.render()},f.finishLoad())},500)},(0,o.$)(f.frame.contentWindow).on("load",f.binds.frameLoad),f}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getSimulatedDoc=function(){return this.frame.contentDocument},e.prototype.render=function(){var t=this;this.svgRender?this.svgRender.toSvg(this.simulator.element,{height:this.height+"px",width:this.width+"px"}).then(function(e){t.image.src=e}).catch(function(e){console.error("Dom2Image: ",e),t.renderBlankPage(),t.finishRender()}):(0,o.html2canvas)(this.frame.contentDocument.body,{timeout:3e4}).then(function(e){t.renderImage(e),t.finishRender()})},e.prototype.dispose=function(){(0,o.$)(this.image).off("load",this.binds.imageLoad),(0,o.$)(this.frame.contentWindow).off("load",this.binds.frameLoad),(0,o.$)(this.doc.body).find("#"+this.iId).remove(),this.image&&(this.image.src="",delete this.image),this.frame.src="",delete this.frame,t.prototype.dispose.call(this)},e.prototype.simulate=function(t,e,i,n){this.simulator&&this.simulator.simulate(t,e,i,n)},e}(r.default);e.default=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=i(0),r=n(i(7)),s=n(i(3)),a=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=(0,o.$)('<canvas width="'+e+'" height="'+i+'"></canvas>');this.c=r[0],this.p={g:9.8,dt:1/60,color:n,updateInterval:.25},this.ctx=this.c.getContext("2d"),this.os=[-2,Math.PI/2],this.t=this.p.updateInterval}return t.prototype.dy=function(t,e){var i=e[0],n=e[1];return[-this.g*Math.cos(n),i]},t.prototype.integrate=function(t){for(var e=0,i=this.p.dt,n=this.os;e<t;)e+i>t&&(i=t-e),n=s.default.rk4(this.dy.bind({g:this.p.g}),0,i,n),e+=i;return n},t.prototype.calcTimeTo=function(t){for(var e=0,i=this.p.dt,n=this.os;Math.abs(n[1]-t)>1e-4;){var o=s.default.rk4(this.dy.bind({g:this.p.g}),0,i,n);o[0]<0&&o[1]<t||o[0]>0&&o[1]>t?i/=2:(n=o,e+=i)}return e},t.prototype.update=function(t){if(this.os=this.integrate(t),this.t+=t,this.t>=this.p.updateInterval){this.t=0;var e=.06*Math.min(this.c.width,this.c.height),i=this.os[1],n=.5*this.c.width,s=.5*this.c.height,a=this.ctx;a.clearRect(0,0,this.c.width,this.c.height),a.beginPath(),a.fillStyle=r.default.color2Rgba(this.p.color,1),a.rect(0,0,this.c.width,this.c.height),a.fill(),a.beginPath(),a.shadowBlur=50,a.fillStyle=r.default.color2Rgba(r.default.inverseColor(this.p.color,.9),Math.abs(this.os[0]/6.36)),a.shadowColor=r.default.color2Rgba(r.default.inverseColor(this.p.color,1),.9),a.shadowOffsetX=0,a.shadowOffsetY=0,a.font="bold "+Math.round(.25*e)+"px Arial",a.textAlign="center",a.textBaseline="middle",a.fillText((0,o.tr)("Loading..."),n,s);var l=2*Math.PI/10;a.shadowColor=r.default.color2Rgba(r.default.inverseColor(this.p.color,1),.7);for(var h=0,c=i,u=.2*e;h<10;++h,u*=.9,c+=l){a.beginPath(),a.fillStyle=r.default.color2Rgba(r.default.inverseColor(this.p.color,(10-h)/10),.7*(10-h)/10);var d=n+e*Math.cos(c),f=s-e*Math.sin(c),p=n+e*Math.cos(c+l),v=s-e*Math.sin(c+l);a.shadowOffsetX=.2*(p-d),a.shadowOffsetY=.2*(v-f),a.arc(d,f,u,0,2*Math.PI,1),a.fill()}this.onChange&&this.onChange(this.c,this.p.color)}},t.prototype.getImage=function(){return this.c},t.prototype.dispose=function(){this.c.width=0,this.c.height=0,delete this.ctx,delete this.c},t.prototype.createSprite=function(t){var e=(0,o.$)('<canvas width="'+this.c.width*t+'" height="'+this.c.height+'"></canvas>')[0],i=e.getContext("2d"),n=this.calcTimeTo(this.os[1]+2*Math.sign(this.os[0])*Math.PI)/(t+1),r=this.p.updateInterval;this.p.updateInterval=0;for(var s=0;s<t;++s)this.update(n),i.drawImage(this.c,s*this.c.width,0);return this.p.updateInterval=r,e},t}();e.default=a},function(t,e,i){"use strict";e.__esModule=!0;var n=(i(0),function(){function t(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.view=e,this.progress=0,this.showProgress=i,this.getLoadingMsg=n||t.defaultLoadingMsg,this.updateView()}return t.defaultLoadingMsg=function(t){return["Please wait... the Application is Loading: ",t,"%"].join("")},t.prototype.dispose=function(){this.showProgress=!1,this.updateView(),delete this.view},t.prototype.setProgress=function(t){this.progress=t,this.updateView()},t.prototype.updateView=function(){if(this.view){this.view.setState("widLoadingProgress",{enable:!0,visible:this.showProgress,active:!1}),this.view.setState("txtLoadingProgress",{value:this.getLoadingMsg(this.progress),visible:!0});var t=this.view.getLinks(),e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}var o=n;this.view.setState(o,{enable:!1,visible:!0,active:!1})}this.view.setState("inpPages",{visible:!0,value:""}),this.view.setState("inpPage",{visible:!0,enable:!1,value:""})}},t}());e.default=n},function(t,e,i){"use strict";e.__esModule=!0;var n,o=i(0),r=function(t){function e(i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n));return s.element=r,s.binds={convert:s.convert.bind(s)},(0,o.$)(s.element).on("mousemove mousedown mouseover mouseout click",s.binds.convert),(0,o.$)(s.doc).on("mouseup",s.binds.convert),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){(0,o.$)(this.element).off("mousemove mousedown mouseover mouseout click",this.binds.convert),(0,o.$)(this.doc).off("mouseup",this.binds.convert)},e}(((n=i(6))&&n.__esModule?n:{default:n}).default);e.default=r},function(t,e,i){"use strict";e.__esModule=!0;var n,o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(0),s=(n=i(3))&&n.__esModule?n:{default:n},a=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.testScale;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.visual=e,this.boundBoxClb=i,this.testScale=n,this.camera=e.camera,this.element=this.visual.element,this.elementSize={w:1,h:1},this.devicePixelRatio=this.visual.wnd.devicePixelRatio||1,this.orbit=e.getOrbit(),this.scale=1,this.eps=1e-4,this.v=new r.THREE.Vector3,this.dv=new r.THREE.Vector2,this.enabled=!1,e.addRenderCallback(this.update.bind(this)),this.os={vx:0,vy:0,x:0,y:0},this.orbit.update(),this.camera.updateMatrixWorld();var o=this.computeClientBoundBox();this.movePan({x:-1.11*o.mid.x,y:-1.11*o.mid.y})}return t.prototype.movePan=function(t){this.orbit.pan(t.x*this.visual.width(),-t.y*this.visual.height())},t.prototype.vToCamera=function(t){return t.project(this.camera),{x:.5*t.x,y:.5*t.y}},t.prototype.computeClientBoundBox=function(){var t=this.boundBoxClb(),e=[t.min.x,t.max.x],i=[0,0],n=[t.min.z,t.max.z],o=[],r={max:{},min:{}},s=e,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var h;if(a){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}var c=h,u=i,d=Array.isArray(u),f=0;for(u=d?u:u[Symbol.iterator]();;){var p;if(d){if(f>=u.length)break;p=u[f++]}else{if((f=u.next()).done)break;p=f.value}var v=p,g=n,m=Array.isArray(g),y=0;for(g=m?g:g[Symbol.iterator]();;){var b;if(m){if(y>=g.length)break;b=g[y++]}else{if((y=g.next()).done)break;b=y.value}var w=b;o.push(this.vToCamera(this.v.set(c,v,w)))}}}return o.sort(function(t,e){return t.x-e.x}),r.min.x=o[0].x,r.max.x=o[o.length-1].x,o.sort(function(t,e){return t.y-e.y}),r.min.y=o[0].y,r.max.y=o[o.length-1].y,r.width=r.max.x-r.min.x,r.height=r.max.y-r.min.y,r.mid={x:.5*(r.max.x+r.min.x),y:.5*(r.max.y+r.min.y)},r},t.prototype.setObject=function(t){this.boundBoxClb=t},t.prototype.testScale=function(){return!0},t.prototype.computeCorr=function(t,e,i){var n=0;return t<1?e>-.5?n=-.5-e:i<.5&&(n=.5-i):e<-.5?n=-.5-e:i>.5&&(n=.5-i),n},t.prototype.getScale=function(){var t=this.computeClientBoundBox(),e=this.elementSize.w/t.width,i=this.elementSize.h/t.height;return 1/Math.min(e,i)},t.prototype.centerView=function(t){var e=this,i=this.computeClientBoundBox(),n=this.elementSize.w/i.width,r=this.elementSize.h/i.height,s=Math.min(n,r);if(this.testScale()&&Math.abs(1/s-this.scale)>this.eps){var a=1/s+.2*(this.scale-1/s);this.orbit.setScale(this.orbit.getScale()/(s*a)),this.orbit.update(),this.camera.updateMatrixWorld(),i=this.computeClientBoundBox(),n=this.elementSize.w/i.width,r=this.elementSize.h/i.height,s=Math.min(n,r)}var l=this.dv;if(s>1-this.eps?l.set(-i.mid.x,-i.mid.y):l.set(this.computeCorr(n,i.min.x,i.max.x),this.computeCorr(r,i.min.y,i.max.y)),Math.sqrt(this.os.vx*this.os.vx+this.os.vy*this.os.vy)>.003||l.length()>.003){var h=1/60,c=0,u=o({},this.os,{x:0,y:0});for(u.tf=function(t,i,n,o){return{x:75*(l.x-n)/Math.pow(e.devicePixelRatio,1),y:75*(l.y-o)/Math.pow(e.devicePixelRatio,1)}};c<t;)c+h>t&&(h=t-c),u=this.integrate(u,h),c+=h;this.movePan(u),this.os=u}},t.prototype.integrate=function(t,e){var i=s.default.rk4(this.dy.bind(t),0,e,[t.vx,t.vy,t.x,t.y]),n=i[0],r=i[1],a=i[2],l=i[3];return o({},t,{vx:n,vy:r,x:a,y:l})},t.prototype.dy=function(t,e){var i=e[0],n=e[1],o=e[2],r=e[3],s=this.tf(i,n,o,r);return[s.x-15*i,s.y-15*n,i,n]},t.prototype.update=function(t){this.enabled&&this.boundBoxClb&&this.centerView(t)},t}();e.default=a},function(t,e,i){"use strict";e.__esModule=!0;var n=i(0),o=function(t){function e(i,o){function r(){return Math.pow(.95,g.zoomSpeed)}function s(t){w.theta-=t}function a(t){g.object instanceof n.THREE.PerspectiveCamera?k/=t:g.object instanceof n.THREE.OrthographicCamera?(g.object.zoom=Math.max(g.minZoom,Math.min(g.maxZoom,g.object.zoom*t)),g.object.updateProjectionMatrix(),C=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type-dolly/zoom disabled."),g.enableZoom=!1)}function l(t){g.object instanceof n.THREE.PerspectiveCamera?k*=t:g.object instanceof n.THREE.OrthographicCamera?(g.object.zoom=Math.max(g.minZoom,Math.min(g.maxZoom,g.object.zoom/t)),g.object.updateProjectionMatrix(),C=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type-dolly/zoom disabled."),g.enableZoom=!1)}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var h,c,u,d,f,p=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));p.object=i,p.domElement=o||document.body,p.enabled=!0,p.target=new n.THREE.Vector3,p.minDistance=0,p.maxDistance=1/0,p.minZoom=0,p.maxZoom=1/0,p.minPolarAngle=0,p.maxPolarAngle=Math.PI,p.minAzimuthAngle=-1/0,p.maxAzimuthAngle=1/0,p.enableDamping=!1,p.dampingFactor=.25,p.enableZoom=!0,p.zoomSpeed=1,p.enableRotate=!0,p.rotateSpeed=1,p.enablePan=!0,p.autoRotate=!1,p.autoRotateSpeed=2,p.target0=p.target.clone(),p.position0=p.object.position.clone(),p.zoom0=p.object.zoom,p.getPolarAngle=function(){return b.phi},p.getAzimuthalAngle=function(){return b.theta},p.reset=function(){g.target.copy(g.target0),g.object.position.copy(g.position0),g.object.zoom=g.zoom0,g.object.updateProjectionMatrix(),g.dispatchEvent(m),g.update()},p.zoomOut=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.zoomSpeed,e=this.zoomSpeed;this.zoomSpeed=t,a(r()),this.zoomSpeed=e},p.zoomIn=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.zoomSpeed,e=this.zoomSpeed;this.zoomSpeed=t,l(r()),this.zoomSpeed=e},p.getScale=function(){return k},p.setScale=function(t){k=t},p.update=(h=new n.THREE.Vector3,c=(new n.THREE.Quaternion).setFromUnitVectors(i.up,new n.THREE.Vector3(0,1,0)),u=c.clone().inverse(),d=new n.THREE.Vector3,f=new n.THREE.Quaternion,function(){var t=g.object.position;return h.copy(t).sub(g.target),h.applyQuaternion(c),b.setFromVector3(h),g.autoRotate&&s(2*Math.PI/60/60*g.autoRotateSpeed),b.theta+=w.theta,b.phi+=w.phi,b.theta=Math.max(g.minAzimuthAngle,Math.min(g.maxAzimuthAngle,b.theta)),b.phi=Math.max(g.minPolarAngle,Math.min(g.maxPolarAngle,b.phi)),b.makeSafe(),b.radius*=k,b.radius=Math.max(g.minDistance,Math.min(g.maxDistance,b.radius)),g.target.add(x),h.setFromSpherical(b),h.applyQuaternion(u),t.copy(g.target).add(h),g.object.lookAt(g.target),!0===g.enableDamping?(w.theta*=1-g.dampingFactor,w.phi*=1-g.dampingFactor):w.set(0,0,0),k=1,x.set(0,0,0),!!(C||d.distanceToSquared(g.object.position)>y||8*(1-f.dot(g.object.quaternion))>y)&&(g.dispatchEvent(m),d.copy(g.object.position),f.copy(g.object.quaternion),C=!1,!0)}),p.dispose=function(){};var v,g=p,m={type:"change"},y=1e-6,b=new n.THREE.Spherical,w=new n.THREE.Spherical,k=1,x=new n.THREE.Vector3,C=!1,P=(v=new n.THREE.Vector3,function(t,e){v.setFromMatrixColumn(e,0),v.multiplyScalar(-t),x.add(v)}),S=function(){var t=new n.THREE.Vector3;return function(e,i){t.setFromMatrixColumn(i,1),t.multiplyScalar(e),x.add(t)}}();return g.pan=function(){var t=new n.THREE.Vector3;return function(e,i){var o=g.domElement;if(g.object instanceof n.THREE.PerspectiveCamera){var r=g.object.position;t.copy(r).sub(g.target);var s=t.length();s*=Math.tan(g.object.fov/2*Math.PI/180),P(2*e*s/o.clientHeight,g.object.matrix),S(2*i*s/o.clientHeight,g.object.matrix)}else g.object instanceof n.THREE.OrthographicCamera?(P(e*(g.object.right-g.object.left)/g.object.zoom/o.clientWidth,g.object.matrix),S(i*(g.object.top-g.object.bottom)/g.object.zoom/o.clientHeight,g.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type-pan disabled."),g.enablePan=!1)}}(),p.actions={rotate:function(t,e){if(g.enabled&&g.enableRotate&&"move"===e.state){var i=g.domElement;s(2*Math.PI*e.dx/i.clientWidth*g.rotateSpeed),n=2*Math.PI*e.dy/i.clientHeight*g.rotateSpeed,w.phi-=n,g.update()}var n},pan:function(t,e){g.enabled&&g.enablePan&&"move"===e.state&&(g.pan(e.dx,e.dy),g.update())},offsetDolly:function(t,e){g.enabled&&g.enableZoom&&"move"===e.state&&(e.dy>0?a(r()):e.dy<0&&l(r()),g.update())},wheelDolly:function(t){g.enabled&&g.enableZoom&&(t.deltaY>0?l(r()):t.deltaY<0&&a(r()),g.update())}},p.update(),p}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n.THREE.EventDispatcher);e.default=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=i(0),r=n(i(5)),s=n(i(18)),a=n(i(2)),l=n(i(16)),h=n(i(69)),c=n(i(17)),u=function(t){function e(i,n,o,r,s,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o,r));return l.query="",l.n=a,l.pdf=s,l.v={x:0,y:0,z:0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},transform:function(t){var e=t.m[0][0]*this.x+t.m[1][0]*this.y+t.m[2][0]*this.z,i=t.m[0][1]*this.x+t.m[1][1]*this.y+t.m[2][1]*this.z,n=t.m[0][2]*this.x+t.m[0][2]*this.y+t.m[2][0]*this.z;return this.x=e,this.y=i,this.z=n,this}},l.m={m:[[1,0,0],[0,1,0],[0,0,1]],set:function(t,e,i,n,o,r,s,a,l){return this.m=[[t,e,i],[n,o,r],[s,a,l]],this}},l.startRender=function(){l.pdf.getHandler(l.render.bind(l))},Promise.resolve().then(function(){return l.pdf.getHandler(l.init.bind(l))}),l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setQuery=function(t){this.query=t.trim(),this.textContent&&this.setHits(this.textContent)},e.prototype.rectSize=function(t){return{width:t[2]-t[0],height:t[3]-t[1]}},e.prototype.createPoly=function(t,e,i){var n=[],o=this.v;return o.set(e.x,e.y,1).transform(t),n.push({x:o.x,y:o.y}),o.set(e.x,e.y+i.height,1).transform(t),n.push({x:o.x,y:o.y}),o.set(e.x+i.width,e.y+i.height,1).transform(t),n.push({x:o.x,y:o.y}),o.set(e.x+i.width,e.y,1).transform(t),n.push({x:o.x,y:o.y}),n},e.prototype.getSimulatedDoc=function(){return this},e.prototype.simulate=function(t,e,i,n){this.eventConverter&&this.eventConverter.convert(t,{doc:e,x:i,y:n})},e.prototype.setAnnotations=function(t){var e=this,i=this.viewport.transform,n=[];this.m.set(i[0],i[1],0,i[2],i[3],0,i[4],i[5],1);var o=t,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var c=a;if("Link"===c.subtype){var u=c.rect,d={x:u[0],y:u[1]},f=this.rectSize(u),p=new h.default(this.createPoly(this.m,d,f).map(function(t){return{x:t.x/e.viewport.width,y:1-t.y/e.viewport.height}}));p.anno=c,p.callback=this.annoClb.bind(this),n.push(p)}}if(n.length){this.eventConverter=new l.default(this.wnd,this.doc,h.default.test,this.getSimulatedDoc());var v=n,g=Array.isArray(v),m=0;for(v=g?v:v[Symbol.iterator]();;){var y;if(g){if(m>=v.length)break;y=v[m++]}else{if((m=v.next()).done)break;y=m.value}var b=y;this.eventConverter.addCustom(b)}}},e.prototype.setHits=function(t){this.textContent=t,""!==this.query&&(this.finder=new c.default(t.items.map(function(t){return t.str}),this.query,{contexts:!1}))},e.prototype.renderHits=function(){var t=this;if(this.finder){var e=(this.page.view,(0,o.$)('<div style="position: absolute; visibility: hidden;"></div>').appendTo("body")),i=e[0],n=e.offset().left,r=this.finder.getHits(),s=Array.isArray(r),a=0;for(r=s?r:r[Symbol.iterator]();;){var l;if(s){if(a>=r.length)break;l=r[a++]}else{if((a=r.next()).done)break;l=a.value}var h=l,c=this.textContent.items[h.index],u=PDFJS.Util.transform(this.viewport.transform,c.transform),d=this.textContent.styles[c.fontName],f=Math.atan2(u[1],u[0])+(d.vertical?Math.PI/2:0),p=Math.sqrt(u[2]*u[2]+u[3]*u[3]),v=d.ascent?d.ascent*p:d.descent?(1+d.descent)*p:p;e.html(c.str.substr(0,h.offset)+"<span>"+c.str.substr(h.offset,h.length)+"</span>"+c.str.substr(h.offset+h.length)),i.style.fontSize=p+"px",i.style.fontFamily=d.fontFamily;var g=e.find("span"),m=d.vertical?c.height*this.viewport.scale:c.width*this.viewport.scale,y=e.width(),b=(g.offset().left-n)/y;this.m.set(1,0,0,0,1,0,u[4]+v*Math.sin(f),u[5]-v*Math.cos(f),1);var w=this.createPoly(this.m,{x:b*m,y:0},{width:m*g.width()/y,height:g.height()});w=w.map(function(e){return{x:e.x/t.viewport.width,y:1-e.y/t.viewport.height}}),this.renderHit(w)}e.remove()}},e.prototype.annoClb=function(t,e){this.context.dispatchEvent&&this.context.dispatchEvent({type:"pdfAnnotation",event:t,annotation:e.target.anno})},e.prototype.calcViewport=function(){var t=a.default.calcScale(this.size.width,this.size.height,this.resW,this.resH);(!this.viewport||Math.abs(this.viewport.scale-t)>1e-4)&&(this.viewport=this.page.getViewport(t),"full"!==this.type&&("right"===this.type&&(this.viewport.offsetX+=.5*this.viewport.width,this.viewport.transform[4]-=.5*this.viewport.width),this.viewport.width/=2),this.resW=this.width=this.viewport.width,this.resH=this.height=this.viewport.height)},e.prototype.init=function(){var t=this;this.type=this.pdf.getPageType(this.n),this.pdf.getPage(this.n).then(function(e){t.page=e,t.size=s.default.getPageSize(e),"full"!==t.type&&(t.size.width/=2),e.getAnnotations().then(t.setAnnotations.bind(t)),e.getTextContent().then(t.setHits.bind(t)),t.calcViewport(),t.finishLoad()}).catch(function(e){console.error("Cannot load PDF page: "+(t.n+1)),t.finishLoad()})},e.prototype.setResolution=function(e){t.prototype.setResolution.call(this,e),this.page&&this.calcViewport()},e.prototype.render=function(t){var e=this;this.page?this.page.render({canvasContext:this.pushCtx(),viewport:this.viewport}).then(function(){e.renderHits(),e.popCtx(),e.finishRender()}):(this.renderBlankPage(),this.finishRender())},e}(r.default);e.default=u},function(t,e,i){"use strict";e.__esModule=!0;var n=i(0),o=function(){function t(e,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.container=e,this.pages=i,this.prevResults=[],e.html('\n      <div class="search">\n        <div class="query">\n          <input class="inpQuery" type="text" maxlength="30" value="" />\n        </div>\n        <div class="results">\n        </div>\n        <div class="status">\n\n        </div>\n      </div>\n    '),this.query=e.find(".query input"),this.results=e.find(".results"),this.status=e.find(".status"),this.binds={navigate:this.navigate.bind(this),doQuery:this.doQuery.bind(this)},this.query.on("keydown",this.binds.doQuery),this.results.on("click",this.binds.navigate)}return t.prototype.dispose=function(){this.results.off("click",this.binds.navigate),this.query.off("keydown",this.binds.doQuery)},t.prototype.navigate=function(t){if(t.preventDefault(),void 0!==this.onNavigate){var e=(0,n.$)(t.target);if(!e.hasClass("result")){var i=e.find(".result");if(i.length)e=i;else for(;e.length&&!e.hasClass("result");)e=(0,n.$)(e[0].parentNode)}var o=e.attr("data");void 0!==o&&this.onNavigate(parseInt(o))}},t.prototype.doQuery=function(){var t=this;if(this.onQuery){var e=this.queryStamp=Date.now();setTimeout(function(){e===t.queryStamp&&t.onQuery(t.query[0].value.trim())},1e3)}},t.prototype.setResults=function(t,e){this.prevResults.length&&t[0]!==this.prevResults[0]&&(this.prevResults=[],this.results.html(""));for(var i=[],o=this.prevResults.length;o<t.length;++o){var r=t[o];i.push('<div class="result" data="'+r.page+'">'),i.push('<a href="#">'),i.push("<div>"+r.contexts.join("</div><div>")+"</div>"),i.push("</a>"),i.push("</div>")}(0,n.$)(i.join("")).appendTo(this.results),this.prevResults=[].concat(t),void 0===e?this.status.html(""):this.status.html(e+" of "+this.pages)},t}();e.default=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=i(0),r=n(i(5)),s=n(i(4)),a=function(t){function e(i,n,r,a,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,r,a));return h.binds={},h.image=new Image,h.image.crossOrigin="Anonymous",h.binds.imageLoad=function(){h.width=h.image.width,h.height=h.image.height,h.startRender=function(){h.renderImage(h.image),h.finishRender()},h.finishLoad()},h.binds.imageError=function(){h.startRender=function(){h.renderNotFoundPage(),h.finishRender()},h.finishLoad()},(0,o.$)(h.image).on("load",h.binds.imageLoad).on("error",h.binds.imageError),h.image.src=s.default.normalizeUrl(l),h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){(0,o.$)(this.image).off("load",this.binds.imageLoad).off("error",this.binds.imageError),this.image.src="",delete this.image,t.prototype.dispose.call(this)},e}(r.default);e.default=a},function(t,e,i){"use strict";e.__esModule=!0;var n=i(0),o=function(){function t(e,i,o,r,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var a=new n.THREE.Texture;a.minFilter=n.THREE.LinearFilter,a.image=e,a.needsUpdate=!0,this.texture=a,this.tilesHorizontal=i,this.tilesVertical=o,this.numberOfTiles=r,a.repeat.set(1/this.tilesHorizontal,1/this.tilesVertical),this.tileDisplayDuration=s,this.currentDisplayTime=0,this.currentTile=0}return t.prototype.update=function(t){for(this.currentDisplayTime+=t;this.currentDisplayTime>this.tileDisplayDuration;){this.currentDisplayTime-=this.tileDisplayDuration,++this.currentTile,this.currentTile==this.numberOfTiles&&(this.currentTile=0);var e=this.currentTile%this.tilesHorizontal;this.texture.offset.x=e/this.tilesHorizontal;var i=Math.floor(this.currentTile/this.tilesHorizontal);this.texture.offset.y=i/this.tilesVertical}},t.prototype.dispose=function(){var t=this.texture.image;t.height=t.width=0,this.texture.dispose()},t}();e.default=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=i(0),r=n(i(4)),s=n(i(54)),a=n(i(19)),l=function(t){function e(i,n,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o.element));return r.default.extends(l,new a.default(o,s)),l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getCallback=function(t){return t.object.userData.mouseCallback},e.prototype.setCoordsFromEvent=function(t){var e=(0,o.$)(this.element),i=e.offset();return this.coords.x=(t.pageX-i.left)/e.width()*2-1,this.coords.y=-(t.pageY-i.top)/e.height()*2+1,this.coords},e}(s.default);e.default=l},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=i(0),r=n(i(4)),s=n(i(64)),a=n(i(19)),l=function(t){function e(i,n,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o.element));return r.default.extends(l,new a.default(o,s)),l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getCallback=function(t){return t.object.userData.touchCallback},e.prototype.setCoordsFromEvent=function(t){var e=(0,o.$)(this.element),i=e.offset(),n=t.touches||t.originalEvent.touches,r=n.length?n[0]:(this.lastTouches||[{pageX:0,pageY:0}])[0],s=r.pageX,a=r.pageY;return this.lastTouches=n.length?n:this.lastTouches,this.coords.x=(s-i.left)/e.width()*2-1,this.coords.y=-(a-i.top)/e.height()*2+1,this.coords},e}(s.default);e.default=l},function(t,e,i){"use strict";e.__esModule=!0;var n,o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(0),s=(n=i(8))&&n.__esModule?n:{default:n},a=function(){function t(e,i,n,a){var l=this,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{kWtoH:210/297};(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.container=i,this.p=h,this.thumbnailsClb=n,this.size=a,this.canvas=(0,r.$)("<canvas>")[0],this.imageFactory=new s.default(o({},e,{renderCanvas:this.canvas,renderCanvasCtx:this.canvas.getContext("2d")})),this.thumbnails=[];for(var c=0;c<a;++c){var u=this.thumbnailsClb(c);this.thumbnails.push(o({},u,{index:c,loaded:"thumbnail-image"===u.type,heading:null,thumbnail:null,title:u.title||c}))}this.binds={update:this.update.bind(this),navigate:function(t){if(t.preventDefault(),l.onNavigate){for(var e=t.target;e&&!e.dataThumbnail;)e=e.parentNode;l.onNavigate(e.dataThumbnail.index)}}},this.container.on("scroll",this.binds.update)}return t.prototype.getSize=function(){return this.size},t.prototype.setEnable=function(t){this.enable=t,this.update()},t.prototype.dispose=function(){this.container.find("a").off("click",this.binds.navigate),this.container.off("scroll",this.binds.update),this.container.html(""),this.canvas.height=this.canvas.width=0,delete this.canvas},t.prototype.load=function(t){var e=this;this.loading=!0;var i=this.imageFactory.build(t,void 0===t.number?t.index:t.number,300*this.p.kWtoH,300);i.onChange=function(n){e.setImage(t,n.toDataURL("image/png")),t.loaded=!0,i.dispose(),e.loading=!1,Promise.resolve().then(function(){return e.update()})}},t.prototype.getActive=function(){var t=this.container.scrollTop(),e=t+this.container.height(),i=[],n=this.thumbnails,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if(o){if(r>=n.length)break;s=n[r++]}else{if((r=n.next()).done)break;s=r.value}var a=s;Math.max(a.first,t)<Math.min(a.last,e)&&i.push(a)}return i},t.prototype.update=function(){if(!this.loading&&this.canvas&&this.enable){this.built||this.render();var t=this.getActive(),e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}var o=n;if(!o.loaded){this.load(o);break}}}},t.prototype.setImage=function(t,e){t.img=e,t.thumbnail.css("background-image",["url('",e,"')"].join("")),t.thumbnail.removeClass("loading")},t.prototype.render=function(){for(var t=['<div class="thumbnails">'],e=0;e<this.size;++e)t.push(['<div class="item"><a href="#"><div class="thumbnail loading"></div></a><div class="heading"><a href="#" title="',e+1,'">',e+1,"</a></div></div>"].join(""));t.push("</div>"),this.container.append(t.join(""));for(var i=this.container.find(".item"),n=this.container.find(".thumbnails").offset().top,o=0;o<i.length;++o){var s=(0,r.$)(i[o]);this.thumbnails[o].heading=s.find(".heading"),this.thumbnails[o].thumbnail=s.find(".thumbnail"),this.thumbnails[o].first=s.offset().top-n,this.thumbnails[o].last=this.thumbnails[o].first+s.height(),this.thumbnails[o].loaded&&this.setImage(this.thumbnails[o],this.thumbnails[o].src);for(var a=s.find("a"),l=0;l<a.length;++l)a[l].dataThumbnail=this.thumbnails[o]}this.container.find("a").on("click",this.binds.navigate),this.built=!0},t}();e.default=a},function(t,e,i){"use strict";e.__esModule=!0;var n,o=i(0),r=function(t){function e(i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n));return s.element=r,s.binds={convert:s.convert.bind(s)},(0,o.$)(s.element).on("touchstart touchmove",s.binds.convert),(0,o.$)(s.doc).on("touchend",s.binds.convert),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){(0,o.$)(this.element).off("touchstart touchmove",this.binds.convert),(0,o.$)(this.doc).off("touchend",this.binds.convert)},e}(((n=i(6))&&n.__esModule?n:{default:n}).default);e.default=r},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},_libs=__webpack_require__(0),View=function(){function View(parentContainer,onLoad){var _this3=this,template=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,View),this.pendings={},this.binds={onResize:this.onResize.bind(this)},this.parentContainer=(0,_libs.$)(parentContainer),this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,this.parentContainer.html('<iframe style="border: 0;'+(this.isIOS?"":" width: 100%; height: 100%")+'" scrolling="no"></iframe>'),this.frame=this.parentContainer.find("iframe")[0],this.frame.contentWindow.stop&&this.frame.contentWindow.stop(),this.isIOS&&((0,_libs.$)(this.parentContainer[0].ownerDocument.defaultView).on("resize",this.binds.onResize),this.onResize(),setTimeout(this.checkIframeSize.bind(this),250)),this.container=(0,_libs.$)(this.frame.contentDocument.body),this.container.css("margin","0"),this.head=(0,_libs.$)(this.frame.contentDocument.head),this.onLoad=onLoad,this.handlers=[];var script=template.html?template.script:this.getTemplate().script,urls={styles:template.styles||this.getTemplate().styles,html:[template.html||this.getTemplate().html],script:script?[script]:[]},files={},links=template.links||this.getTemplate().links;this.loadFiles(urls,files).then(function(){for(var _loop4=function(){if(_isArray7){if(_i7>=_iterator7.length)return"break";_ref7=_iterator7[_i7++]}else{if((_i7=_iterator7.next()).done)return"break";_ref7=_i7.value}var t=_ref7,e=t.data,i=t.url;e=e.replace(/url\(['"](.*?)["']\)/g,function(t,e){return["url(",_this3.urlResolver(i,e),")"].join("")}),(0,_libs.$)('<style type="text/css">'+e+"</style>").appendTo(_this3.head)},_iterator7=files.styles,_isArray7=Array.isArray(_iterator7),_i7=0,_iterator7=_isArray7?_iterator7:_iterator7[Symbol.iterator]();;){var _ref7,_ret4=_loop4();if("break"===_ret4)break}_this3.container.html(_this3.translate(files.html[0].data)),_this3.jLinks=[];for(var _iterator8=links,_isArray8=Array.isArray(_iterator8),_i8=0,_iterator8=_isArray8?_iterator8:_iterator8[Symbol.iterator]();;){var _ref8;if(_isArray8){if(_i8>=_iterator8.length)break;_ref8=_iterator8[_i8++]}else{if(_i8=_iterator8.next(),_i8.done)break;_ref8=_i8.value}var _link=_ref8;_this3.jLinks.push((0,_libs.$)(["<link ",_this3.objToAttrsStr(_link),">"].join("")).appendTo(_this3.head))}if(files.script[0]){var init=eval(files.script[0].data);_this3.templateObject=init(_this3.container)}else _this3.templateObject={};_this3.linkControls={};for(var _iterator9=_this3.getLinks(),_isArray9=Array.isArray(_iterator9),_i9=0,_iterator9=_isArray9?_iterator9:_iterator9[Symbol.iterator]();;){var _ref9;if(_isArray9){if(_i9>=_iterator9.length)break;_ref9=_iterator9[_i9++]}else{if(_i9=_iterator9.next(),_i9.done)break;_ref9=_i9.value}var id=_ref9;_this3.linkControls[id]=_this3.container.find("."+id),_this3.binds[id]=View.handleLinkEvent.bind({getHandlers:_this3.getHandlers.bind(_this3),id:id,ctrl:_this3.linkControls[id]}),_this3.linkControls[id].on("click",_this3.binds[id])}_this3.widgetControls={};for(var _iterator10=_this3.getWidgets(),_isArray10=Array.isArray(_iterator10),_i10=0,_iterator10=_isArray10?_iterator10:_iterator10[Symbol.iterator]();;){var _ref10;if(_isArray10){if(_i10>=_iterator10.length)break;_ref10=_iterator10[_i10++]}else{if(_i10=_iterator10.next(),_i10.done)break;_ref10=_i10.value}var _id=_ref10;_this3.widgetControls[_id]=_this3.container.find("."+_id)}_this3.inputControls={};for(var _iterator11=_this3.getInputs(),_isArray11=Array.isArray(_iterator11),_i11=0,_iterator11=_isArray11?_iterator11:_iterator11[Symbol.iterator]();;){var _ref11;if(_isArray11){if(_i11>=_iterator11.length)break;_ref11=_iterator11[_i11++]}else{if(_i11=_iterator11.next(),_i11.done)break;_ref11=_i11.value}var _id2=_ref11;_this3.inputControls[_id2]=_this3.container.find("."+_id2),_this3.binds[_id2]=View.handleInputEvent.bind({getHandlers:_this3.getHandlers.bind(_this3),id:_id2,ctrl:_this3.inputControls[_id2]}),_this3.inputControls[_id2].on("keyup",_this3.binds[_id2])}_this3.formControls={};for(var _iterator12=_this3.getForms(),_isArray12=Array.isArray(_iterator12),_i12=0,_iterator12=_isArray12?_iterator12:_iterator12[Symbol.iterator]();;){var _ref12;if(_isArray12){if(_i12>=_iterator12.length)break;_ref12=_iterator12[_i12++]}else{if(_i12=_iterator12.next(),_i12.done)break;_ref12=_i12.value}var _id3=_ref12;_this3.formControls[_id3]=_this3.container.find("."+_id3),_this3.binds[_id3]=View.handleFormEvent.bind({getHandlers:_this3.getHandlers.bind(_this3),id:_id3,ctrl:_this3.formControls[_id3]}),_this3.formControls[_id3].on("submit",_this3.binds[_id3])}_this3.textControls={};for(var _iterator13=_this3.getTexts(),_isArray13=Array.isArray(_iterator13),_i13=0,_iterator13=_isArray13?_iterator13:_iterator13[Symbol.iterator]();;){var _ref13;if(_isArray13){if(_i13>=_iterator13.length)break;_ref13=_iterator13[_i13++]}else{if(_i13=_iterator13.next(),_i13.done)break;_ref13=_i13.value}var _id4=_ref13;_this3.textControls[_id4]=_this3.container.find("."+_id4)}_this3.stateSetters=[{map:_this3.linkControls,setter:_this3.setLinkControlState.bind(_this3)},{map:_this3.widgetControls,setter:_this3.setWidgetControlState.bind(_this3)},{map:_this3.inputControls,setter:_this3.setInputControlState.bind(_this3)},{map:_this3.textControls,setter:_this3.setTextControlState.bind(_this3)}],_this3.initView(),_this3.onLoad&&_this3.onLoad(),_this3.fireLinksOnLoadEvent()}).catch(function(t){return console.error(t)})}return View.classProperty=function(t,e,i){i?t.addClass(e):t.removeClass(e)},View.attributeProperty=function(t,e,i){i?t.attr(e,i):t.removeAttr(e)},View.callHandlers=function(t,e,i,n){var o=t,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var l=a;l[e]?l[e](i,n):l.handleDefault&&l.handleDefault(e,i,n)}},View.handleEvent=function(t,e,i,n){View.callHandlers(e(t),t,i,n)},View.handleLinkEvent=function(t){t.preventDefault(),this.ctrl.hasClass("disabled")||View.handleEvent(this.id,this.getHandlers,t)},View.handleInputEvent=function(t){View.handleEvent(this.id,this.getHandlers,t,t.target.value)},View.handleFormEvent=function(t){t.preventDefault(),View.handleEvent(this.id,this.getHandlers,t)},View.prototype.getLinks=function(){return null},View.prototype.getWidgets=function(){return null},View.prototype.getInputs=function(){return null},View.prototype.getTexts=function(){return null},View.prototype.getTemplate=function(){return{}},View.prototype.getHandlers=function(t){return this.handlers},View.prototype.callLater=function(t,e,i,n,o){var r=this;this.pendings[e]={timestamp:(new Date).getTime()},setTimeout(function(){var s=(new Date).getTime(),a=r.pendings[e];a&&s-a.timestamp>=o&&(View.callHandlers(t,e,i,n),delete r.pendings[e])},o)},View.prototype.loadFiles=function(t,e){var i=[],n=Object.keys(t),o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var s;if("break"===function(){if(o){if(r>=n.length)return"break";s=n[r++]}else{if((r=n.next()).done)return"break";s=r.value}var a=s;e[a]=[];var l=t[a],h=Array.isArray(l),c=0;for(l=h?l:l[Symbol.iterator]();;){var u;if("break"===function(){if(h){if(c>=l.length)return"break";u=l[c++]}else{if((c=l.next()).done)return"break";u=c.value}var t=u;i.push(new Promise(function(i,n){_libs.$.get(t,function(n){e[a].push({url:t,data:n}),i()}).fail(function(t){n(t)})}))}())break}}())break}return Promise.all(i)},View.prototype.urlResolver=function(t,e){if("/"!==(e=e.replace(/\\/g,"/")).charAt(0)){var i=(t=t.replace(/\\/g,"/")).lastIndexOf("/"),n=(e=(~i?t.substr(0,i+1):"")+e).split("/");e=[];var o=n,r=Array.isArray(o),s=0;for(o=r?o:o[Symbol.iterator]();;){var a;if(r){if(s>=o.length)break;a=o[s++]}else{if((s=o.next()).done)break;a=s.value}var l=a;"."===l||(".."===l?!e.length||1===e.length&&""===e[0]||e.pop():e.push(l))}e=e.join("/")}return e},View.prototype.objToAttrsStr=function(t){var e=[],i=Object.keys(t),n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;e.push([s,'="',t[s],'"'].join(""))}return e.join(" ")},View.prototype.checkIframeSize=function(){this.frame&&((Math.abs(this.frame.width-this.parentContainer.width())>1||Math.abs(this.frame.height-this.parentContainer.height())>1)&&this.onResize(),setTimeout(this.checkIframeSize.bind(this),250))},View.prototype.onResize=function(){this.frame.width=this.parentContainer.width(),this.frame.height=this.parentContainer.height()},View.prototype.translate=function(t){return t.replace(/<\$tr>(.*)<\/\$tr>/gi,function(t,e){return(0,_libs.tr)(e)})},View.prototype.fireLinksOnLoadEvent=function(){var t=this;if(this.templateObject&&this.templateObject.linkLoaded){var e=this.jLinks,i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var o;if("break"===function(){if(i){if(n>=e.length)return"break";o=e[n++]}else{if((n=e.next()).done)return"break";o=n.value}var r=o[0],s=new Image;s.onerror=function(){return t.templateObject.linkLoaded(r)},s.src=r.href}())break}}},View.prototype.dispose=function(){delete this.textControls;var t=this.getLinks(),e=Array.isArray(t),i=0;for(t=e?t:t[Symbol.iterator]();;){var n;if(e){if(i>=t.length)break;n=t[i++]}else{if((i=t.next()).done)break;n=i.value}var o=n;this.linkControls[o].off("click",this.binds[o])}delete this.linkControls,delete this.widgetControls;var r=this.getInputs(),s=Array.isArray(r),a=0;for(r=s?r:r[Symbol.iterator]();;){var l;if(s){if(a>=r.length)break;l=r[a++]}else{if((a=r.next()).done)break;l=a.value}var h=l;this.inputControls[h].off("keyup",this.binds[h])}delete this.inputControls;var c=this.getForms(),u=Array.isArray(c),d=0;for(c=u?c:c[Symbol.iterator]();;){var f;if(u){if(d>=c.length)break;f=c[d++]}else{if((d=c.next()).done)break;f=d.value}var p=f;this.formControls[p].off("submit",this.binds[p])}delete this.formControls,!this.templateObject.dispose||this.templateObject.dispose(),delete this.templateObject,this.isIOS&&(0,_libs.$)(this.parentContainer[0].ownerDocument.defaultView).off("resize",this.binds.onResize),this.parentContainer.html(""),delete this.frame},View.prototype.getContainer=function(){return this.container[0]},View.prototype.getParentContainer=function(){return this.parentContainer[0]},View.prototype.addHandler=function(t){this.handlers.push(t)},View.prototype.initView=function(){},View.setControlState=function(t,e,i,n){if(t){var o=_extends({},e,i);for(var r in o)o.hasOwnProperty(r)&&n[r]&&n[r](t,o[r])}},View.prototype.setLinkControlState=function(t,e){View.setControlState(this.linkControls[t],{visible:!0,active:!1,enable:!0},e,View.linkStateHandlers)},View.prototype.setWidgetControlState=function(t,e){View.setControlState(this.widgetControls[t],{visible:!0,active:!1,enable:!0},e,View.widgetStateHandlers)},View.prototype.setInputControlState=function(t,e){View.setControlState(this.inputControls[t],{visible:!0,enable:!0,value:""},e,View.inputStateHandlers)},View.prototype.setTextControlState=function(t,e){View.setControlState(this.textControls[t],{visible:!0,value:""},e,View.textStateHandlers)},View.prototype.onItemStateChanged=function(){},View.prototype.setState=function(t,e){var i=this.stateSetters,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var s=r;if(s.map[t]){s.setter(t,e),this.onItemStateChanged(t,e);break}}},View}();View.linkStateHandlers={visible:function(t,e){return View.classProperty(t,"hidden",!e)},active:function(t,e){return View.classProperty(t,"active",e)},enable:function(t,e){return View.classProperty(t,"disabled",!e)}},View.widgetStateHandlers={visible:function(t,e){return View.classProperty(t,"hidden",!e)},active:function(t,e){return View.classProperty(t,"active",e)},enable:function(t,e){return View.classProperty(t,"disabled",!e)}},View.inputStateHandlers={visible:function(t,e){return View.classProperty(t,"hidden",!e)},value:function(t,e){return t[0].value=e},enable:function(t,e){return View.attributeProperty(t,"disabled",!e)}},View.textStateHandlers={visible:function(t,e){return View.classProperty(t,"hidden",!e)},value:function(t,e){return t.text(e)}},exports.default=View},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r=i(0),s=n(i(56)),a=n(i(61)),l=n(i(62)),h=n(i(48)),c=n(i(12)),u=function(t){function e(i,n,u){var d=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var f=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));f.wnd=i,f.doc=n,f.jContainer=u,f.renderCallbacks=[],f.clock=new r.THREE.Clock,f.raycaster=new r.THREE.Raycaster,f.scene=new r.THREE.Scene,f.cssScene=new r.THREE.Scene,f.camera=new r.THREE.PerspectiveCamera(30,f.width()/f.height(),.2,2e3),f.camera.position.x=0,f.camera.position.y=27.5,f.camera.position.z=0,f.renderer=new r.THREE.WebGLRenderer({alpha:!0,antialias:!0}),f.renderer.setClearColor(0,0),f.renderer.setPixelRatio(f.wnd.devicePixelRatio),f.renderer.setSize(f.width(),f.height()),f.jContainer.append(f.renderer.domElement),f.cssRenderer=new c.default,f.cssRenderer.setSize(f.width(),f.height()),(0,r.$)(f.cssRenderer.domElement).css({position:"absolute",top:0,margin:0,padding:0}),f.jContainer.append(f.cssRenderer.domElement),f.element=f.cssRenderer.domElement,f.controls=new s.default(f.camera,f.element),f.controls.target.y=.5;var p=(0,r.$)(f.cssRenderer.domElement).find("div"),v=new r.THREE.Vector3;f.controls.addEventListener("change",function(){f.camera.getWorldDirection(v),p.css("display",v.y-f.camera.position.y>0?"none":"block")}),f.textureLoader=new r.THREE.TextureLoader,f.scene.add(new r.THREE.AmbientLight(13684944)),f.light=new r.THREE.DirectionalLight(4210752,1),f.light.position.set(0,30,0),f.light.castShadow=!1,f.scene.add(f.light),d&&f.scene.add(new r.THREE.AxisHelper(5)),f.binds={onWindowResize:f.onWindowResize.bind(f),animate:f.animate.bind(f)},(0,r.$)(f.wnd).on("resize",f.binds.onWindowResize),f.mouseEvents=new a.default(f.wnd,f.doc,f),f.touchEvents=new l.default(f.wnd,f.doc,f);var g={type:"mousemove"};return f.mouseEvents.filter=function(t,e){var i=function(t,e){return t===e||r.$.contains(t,e)};return"mousemove"===e.type&&(g.pageX=e.pageX,g.pageY=e.pageY),e.relatedTarget&&~["mouseenter","mouseover","mouseleave","mouseout"].indexOf(e.type)&&i(t,e.target)&&i(t,e.relatedTarget)?o({},e,g):e},f.drag=new h.default(f.wnd,f.doc,f),f.onWindowResize(),f.animate(),f}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){delete this.binds.animate,(0,r.$)(this.wnd).off("resize",this.binds.onWindowResize),this.mouseEvents.dispose(),this.touchEvents.dispose(),this.drag.dispose(),this.controls.dispose()},e.prototype.width=function(){return this.jContainer.width()},e.prototype.height=function(){return this.jContainer.height()},e.prototype.setExtraLighting=function(t){this.light.intensity=t},e.prototype.getOrbit=function(){return this.controls},e.prototype.setControlsState=function(t){this.controls.enabled=t},e.prototype.getControlsState=function(){return this.controls.enabled},e.prototype.onWindowResize=function(){var t,e=this;if(this.width()>1&&this.height()>1){var i=function(t){t.setSize(e.width(),e.height())};(t=this.camera).aspect=e.width()/e.height(),t.updateProjectionMatrix(),i(this.renderer),i(this.cssRenderer),this.dispatchEvent({type:"resize"})}else setTimeout(function(){e.onWindowResize()},250)},e.prototype.addObject=function(t){this.scene.add(t)},e.prototype.addCssObject=function(t){this.cssScene.add(t)},e.prototype.removeCssObject=function(t){this.cssScene.remove(t)},e.prototype.removeObject=function(t){this.scene.remove(t)},e.prototype.animate=function(){this.binds.animate&&requestAnimationFrame(this.binds.animate),this.render()},e.prototype.addRenderCallback=function(t){this.renderCallbacks.push(t)},e.prototype.removeRenderCallback=function(t){var e=this.renderCallbacks.indexOf(t);~e&&this.renderCallbacks.splice(e,1)},e.prototype.render=function(){var t=this.clock.getDelta();this.controls.update(t);var e=this.renderCallbacks,i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var o;if(i){if(n>=e.length)break;o=e[n++]}else{if((n=e.next()).done)break;o=n.value}o(t)}this.cssRenderer.render(this.cssScene,this.camera),this.renderer.render(this.scene,this.camera)},e.prototype.processGeometry=function(t,e){e.geometry=t;var i=(new r.THREE.Geometry).fromBufferGeometry(t);i.mergeVertices();var n=this.createIndexedBufferGeometryFromGeometry(i);return this.mapIndices(t,n)},e.prototype.createIndexedBufferGeometryFromGeometry=function(t){for(var e=t.vertices.length,i=t.faces.length,n=new r.THREE.BufferGeometry,o=new Float32Array(3*e),s=new(3*i>65535?Uint32Array:Uint16Array)(3*i),a=0;a<e;a++){var l=t.vertices[a],h=3*a;o[h]=l.x,o[h+1]=l.y,o[h+2]=l.z}for(var c=0;c<i;c++){var u=t.faces[c],d=3*c;s[d]=u.a,s[d+1]=u.b,s[d+2]=u.c}return n.setIndex(new r.THREE.BufferAttribute(s,1)),n.addAttribute("position",new r.THREE.BufferAttribute(o,3)),n},e.prototype.isEqual=function(t,e,i,n,o,r){return Math.abs(n-t)<1e-6&&Math.abs(o-e)<1e-6&&Math.abs(r-i)<1e-6},e.prototype.mapIndices=function(t,e){var i=t.attributes.position.array,n=e.attributes.position.array,o=e.index.array,r=n.length/3,s=i.length/3;t.mappedVertices=n,t.mappedIndices=o,t.mappedAssociation=[];for(var a=0;a<r;a++){var l=[];t.mappedAssociation.push(l);for(var h=3*a,c=0;c<s;c++){var u=3*c;this.isEqual(n[h],n[h+1],n[h+2],i[u],i[u+1],i[u+2])&&l.push(u)}}return{vertices:t.mappedVertices,indices:t.mappedIndices}},e.prototype.oneNodePositionCallback=function(t,e){this.position.set(t.x,t.y,t.z),this.quaternion.set(e.x,e.y,e.z,e.w)},e.prototype.multyNodePositionCallback=function(t,e,i){for(var n=this.geometry,o=n.attributes.position.array,r=n.attributes.normal.array,s=n.mappedAssociation[t],a=0;a<s.length;a++){var l=s[a];o[l]=e.x,r[l]=i.x,o[++l]=e.y,r[l]=i.y,o[++l]=e.z,r[l]=i.z}},e.prototype.multyNodePositionPostCallback=function(){var t=this.geometry;t.attributes.position.needsUpdate=!0,t.attributes.normal.needsUpdate=!0},e.prototype.pathPositionCallback=function(t,e){var i=this.geometry.attributes.position.array,n=3*t;i[n++]=e.x,i[n++]=e.y,i[n]=e.z},e.prototype.pathPositionPostCallback=function(){var t=this.geometry;t.computeVertexNormals(),t.attributes.position.needsUpdate=!0,t.attributes.normal.needsUpdate=!0},e}(r.THREE.EventDispatcher);e.default=u},function(t,e,i){"use strict";e.__esModule=!0;var n,o=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n.view=i,n.visible=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.togle=function(){this.visible=!this.visible,this.fireChange()},e.prototype.hide=function(){this.visible=!1,this.fireChange()},e.prototype.fireChange=function(){this.onChange&&this.onChange(),this.updateView()},e.prototype.updateView=function(){this.view&&this.view.setState("widFloatWnd",{enable:!0,visible:this.visible,active:!1})},e}(((n=i(15))&&n.__esModule?n:{default:n}).default);e.default=o},function(t,e,i){"use strict";e.__esModule=!0;var n,o=function(t){function e(i,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r.p={x:i,y:n,r:o},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.testIntersection=function(t,e){var i=void 0,n=e.x,o=e.y,r=this.p;return(n-r.x)*(n-r.x)+(o-r.y)*(o-r.y)<=r.r*r.r&&(i={target:this,data:e}),i},e}(((n=i(21))&&n.__esModule?n:{default:n}).default);e.default=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=n(i(21)),r=n(i(2)),s=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n.poly=i,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.testIntersection=function(t,e){return r.default.isInsidePoly(this.poly,e)?{target:this,data:e}:void 0},e}(o.default);e.default=s},function(t,e,i){var n;n=function(t){function e(e){var s=e||window.event,a=l.call(arguments,1),h=0,u=0,d=0,f=0,p=0,v=0;if((e=t.event.fix(s)).type="mousewheel","detail"in s&&(d=-1*s.detail),"wheelDelta"in s&&(d=s.wheelDelta),"wheelDeltaY"in s&&(d=s.wheelDeltaY),"wheelDeltaX"in s&&(u=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(u=-1*d,d=0),h=0===d?u:d,"deltaY"in s&&(h=d=-1*s.deltaY),"deltaX"in s&&(u=s.deltaX,0===d&&(h=-1*u)),0!==d||0!==u){if(1===s.deltaMode){var g=t.data(this,"mousewheel-line-height");h*=g,d*=g,u*=g}else if(2===s.deltaMode){var m=t.data(this,"mousewheel-page-height");h*=m,d*=m,u*=m}if(f=Math.max(Math.abs(d),Math.abs(u)),(!r||f<r)&&(r=f,n(s,f)&&(r/=40)),n(s,f)&&(h/=40,u/=40,d/=40),h=Math[h>=1?"floor":"ceil"](h/r),u=Math[u>=1?"floor":"ceil"](u/r),d=Math[d>=1?"floor":"ceil"](d/r),c.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();p=e.clientX-y.left,v=e.clientY-y.top}return e.deltaX=u,e.deltaY=d,e.deltaFactor=r,e.offsetX=p,e.offsetY=v,e.deltaMode=0,a.unshift(e,h,u,d),o&&clearTimeout(o),o=setTimeout(i,200),(t.event.dispatch||t.event.handle).apply(this,a)}}function i(){r=null}function n(t,e){return c.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}var o,r,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var h=s.length;h;)t.event.fixHooks[s[--h]]=t.event.mouseHooks;var c=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",c.getLineHeight(this)),t.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=a.length;i;)this.removeEventListener(a[--i],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var i=t(e),n=i["offsetParent"in t.fn?"offsetParent":"parent"]();return n.length||(n=t("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})},t.exports=n},function(t,e,i){var n;t.exports=((n=function(){function t(t){return o.appendChild(t.dom),t}function e(t){for(var e=0;e<o.children.length;e++)o.children[e].style.display=e===t?"block":"none";i=t}var i=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(t){t.preventDefault(),e(++i%o.children.length)},!1);var r=(performance||Date).now(),s=r,a=0,l=t(new n.Panel("FPS","#0ff","#002")),h=t(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new n.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:o,addPanel:t,showPanel:e,begin:function(){r=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(h.update(t-r,200),t>s+1e3&&(l.update(1e3*a/(t-s),100),s=t,a=0,c)){var e=performance.memory;c.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){r=this.end()},domElement:o,setMode:e}}).Panel=function(t,e,i){var n=1/0,o=0,r=Math.round,s=r(window.devicePixelRatio||1),a=80*s,l=48*s,h=3*s,c=2*s,u=3*s,d=15*s,f=74*s,p=30*s,v=document.createElement("canvas");v.width=a,v.height=l,v.style.cssText="width:80px;height:48px";var g=v.getContext("2d");return g.font="bold "+9*s+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=i,g.fillRect(0,0,a,l),g.fillStyle=e,g.fillText(t,h,c),g.fillRect(u,d,f,p),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(u,d,f,p),{dom:v,update:function(l,m){n=Math.min(n,l),o=Math.max(o,l),g.fillStyle=i,g.globalAlpha=1,g.fillRect(0,0,a,d),g.fillStyle=e,g.fillText(r(l)+" "+t+" ("+r(n)+"-"+r(o)+")",h,c),g.drawImage(v,u+s,d,f-s,p,u,d,f-s,p),g.fillRect(u+f-s,d,s,p),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(u+f-s,d,s,r((1-l/m)*p))}}},n)},function(t,e,i){i(23),t.exports=i(22)}]);